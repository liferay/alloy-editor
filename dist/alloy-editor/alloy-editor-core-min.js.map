{"version":3,"sources":["webpack://AlloyEditor/webpack/bootstrap","webpack://AlloyEditor/external \"React\"","webpack://AlloyEditor/./src/components/base/button-state-classes.js","webpack://AlloyEditor/./src/components/base/button-command.js","webpack://AlloyEditor/external \"ReactDOM\"","webpack://AlloyEditor/./src/oop/lang.js","webpack://AlloyEditor/./src/components/base/button-style.js","webpack://AlloyEditor/./src/components/base/button-command-active.js","webpack://AlloyEditor/./src/components/base/widget-focus-manager.js","webpack://AlloyEditor/./src/components/buttons/button-commands-list.jsx","webpack://AlloyEditor/./src/components/base/button-keystroke.js","webpack://AlloyEditor/./src/components/buttons/button-dropdown.jsx","webpack://AlloyEditor/./src/components/base/button-action-style.js","webpack://AlloyEditor/./src/components/base/widget-dropdown.js","webpack://AlloyEditor/./src/components/base/widget-exclusive.js","webpack://AlloyEditor/./src/selections/selection-test.js","webpack://AlloyEditor/./src/components/base/widget-position.js","webpack://AlloyEditor/./src/components/base/widget-arrow-box.js","webpack://AlloyEditor/./src/components/base/toolbar-buttons.js","webpack://AlloyEditor/./src/components/buttons/button-table-edit.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list-item.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list-item-remove.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list-header.jsx","webpack://AlloyEditor/./src/components/buttons/button-target-list.jsx","webpack://AlloyEditor/./src/components/buttons/button-link-target-edit.jsx","webpack://AlloyEditor/./src/components/base/button-props.js","webpack://AlloyEditor/./src/components/buttons/button-link-edit.jsx","webpack://AlloyEditor/./src/components/buttons/button-link-autocomplete-list.jsx","webpack://AlloyEditor/./src/components/buttons/button-embed-edit.jsx","webpack://AlloyEditor/./src/components/buttons/button-command-list-item.jsx","webpack://AlloyEditor/./src/components/buttons/button-camera-image.jsx","webpack://AlloyEditor/./src/oop/oop.js","webpack://AlloyEditor/./src/components/toolbars/toolbar-styles.jsx","webpack://AlloyEditor/./src/components/toolbars/toolbar-add.jsx","webpack://AlloyEditor/./src/components/toolbars/index.js","webpack://AlloyEditor/./src/components/buttons/button-underline.jsx","webpack://AlloyEditor/./src/components/buttons/button-ul.jsx","webpack://AlloyEditor/./src/components/buttons/button-twitter.jsx","webpack://AlloyEditor/./src/components/buttons/button-table.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-row.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-remove.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-heading.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-column.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-cell.jsx","webpack://AlloyEditor/./src/components/buttons/button-superscript.jsx","webpack://AlloyEditor/./src/components/buttons/button-subscript.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles.jsx","webpack://AlloyEditor/./src/components/buttons/button-strike.jsx","webpack://AlloyEditor/./src/components/buttons/button-remove-format.jsx","webpack://AlloyEditor/./src/components/buttons/button-quote.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-justify.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-center.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-align-right.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-align-left.jsx","webpack://AlloyEditor/./src/components/buttons/button-outdent-block.jsx","webpack://AlloyEditor/./src/components/buttons/button-ol.jsx","webpack://AlloyEditor/./src/components/buttons/button-link.jsx","webpack://AlloyEditor/./src/components/buttons/button-italic.jsx","webpack://AlloyEditor/./src/components/buttons/button-indent-block.jsx","webpack://AlloyEditor/./src/components/buttons/button-image.jsx","webpack://AlloyEditor/./src/components/buttons/button-image-Align-right.jsx","webpack://AlloyEditor/./src/components/buttons/button-image-align-left.jsx","webpack://AlloyEditor/./src/components/buttons/button-image-align-center.jsx","webpack://AlloyEditor/./src/components/buttons/button-hline.jsx","webpack://AlloyEditor/./src/components/buttons/button-h2.jsx","webpack://AlloyEditor/./src/components/buttons/button-h1.jsx","webpack://AlloyEditor/./src/components/buttons/button-embed.jsx","webpack://AlloyEditor/./src/components/buttons/button-code.jsx","webpack://AlloyEditor/./src/components/buttons/button-camera.jsx","webpack://AlloyEditor/./src/components/buttons/button-bold.jsx","webpack://AlloyEditor/./src/components/buttons/index.js","webpack://AlloyEditor/./src/components/main.jsx","webpack://AlloyEditor/./src/selections/selection-position.js","webpack://AlloyEditor/./src/selections/selection-arrowbox.js","webpack://AlloyEditor/./src/selections/Selections.js","webpack://AlloyEditor/./src/oop/attribute.js","webpack://AlloyEditor/./src/oop/base.js","webpack://AlloyEditor/./src/components/uibridge/uibridge.js","webpack://AlloyEditor/./src/plugins/tabletools.js","webpack://AlloyEditor/./src/plugins/tableresize.js","webpack://AlloyEditor/./src/plugins/selectionkeystrokes.js","webpack://AlloyEditor/./src/plugins/placeholder.js","webpack://AlloyEditor/./src/plugins/pasteimages.js","webpack://AlloyEditor/./src/plugins/imagealignment.js","webpack://AlloyEditor/./src/plugins/embed.js","webpack://AlloyEditor/./src/plugins/dragresize_ie.js","webpack://AlloyEditor/./src/plugins/dragresize.js","webpack://AlloyEditor/./src/plugins/autolist.js","webpack://AlloyEditor/./src/plugins/autolink.js","webpack://AlloyEditor/./src/plugins/addimages.js","webpack://AlloyEditor/./src/plugins/index.js","webpack://AlloyEditor/./src/core/uicore.js","webpack://AlloyEditor/./src/core/tools.js","webpack://AlloyEditor/./src/core/table.js","webpack://AlloyEditor/./src/core/selection-region.js","webpack://AlloyEditor/./src/core/plugins.js","webpack://AlloyEditor/./src/core/link.js","webpack://AlloyEditor/./src/core/debounce.js","webpack://AlloyEditor/./src/core/index.js","webpack://AlloyEditor/./src/adapter/core.js","webpack://AlloyEditor/./src/adapter/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","e","t","window","React","length","writable","key","a","WrappedComponent","_WrappedComponent","_class","TypeError","this","__proto__","getPrototypeOf","apply","arguments","create","constructor","setPrototypeOf","_createClass","stateClasses","_lang2","isFunction","isActive","isDisabled","data","editor","props","execCommand","command","modifiesSelection","selectionChange","fire","ReactDOM","Symbol","iterator","Lang","isArray","toString","isBoolean","isNull","isNumber","isFinite","isObject","valueType","_typeof","isString","mix","receiver","supplier","toInt","parseInt","_get","style","parts","split","currentMember","config","shift","_style","CKEDITOR","elementPath","getStyle","checkActive","getCommand","state","TRISTATE_ON","Function","getOwnPropertyDescriptor","_refresh","event","_isValidTarget","target","_descendants","activeDescendantEl","_activeDescendant","document","activeElement","focusFirstChild","indexOf","focus","stopPropagation","preventDefault","action","_getFocusAction","type","_moveFocus","direction","onDismiss","keys","_getFocusMoveDirection","dismissAction","_getFocusDismissAction","dismiss","focusMoveDirection","_isValidKey","keyCode","dismissNext","dismissPrev","circular","next","prev","shifKey","element","tagName","toLowerCase","numDescendants","descendant","setAttribute","Math","max","min","domNode","_reactDom2","findDOMNode","descendants","querySelectorAll","priorityDescendants","Array","slice","forEach","item","getAttribute","push","bind","sort","b","concat","some","index","ButtonCommandsList","_react2","Component","createElement","className","onFocus","onKeyDown","handleKey","tabIndex","id","listId","role","_renderActions","commands","items","map","_buttonCommandListItem2","description","label","defaultProps","_widgetFocusManager2","nativeEditor","keystroke","commandName","random","exec","keystrokeFn","fn","addCommand","_defaultKeystrokeCommand","keystrokeHandler","keystrokes","setKeystroke","ButtonDropdown","children","getSelection","lock","removeStyle","applyStyle","unlock","assign","_this","_extends","dropdownTrigger","itemDropdown","nextProps","setState","obj","itemKey","tools","merge","expanded","toggleDropdown","toggleDirection","moveFocus","itemExclusive","filter","cancelExclusive","renderExclusive","requestExclusive","SelectionTest","embed","payload","selectionData","image","getName","isReadOnly","link","range","getRanges","isSelectionEmpty","Link","getFromSelection","getText","endOffset","equals","startContainer","endContainer","startOffset","table","Table","isEditable","text","selectionEmpty","region","getCommonAncestor","WidgetPositionComponent","_Component","cancelAnimationFrame","_animationFrameId","attrs","viewPaneSize","dom","getViewPaneSize","x","left","y","top","width","eventPayload","editorEvent","nativeEvent","pos","pageX","endRect","startRect","SELECTION_BOTTOM_TO_TOP","_getXPoint","_getYPoint","SELECTION_TOP_TO_BOTTOM","eventX","right","abs","elementTarget","$","offsetTop","offsetHeight","bottom","gutter","offsetWidth","SELECTION_LEFT_TO_RIGHT","SELECTION_RIGHT_TO_LEFT","hasClass","startPoint","endPoint","domElement","setStyles","opacity","removeClass","_animate","addClass","isVisible","interactionPoint","getInteractionPoint","finalX","finalY","initialX","initialY","parseFloat","constrainToViewport","res","getConstrainedPosition","height","moveToPoint","xy","getWidgetXYPoint","callback","requestAnimationFrame","arrowBoxClasses","buttons","additionalProps","buttonProps","buttonCfg","filterExclusive","button","AlloyEditor","Buttons","cfg","mergeExclusiveProps","tabKey","trigger","mergeDropdownProps","ButtonTableEdit","cols","rows","refs","tableAttributes","inputName","_createTable","time","Date","now","rowsId","colsId","htmlFor","Strings","onChange","_handleChange","_handleKeyDown","placeholder","ref","columns","aria-label","onClick","border","cellPadding","cellSpacing","f","u","ButtonStylesList","blockStyles","inlineStyles","objectStyles","styles","STYLE_BLOCK","STYLE_INLINE","STYLE_OBJECT","_blockStyles","_inlineStyles","_objectStyles","removeStylesItem","showRemoveStylesItem","_buttonStylesListItemRemove2","_buttonDropdown2","_buttonStylesListHeader2","_renderStylesItems","_buttonStylesListItem2","activeStyle","ButtonStylesListItem","styleCfg","margin","_preview","buildPreview","dangerouslySetInnerHTML","__html","_onClick","_buttonActionStyle2","_buttonStyle2","ButtonStylesListItemRemove","_removeStyles","normal","removeBlocks","blockItem","blockStyle","ButtonsStylesListHeader","ButtonTargetList","listTargets","_renderListTargets","allowedLinkTargets","linkTargetDefault","linkTargetSelf","linkTargetBlank","linkTargetParent","linkTargetTop","targets","_getAllowedTargetItems","handleLinkTargetChange","selectedTarget","data-value","ButtonLinkTargetEdit","allowedTargets","aria-expanded","title","_buttonTargetList2","linkEdit","ButtonLinkEdit","href","defaultLinkTarget","autocompleteSelected","initialLink","linkHref","linkTarget","manualSelection","_focusLinkInput","replaceState","getInitialState","autocompleteDropdown","targetButtonEdit","buttonClearLink","targetSelector","_handleLinkTargetChange","_buttonLinkTargetEdit2","dataFn","autocompleteDropdownProps","handleLinkAutocompleteClick","_handleLinkAutocompleteClick","setAutocompleteState","_setAutocompleteState","term","_buttonLinkAutocompleteList2","showTargetSelector","clearInput","_clearLink","clear","placeholderProp","env","ie","editLink","removeLink","disabled","_removeLink","remove","_handleLinkHrefChange","confirm","_isValidState","_updateLink","instance","focusLinkEl","linkInput","setTimeout","advanceSelection","linkUtils","selection","bookmarks","createBookmarks","advance","selectBookmarks","selected","appendProtocol","linkAttrs","modifySelection","update","autocompleteUrl","customIndexStart","_buttonProps2","_widgetDropdown2","ButtonLinkAutocompleteList","clearTimeout","_timeout","_updateItems","delay","_renderAutocompleteItems","nextState","url","Promise","resolve","then","ButtonEmbedEdit","selectedElement","getSelectedElement","findOne","clearLinkStyle","deleteEmbed","data-type","_removeEmbed","_embedLink","getAscendant","ButtonCommandListItem","_getClassName","icon","_buttonCommand2","ButtonCameraImage","buttonTakePhoto","_stream","stop","getVideoTracks","track","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","video","audio","_handleStreamSuccess","_handleStreamError","takePhoto","videoEl","videoContainer","canvasEl","canvasContainer","context","getContext","_videoHeight","videoWidth","drawImage","imgURL","toDataURL","el","createFromHtml","insertElement","error","alert","stream","addEventListener","videoHeight","isNaN","mozSrcObject","src","URL","webkitURL","createObjectURL","play","protoProps","staticProps","supplierProto","receiverProto","superclass","ToolbarStyles","_updatePosition","prevProps","prevState","currentSelection","_getCurrentSelection","getArrowBoxClassesFn","_getSelectionFunction","getArrowBoxClasses","cssClasses","getToolbarButtons","selectionType","data-tabindex","selectionFn","selectionFunction","selections","result","testFn","test","setPositionFn","setPosition","updatePosition","show","_widgetArrowBox2","_widgetExclusive2","_widgetPosition2","_toolbarButtons2","ToolbarAdd","isContentEditable","_getButtons","_getToolbarClassName","add","cssClass","offsetLeft","clientRect","editable","getClientRect","position","gutterExclusive","floor","cancelAnimation","_toolbarAdd2","_toolbarStyles2","ButtonUnderline","getStateClasses","underline","aria-pressed","CTRL","_buttonKeystroke2","_buttonStateClasses2","ButtonUnorderedlist","bulletedlist","ButtonTwitter","_getHref","class","twitter","handleClick","selectedText","getSelectedText","via","twitterHref","ButtonTable","_buttonTableEdit2","ButtonTableRow","buttonCommandsList","buttonCommandsListId","_buttonCommandsList2","_getCommands","row","aria-owns","rowInsertBefore","rowInsertAfter","rowDelete","ButtonTableRemove","deleteTable","_removeTable","ButtonTableHeading","activeHeading","getHeading","activeHeadingIntro","headers","activeHeadingLabel","headersNone","headersRow","headersColumn","headersBoth","ButtonTableColumn","column","columnInsertBefore","columnInsertAfter","columnDelete","ButtonTableCell","cell","cellInsertBefore","cellInsertAfter","cellDelete","cellMerge","cellMergeDown","cellMergeRight","cellSplitHorizontal","cellSplitVertical","ButtonSuperscript","superscript","ButtonSubscript","subscript","ButtonStyles","buttonStylesList","_getStyles","_checkActive","_buttonStylesList2","styleConfig","h1","h2","formatted","cite","code","ButtonStrike","strike","ButtonRemoveFormat","removeformat","ButtonQuote","quote","ButtonParagraphJustify","alignJustify","_buttonCommandActive2","ButtonParagraphCenter","alignCenter","ButtonParagraphAlignRight","alignRight","ButtonParagraphAlignLeft","alignLeft","ButtonOutdentBlock","outdent","ButtonOrderedList","numberedlist","ButtonLink","mergeButtonCfgProps","_buttonLinkEdit2","_requestExclusive","ButtonItalic","italic","ButtonIndentBlock","indent","ButtonImage","accept","_onInputChange","display","fileInput","click","inputEl","files","reader","FileReader","file","onload","imageFiles","imageData","readAsDataURL","ButtonImageAlignRight","ButtonImageAlignLeft","ButtonImageAlignCenter","ButtonHline","horizontalrule","ButtonH2","ButtonH1","ButtonEmbed","_buttonEmbedEdit2","SHIFT","ButtonCode","ButtonCamera","_buttonCameraImage2","location","protocol","cameraDisabled","camera","ButtonBold","bold","Z","h","g","v","_","O","E","w","k","C","T","S","P","D","I","j","R","A","K","N","M","L","F","H","z","B","U","W","q","G","V","Y","X","J","Q","ee","_buttonBold2","_buttonCamera2","_buttonCode2","_buttonEmbed2","_buttonH2","_buttonH4","_buttonHline2","_buttonImageAlignCenter2","_buttonImageAlignLeft2","_buttonImageAlignRight2","_buttonImage2","_buttonIndentBlock2","_buttonItalic2","_buttonLink2","_buttonOl2","_buttonOutdentBlock2","_buttonParagraphAlignLeft2","_buttonParagraphAlignRight2","_buttonParagraphCenter2","_buttonParagraphJustify2","_buttonQuote2","_buttonRemoveFormat2","_buttonStrike2","_buttonStyles2","_buttonSubscript2","_buttonSuperscript2","_buttonTableCell2","_buttonTableColumn2","_buttonTableHeading2","_buttonTableRemove2","_buttonTableRow2","_buttonTable2","_buttonTwitter2","_buttonUl2","_buttonUnderline2","UI","hidden","on","_onEditorInteraction","_onActionPerformed","_onEditorKey","_mousedownListener","_setUIHidden","_keyDownListener","debounce","eventsDelay","message","_getAvailableToolbarsMessage","ariaUpdate","_ariaUpdateTemplates","template","_getAriaUpdates","ariaUpdates","noToolbar","ariaUpdateNoToolbar","oneToolbar","ariaUpdateOneToolbar","manyToolbars","ariaUpdateManyToolbars","toolbarsNodeList","toolbarNames","toolbar","_getAriaUpdateTemplate","output","toolbars","join","replace","removeEventListener","detach","Toolbars","_onDismissToolbarFocus","getSelectionData","domEvent","altKey","targetNode","node","contains","DEFAULT_GUTTER","centerToolbar","rect","toolbarNode","halfNodeWidth","scrollPosition","getScrollPosition","widgetXY","SelectionSetPosition","SelectionGetArrowBoxClasses","Selections","_selectionTest2","_selectionPosition2","_selectionArrowbox2","Attribute","__config__","__ATTRS__","attr","currentAttr","ATTRS","_isInitialized","_init","curValue","_callStringOrFunction","set","readOnly","writeOnce","validator","setter","stringOrFunction","args","hasDefaultValue","hasPassedValueViaConfig","valueFn","Base","init","_attribute2","_callChain","destroy","wat","arr","ctor","reverse","plugins","beforeInit","originalUIAddFn","ui","definition","typeHandler","handlers","registerBridgeButton","__processingPlugin__","plugin","cellNodeRegex","createDef","def","extend","contextSensitive","refresh","path","td","th","TRISTATE_OFF","TRISTATE_DISABLED","addCmd","cmd","addFeature","lang","requiredContent","placeCursorInCell","deleteRows","selectionOrRow","cells","getSelectedCells","buildTableMap","startRowIndex","getParent","rowIndex","lastCell","endRowIndex","rowSpan","rowsToDelete","mapRow","cellRowIndex","nextMapRow","insertAfter","append","colSpan","cursorPosition","parentNode","insertRow","selectionOrCell","startColIndex","endColIndex","firstCell","firstRowCells","insertColumn","deleteCells","cellsToDelete","cellToFocus","focusedCell","tr","last","database","setMarker","getPrevious","getCustomData","getNext","clearAllMarkers","getLast","getChild","getChildCount","allowedContent","mergeCells","isDetect","newCell","newRowSpan","newCellRowSpan","newRowIndex","colIndex","cellInRow","ceil","candidateCell","newCellTr","newCellRow","clone","insertBefore","cellsInSameRow","appendBogus","removeAttribute","newColSpan","newCellColSpan","cellsInSameCol","tableMap","oCol","insertCell","ranges","retval","moveOutOfCellGuard","NODE_ELEMENT","collapsed","startNode","nearestCell","walker","guard","is","dtd","parent","doc","getDocument","startRow","endRow","cloneRow","nextRow","newRow","getCellColIndex","isStart","rowCells","mapCell","getColumnsIndices","Infinity","startCol","lastCol","cloneCol","nextCol","nextCell","startElement","getStartElement","trimCell","bogus","getBogus","trim","placeAtEnd","docInner","docOuter","version","selectNodeContents","collapse","select","oRow","mergeDirection","commonAncestor","mapHeight","mapWidth","startColumn","targetCell","rowspan","colspan","er","lastRowIndex","totalRowSpan","totalColSpan","frag","documentFragment","dimension","cellFirstChild","getFirst","getChildren","count","isBlockBoundary","br","whitespaces","moveChildren","setHtml","trs","nodeList","tailTr","getItem","aRows","aMap","oCell","iColSpan","iRowSpan","rs","cs","pxUnit","cssLength","requires","resizer","attachListener","isInline","evt","getTarget","pillars","getPageOffset","move","cancel","setCustomData","pillarIndex","rtl","getComputedStyle","$tr","cellsCount","$elected","$rows","maxCells","len","tbody","tBodies","tbodyPosition","getDocumentPosition","pillarLeft","pillarRight","pillarWidth","nextTd","getBorderWidth","clearPillarsCache","pillar","positionX","columnResizer","attachTo","getWidth","clientWidth","side","computed","borderMap","thin","medium","thick","isResizing","currentShift","leftSideCells","rightSideCells","leftShiftBoundary","rightShiftBoundary","resizeEnd","setOpacity","leftCell","rightCell","leftOldWidth","rightOldWidth","tableWidth","sizeShift","setStyle","removeCustomData","removeListener","onMouseDown","columnIndex","leftColumnCells","rightColumnCells","leftMinSize","Number","MAX_VALUE","rightMinSize","onMouseMove","onMouseUp","getDocumentElement","targetPillar","getBody","posX","resizerNewPosition","round","dest","relatedTarget","toElement","selectionKeystrokes","selectionKeystroke","brFiller","needsBrFiller","enterModeEmptyValue","1","2","3","_checkEmptyData","_removePlaceholderClass","once","editableNode","innerHtml","innerHTML","enterMode","placeholderClass","_onPaste","clipboardData","pastedData","listenerData","imageFile","getAsFile","IMAGE_ALIGNMENT","ALIGN_VALUES","CENTERED_IMAGE_STYLE","getImageAlignment","imageAlignment","every","styleCheck","vendorPrefixes","vendorPrefix","removeImageAlignment","afterInit","self","refreshCommands","lastElement","REGEX_HTTP","REGEX_DEFAULT_LINK","DEFAULT_AE_EMBED_URL_TPL","DEFAULT_AE_EMBED_WIDGET_TPL","DEFAULT_AE_EMBED_DEFAULT_LINK_TPL","AE_EMBED_URL_TPL","embedUrlTemplate","AE_EMBED_WIDGET_TPL","embedWidgetTpl","AE_EMBED_DEFAULT_LINK_TPL","embedLinkDefaultTpl","insertHtml","widgets","mask","widget","jsonp","encodeURIComponent","response","html","createATag","msg","aTagHtml","upcast","embedWidgetUpcastFn","attributes","dataValue","widgetElement","addElementCallback","FILTER_SKIP_TREE","alignmentsObj","center","cursor","both","scale","regexPercent","hidpi","icons","imageScaleResize","initOn","classRegex","alignClasses","image2_alignClasses","captionedClass","image2_captionedClass","helpers","image2","alt","hasCaption","caption","ready","checkHasNaturalRatio","wrapper","align","alignElement","setData","image2_disableResizer","inline","imageOrLink","oldResizeWrapper","resizeWrapper","nativeEvt","newWidth","newHeight","updateData","moveDiffX","moveDiffY","factor","startX","screenX","startY","screenY","startWidth","startHeight","clientHeight","listeners","cursorClass","attachToDocuments","collection","globalDoc","pop","setAttributes","selectElement","getStyleableElement","figcaption","figure","classes","img","contentTransformations","features","checkFeature","contenteditable","data-cke-saved-src","oldData","dimensions","downcast","attrsHolder","replaceWith","parseCssText","wrapWith","htmlParser","float","isEmpty","writeCssText","draggable","editables","selector","getClasses","RegExp","repository","parseElementClasses","getLabel","pathName","styleableElements","isCenterWrapper","validChildren","div","child","isLinkedOrStandaloneImage","ENTER_P","match","onLoad","addCss","natural","getNatural","naturalWidth","naturalHeigh","Image","heigh","IMAGE_HANDLES","POSITION_ELEMENT_FN","bl","handle","box","positionElement","bm","lm","tl","tm","rm","isFirefox","documentElement","enablePlugin","resizeTimeout","Resizer","snapToSize","mouseDownListener","isHandle","initDrag","getType","SELECTION_NONE","hide","resizeElement","getElementById","container","preview","appendChild","handles","handleName","createHandle","classList","otherImages","getElementsByTagName","splice","getBoundingBox","body","showHandles","elements","getElementsByClassName","hideHandles","removeChild","drag","DragEvent","onStart","showPreview","isDragging","onDrag","calculateSize","updatePreview","previewBox","updateHandles","onRelease","hidePreview","onComplete","resizeComplete","start","backgroundImage","delta","ratio","others","other","String","startPos","clientX","clientY","events","mousemove","keydown","mouseup","currentPos","shiftKey","ctrl","ctrlKey","which","release","ctx","getBoundingClientRect","pageXOffset","pageYOffset","DEFAULT_CONFIG","regex","_onKeyDown","_checkForBackspaceAndUndo","bullet","_getListConfig","configRegex","autolist","textContainer","substring","regexLen","autolistCfg","regexItem","_createList","listConfig","setText","userAgent","DELIMITERS","REGEX_LAST_WORD","REGEX_URL","_onKeyUp","_getLastWord","offset","previousText","_currentKeyCode","lastChild","previousNode","_startContainer","_offset","lastWord","_isValidURL","_ckLink","_replaceContentByLink","content","createRange","setStart","setEnd","ckLink","linkNode","_subscribeToKeyEvent","nextEditableNode","getNextEditableNode","nextNode","getNextNode","caretOffset","newRange","setEndAfter","isIE","_onDragEnter","_onDragOver","_onDragDrop","_handleFiles","_processFile","createSelectionFromPoint","dataTransfer","_preventEvent","bin","addimages","autolink","dragresize","dragresizeie","imagealignment","pasteimages","selectionkeystrokes","tableresize","tabletools","ariaState","ariaElement","_createAriaElement","uiTasksTimeout","uicore","timeout","handleUI","allowEsc","handleAria","handleMouseLeave","found","aeUINodes","focusHandler","statusElement","urlTemplate","urlParams","errorCallback","callbackKey","getNextNumber","jsonpCallbacks","cleanUp","scriptElement","simulate","eventInstance","createEvent","initEvent","dispatchEvent","IE_NON_DIRECTLY_EDITABLE_ELEMENT","col","colgroup","tfoot","thead","_editor","HEADING_BOTH","HEADING_COL","HEADING_NONE","HEADING_ROW","_createElement","setHeading","heading","moveToPosition","POSITION_AFTER_START","webkit","shrink","hasAttribute","rowHeadingSettings","tHead","colHeadingSettings","nodeName","headingSettings","POSITION_BEFORE_START","tableHead","tableBody","getElementsByTag","tableHeading","hadColHeading","needColHeading","needRowHeading","tableFirstRow","tableFirstRowChildCount","renameNode","createTHead","previousFirstRow","newFirstRow","newFirstRowChildCount","headingCommands","tableUtils","SelectionRegion","createSelectionFromRange","endX","endY","end","caretPositionFromPoint","offsetNode","caretRangeFromPoint","selectRanges","createTextRange","endRange","duplicate","setEndPoint","getCaretRegion","bookmarkNodeEl","scrollPos","getNative","getSelectionRegion","getClientRectsRegion","getSelectionDirection","nativeSelection","defaultRect","clientRects","getClientRects","rangeCount","getRangeAt","anchorNode","compareDocumentPosition","focusNode","anchorOffset","focusOffset","Node","DOCUMENT_POSITION_PRECEDING","load","override","pluginsLoad","names","scope","pluginName","require","methodName","originalPluginMethod","phase","REGEX_BOOKMARK_SCHEME","REGEX_EMAIL_SCHEME","REGEX_URI_SCHEME","moveToElementEditEnd","whitespace","URI","insertNode","_getCompleteURI","data-cke-saved-href","applyToRange","SHRINK_TEXT","alwaysRemoveElement","uri","removeAttrs","setAttrs","removeAttributes","debounceHandle","callFn","callContext","startIndex","callArgs","selectionRegion","Core","_oop2","_base2","initializer","removePlugins","extraPlugins","pasteFromWordRemoveStyles","pasteFromWordRemoveFontStyles","edge","_addReadOnlyLinkClickListener","loadLanguageResources","_renderUI","destructor","_destroyed","_editorUIElement","unmountComponentAtNode","_clearSelections","empty","getWindow","removeAllRanges","_defaultReadOnlyClickFn","mouseEvent","hasCtrlKey","metaKey","shouldOpen","_redirectLink","_getNativeEditor","open","editorUIElement","_mainUI","render","_main2","_toElement","_validateAllowedContent","_validateToolbars","enableContentEditable","srcNode","uiNode","implementOn","BRIDGE_BUTTONS","implementEventTarget","_core2","getBasePath","ALLOYEDITOR_BASEPATH","scripts","regexBasePath","getButtons","reduce","acc","val","getUrl","resource","basePath","timestamp","charAt","_langResourceRequested","languages","language","userLanguage","locale","scriptLoader","loaded","buttonName"],"mappings":"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","file":"alloy-editor-core-min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 100);\n","(function() { module.exports = window[\"React\"]; }());","import Lang from '../../oop/lang';\n\n/**\n * ButtonStateClasses is a mixin that decorates the domElement of a component\n * with different CSS classes based on the current state of the element.\n *\n * To check for state, the component can expose the following methods:\n * - `Function` **isActive** to check the active state\n * - `Function` **isDisabled** to check the disabled state\n *\n * @class ButtonStateClasses\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Returns the list of state classes associated to the current element's state, according\n     * to the results of the isActive and isDisabled methods.\n     *\n     * @instance\n     * @memberof ButtonStateClasses\n     * @method getStateClasses\n     * @return {String} A string with the state CSS classes.\n     */\n    getStateClasses() {\n        var stateClasses = '';\n\n        // Check for active state\n        if (Lang.isFunction(this.isActive) && this.isActive()) {\n            stateClasses += 'ae-button-pressed';\n        }\n\n        // Check for disabled state\n        if (Lang.isFunction(this.isDisabled) && this.isDisabled()) {\n            stateClasses += ' ae-button-disabled';\n        }\n\n        return stateClasses;\n    }\n};","/**\n * ButtonCommand is a mixin that executes a command via CKEDITOR's API.\n *\n * @class ButtonCommand\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Executes a CKEditor command and fires `actionPerformed` event.\n     *\n     * @instance\n     * @memberof ButtonCommand\n     * @param {Object=} data Optional data to be passed to CKEDITOR's `execCommand` method.\n     * @method execCommand\n     */\n    execCommand(data) {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.execCommand(this.props.command, data);\n\n        if (this.props.modifiesSelection) {\n            editor.selectionChange(true);\n        }\n\n        editor.fire('actionPerformed', this);\n    }\n};","(function() { module.exports = window[\"ReactDOM\"]; }());","/**\n * Provides core language utilities.\n *\n * @class Lang\n */\nconst Lang = {\n    /**\n     * Check if the passed value is an array.\n     *\n     * @memberof Lang\n     * @method isArray\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is an array, false otherwise.\n     * @static\n     */\n    isArray: function(value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n    },\n\n    /**\n     * Check if the passed value is boolean.\n     *\n     * @memberof Lang\n     * @method isBoolean\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is boolean, false otherwise.\n     * @static\n     */\n    isBoolean: function(value) {\n        return typeof value === 'boolean';\n    },\n\n    /**\n     * Check if the passed value is a function.\n     *\n     * @memberof Lang\n     * @method isFunction\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is a function, false otherwise.\n     * @static\n     */\n    isFunction: function(value) {\n        return typeof(value) === 'function';\n    },\n\n    /**\n     * Check if the passed value is NULL.\n     *\n     * @memberof Lang\n     * @method isNull\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is NULL, false otherwise.\n     * @static\n     */\n    isNull: function(value) {\n        return value === null;\n    },\n\n    /**\n     * Check if the passed value is number.\n     *\n     * @memberof Lang\n     * @method isNumber\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is number, false otherwise.\n     * @static\n     */\n    isNumber: function(value) {\n        return typeof value === 'number' && isFinite(value);\n    },\n\n    /**\n     * Check if the passed value is an object\n     *\n     * @memberof Lang\n     * @method isObject\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is an object, false otherwise.\n     * @static\n     */\n    isObject: function(value) {\n        var valueType = typeof value;\n\n        return (value && (valueType === 'object' || Lang.isFunction(value)));\n    },\n\n    /**\n     * Check if the passed value is a string.\n     *\n     * @memberof Lang\n     * @method isString\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is a string, false otherwise.\n     * @static\n     */\n    isString: function(value) {\n        return typeof value === 'string';\n    },\n\n    /**\n     * Adds all properties from the supplier to the receiver.\n     * The function will add all properties, not only these owned by the supplier.\n     *\n     * @memberof Lang\n     * @method mix\n     * @param {Object} receiver The object which will receive properties.\n     * @param {Object} supplier The object which provides properties.\n     * @return {Object} The modified receiver.\n     * @static\n     */\n    mix: function(receiver, supplier) {\n        var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n        for (var key in supplier) {\n            if (hasOwnProperty.call(supplier, key)) {\n                receiver[key] = supplier[key];\n            }\n        }\n    },\n\n    /**\n     * Converts value to Integer.\n     *\n     * @memberof Lang\n     * @method toInt\n     * @param {Any} value The value which have to be converted to Integer.\n     * @return {Integer} The converted value.\n     * @static\n     */\n    toInt: function(value) {\n        return parseInt(value, 10);\n    }\n};\n\nexport default Lang;","import Lang from '../../oop/lang.js'\n\n/**\n * ButtonStyle is a mixin that provides a style prop and some methods to apply the resulting\n * style and checking if it is present in a given path or selection.\n *\n * @class ButtonStyle\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonStyle\n     * @method componentWillMount\n     */\n    componentWillMount() {\n        if (Lang.isFunction(super.componentWillMount)) {\n            super.componentWillMount();\n        }\n\n        var style = this.props.style;\n\n        if (Lang.isString(style)) {\n            var parts = style.split('.');\n            var currentMember = this.props.editor.get('nativeEditor').config;\n            var property = parts.shift();\n\n            while (property && Lang.isObject(currentMember) && Lang.isObject(currentMember[property])) {\n                currentMember = currentMember[property];\n                property = parts.shift();\n            }\n\n            if (Lang.isObject(currentMember)) {\n                style = currentMember;\n            }\n        }\n\n        this._style = new CKEDITOR.style(style);\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof ButtonStyle\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        if (Lang.isFunction(super.componentWillUnmount)) {\n            super.componentWillUnmount();\n        }\n\n        this._style = null;\n    }\n\n    /**\n     * Returns instance of CKEDITOR.style which represents the current button style.\n     *\n     * @instance\n     * @memberof ButtonStyle\n     * @method getStyle\n     * @return {CKEDITOR.style} The current style representation.\n     */\n    getStyle() {\n        return this._style;\n    }\n\n    /**\n     * Checks if style is active in the current selection.\n     *\n     * @instance\n     * @memberof ButtonStyle\n     * @method isActive\n     * @return {Boolean} True if style is active, false otherwise.\n     */\n    isActive() {\n        var result;\n\n        var editor = this.props.editor.get('nativeEditor');\n\n        var elementPath = editor.elementPath();\n\n        result = this.getStyle().checkActive(elementPath, editor);\n\n        return result;\n    }\n};","/**\n * ButtonCommandActive is a mixin that provides an `isActive` method to determine if\n * a context-aware command is currently in an active state.\n *\n * @class ButtonCommandActive\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Checks if the command is active in the current selection.\n     *\n     * @instance\n     * @memberof ButtonCommandActive\n     * @method isActive\n     * @return {Boolean} True if the command is active, false otherwise.\n     */\n    isActive() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        var command = editor.getCommand(this.props.command);\n\n        return command ? command.state === CKEDITOR.TRISTATE_ON : false;\n    }\n};","import Lang from '../../oop/lang.js';\nimport ReactDOM from 'react-dom';\n\nvar DIRECTION_NONE = 0;\nvar DIRECTION_NEXT = 1;\nvar DIRECTION_PREV = -1;\n\nvar ACTION_NONE = 0;\nvar ACTION_MOVE_FOCUS = 1;\nvar ACTION_DISMISS_FOCUS = 2;\n\n/**\n * WidgetFocusManager is a mixin that provides keyboard navigation inside a widget. To do this,\n * it exposes the following props and methods:\n *\n * @class WidgetFocusManager\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        if (Lang.isFunction(super.componentDidMount)) {\n            super.componentDidMount();\n        }\n\n        this._refresh();\n    }\n\n    /**\n     * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n     * Refreshes the descendants list.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method componentDidUpdate\n     */\n    componentDidUpdate() {\n        if (Lang.isFunction(super.componentDidUpdate)) {\n            super.componentDidUpdate();\n        }\n\n        this._refresh();\n    }\n\n    /**\n     * Focuses the current active descendant.\n     *\n     * Several Widgets can be nested in a component hierarchy by attaching this focus method to\n     * the widget DOM node, transferring the DOM focus control to the inner FocusManager.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method focus\n     */\n    focus(event) {\n        if (!event || this._isValidTarget(event.target)) {\n            if (this._descendants && this._descendants.length) {\n                var activeDescendantEl = this._descendants[this._activeDescendant];\n                // When user clicks with the mouse, the activeElement is already set and there\n                // is no need to focus it. Focusing of the active descendant (usually some button) is required\n                // in case of keyboard navigation, because the focused element might be not the first button,\n                // but the div element, which contains the button.\n                if (document.activeElement !== activeDescendantEl && !this.props.focusFirstChild) {\n                    if (this._descendants.indexOf(document.activeElement) === -1) {\n                        activeDescendantEl.focus();\n                    }\n                }\n\n                if (event) {\n                    event.stopPropagation();\n                    event.preventDefault();\n                }\n            }\n        }\n    }\n\n    /**\n     * Handles the key events on a DOM node to execute the appropriate navigation when needed.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @param {Object} event The Keyboard event that was detected on the widget DOM node.\n     * @method handleKey\n     */\n    handleKey(event) {\n        if (this._isValidTarget(event.target) && this._descendants) {\n            var action = this._getFocusAction(event);\n\n            if (action.type) {\n                event.stopPropagation();\n                event.preventDefault();\n\n                if (action.type === ACTION_MOVE_FOCUS) {\n                    this._moveFocus(action.direction);\n                }\n\n                if (action.type === ACTION_DISMISS_FOCUS) {\n                    this.props.onDismiss(action.direction);\n                }\n            }\n        }\n    }\n\n    /**\n     * Moves the focus among descendants in the especified direction.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method moveFocus\n     * @param {number} direction The direction (1 or -1) of the focus movement among descendants.\n     */\n    moveFocus(direction) {\n        direction = Lang.isNumber(direction) ? direction : 0;\n\n        this._moveFocus(direction);\n    }\n\n    /**\n     * Returns the action, if any, that a keyboard event in the current focus manager state\n     * should produce.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _getFocusAction\n     * @param {object} event The Keyboard event.\n     * @protected\n     * @return {Object} An action object with type and direction properties.\n     */\n    _getFocusAction(event) {\n        var action = {\n            type: ACTION_NONE\n        };\n\n        if (this.props.keys) {\n            var direction = this._getFocusMoveDirection(event);\n\n            if (direction) {\n                action.direction = direction;\n                action.type = ACTION_MOVE_FOCUS;\n            }\n\n            var dismissAction = this._getFocusDismissAction(event, direction);\n\n            if (dismissAction.dismiss) {\n                action.direction = dismissAction.direction;\n                action.type = ACTION_DISMISS_FOCUS;\n            }\n        }\n\n        return action;\n    }\n\n    /**\n     * Returns the dismiss action, if any, the focus manager should execute to yield the focus. This\n     * will happen in any of these scenarios if a dismiss callback has been specified:\n     * - A dismiss key has been pressed\n     * - In a non-circular focus manager, when:\n     *     - The active descendant is the first one and a prev key has been pressed.\n     *     - The active descendant is the last one and a next key has been pressed.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _getFocusDismissAction\n     * @param {Number} focusMoveDirection The focus movement direction (if any).\n     * @param {Object} event The Keyboard event.\n     * @protected\n     * @return {Object} A dismiss action with dismiss and direction properties.\n     */\n    _getFocusDismissAction(event, focusMoveDirection) {\n        var dismissAction = {\n            direction: focusMoveDirection,\n            dismiss: false\n        };\n\n        if (this.props.onDismiss) {\n            if (this._isValidKey(event.keyCode, this.props.keys.dismiss)) {\n                dismissAction.dismiss = true;\n            }\n            if (this._isValidKey(event.keyCode, this.props.keys.dismissNext)) {\n                dismissAction.dismiss = true;\n                dismissAction.direction = DIRECTION_NEXT;\n            }\n            if (this._isValidKey(event.keyCode, this.props.keys.dismissPrev)) {\n                dismissAction.dismiss = true;\n                dismissAction.direction = DIRECTION_PREV;\n            }\n\n            if (!dismissAction.dismiss && !this.props.circular && focusMoveDirection) {\n                dismissAction.dismiss = (\n                    focusMoveDirection === DIRECTION_PREV && this._activeDescendant === 0 ||\n                    focusMoveDirection === DIRECTION_NEXT && this._activeDescendant === this._descendants.length - 1\n                );\n            }\n        }\n\n        return dismissAction;\n    }\n\n    /**\n     * Returns the direction, if any, in which the focus should be moved. In presence of the\n     * shift key modifier, the direction of the movement is inverted.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _getFocusMoveDirection\n     * @param {Object} event The Keyboard event.\n     * @protected\n     * @return {Number} The computed direction of the expected focus movement.\n     */\n    _getFocusMoveDirection(event) {\n        var direction = DIRECTION_NONE;\n\n        if (this._isValidKey(event.keyCode, this.props.keys.next)) {\n            direction = DIRECTION_NEXT;\n        }\n        if (this._isValidKey(event.keyCode, this.props.keys.prev)) {\n            direction = DIRECTION_PREV;\n        }\n\n        if (event.shifKey) {\n            direction *= -1;\n        }\n\n        return direction;\n    }\n\n    /**\n     * Indicates if a given keyCode is valid for the given set of keys.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _isValidKey\n     * @param {Array|Number} keys A key set. Can be a number an array of numbers representing the allowed keyCodes.\n     * @param {Number} keyCode An event keyCode.\n     * @protected\n     * @return {Boolean} A boolean value indicating if the key is valid.\n     */\n    _isValidKey(keyCode, keys) {\n        return Lang.isArray(keys) ? (keys.indexOf(keyCode) !== -1) : (keyCode === keys);\n    }\n\n    /**\n     * Indicates if a given element is valid for focus management. User input elements such as\n     * input, select or textarea are excluded.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _isValidKey\n     * @param {DOMNode} element A DOM element.\n     * @protected\n     * @return {Boolean} A boolean value indicating if the element is valid.\n     */\n    _isValidTarget(element) {\n        var tagName = element.tagName.toLowerCase();\n\n        return (tagName !== 'input' && tagName !== 'select' && tagName !== 'textarea');\n    }\n\n    /**\n     * Moves the focus among descendants in the especified direction.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _moveFocus\n     * @param {number} direction The direction (1 or -1) of the focus movement among descendants.\n     * @protected\n     */\n    _moveFocus(direction) {\n        var numDescendants = this._descendants.length;\n\n        var descendant = this._descendants[this._activeDescendant];\n\n        descendant.setAttribute('tabIndex', -1);\n\n        this._activeDescendant += direction;\n\n        if (this.props.circular) {\n            // Calculate proper modulo result since remainder operator doesn't behave in the\n            // same way for negative numbers\n            this._activeDescendant = ((this._activeDescendant % numDescendants) + numDescendants) % numDescendants;\n        } else {\n            this._activeDescendant = Math.max(Math.min(this._activeDescendant, numDescendants - 1), 0);\n        }\n\n        descendant = this._descendants[this._activeDescendant];\n\n        descendant.setAttribute('tabIndex', 0);\n        descendant.focus();\n    }\n\n    /**\n     * Refreshes the descendants list by executing the CSS selector again and resets the descendants tabIndex.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _refresh\n     * @protected\n     */\n    _refresh() {\n        var domNode = ReactDOM.findDOMNode(this);\n\n        if (domNode) {\n            var descendants = domNode.querySelectorAll(this.props.descendants);\n\n            var priorityDescendants = [];\n\n            this._descendants = [];\n\n            Array.prototype.slice.call(descendants).forEach(function(item) {\n                var dataTabIndex = item.getAttribute('data-tabindex');\n\n                if (dataTabIndex) {\n                    priorityDescendants.push(item);\n                } else {\n                    this._descendants.push(item);\n                }\n            }.bind(this));\n\n            priorityDescendants = priorityDescendants.sort(function(a, b) {\n                return (Lang.toInt(a.getAttribute('data-tabindex')) > Lang.toInt(b.getAttribute('data-tabindex')));\n            });\n\n            this._descendants = priorityDescendants.concat(this._descendants);\n\n            this._activeDescendant = 0;\n\n            this._descendants.some(function(item, index) {\n                if (item.getAttribute('tabindex') === '0') {\n                    this._activeDescendant = index;\n                    this.focus();\n\n                    return true;\n                }\n            }.bind(this));\n        }\n    }\n};","import ButtonCommandListItem from './button-command-list-item.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonCommandsList class provides functionality for showing a list of commands that can be\n * executed to the current selection..\n *\n * @class ButtonCommandsList\n * @uses WidgetFocusManager\n */\nclass ButtonCommandsList extends React.Component {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses on the list node to allow keyboard interaction.\n     *\n     * @instance\n     * @memberof ButtonCommandsList\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        ReactDOM.findDOMNode(this).focus();\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the list.\n     *\n     * @instance\n     * @memberof ButtonCommandsList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <div className=\"ae-dropdown ae-arrow-box ae-arrow-box-top-left\" onFocus={this.focus.bind(this)} onKeyDown={this.handleKey.bind(this)} tabIndex=\"0\">\n                <ul className=\"ae-listbox\" id={this.props.listId} role=\"listbox\">\n                    {this._renderActions(this.props.commands)}\n                </ul>\n            </div>\n        );\n    }\n\n    /**\n     * Renders instances of ButtonCommandListItem with the description of the row action that will be executed.\n     *\n     * @instance\n     * @memberof ButtonCommandsList\n     * @method _renderActions\n     * @protected\n     * @return {Array} Rendered instances of ButtonCommandListItem class\n     */\n    _renderActions(commands) {\n        var editor = this.props.editor;\n        var items;\n\n        if (commands && commands.length) {\n            items = commands.map(function(item) {\n                return (\n                    <li key={item.command} role=\"option\">\n                        <ButtonCommandListItem command={item.command} description={typeof item.label === 'string' ? item.label : item.label()} editor={editor} />\n                    </li>\n                );\n            });\n        }\n\n        return items;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonCommandsList\n * @memberof ButtonCommandsList\n * @property {String} key\n * @static\n */\nButtonCommandsList.key = 'buttonCommandsList';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonCommandsList\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonCommandsList.defaultProps = {\n    circular: false,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    }\n};\n\nexport default WidgetFocusManager(\n    ButtonCommandsList\n);","import Lang from '../../oop/lang.js';\n\n/**\n * ButtonKeystroke is a mixin that provides a `keystroke` prop that allows configuring\n * a function of the instance to be invoked upon the keystroke activation.\n *\n * @class ButtonKeystroke\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonKeystroke\n     * @method componentWillMount\n     */\n    componentWillMount() {\n        if (Lang.isFunction(super.componentWillMount)) {\n            super.componentWillMount();\n        }\n\n        var nativeEditor = this.props.editor.get('nativeEditor');\n        var keystroke = this.props.keystroke;\n\n        var commandName = keystroke.name || ((Math.random() * 1e9) >>> 0).toString();\n\n        var command = nativeEditor.getCommand(commandName);\n\n        if (!command) {\n            command = new CKEDITOR.command(nativeEditor, {\n                exec: function(editor) {\n                        var keystrokeFn = keystroke.fn;\n\n                        if (Lang.isString(keystrokeFn)) {\n                            this[keystrokeFn].call(this, editor);\n                        } else if (Lang.isFunction(keystrokeFn)) {\n                            keystrokeFn.call(this, editor);\n                        }\n                    }.bind(this)\n                }\n            );\n\n            nativeEditor.addCommand(commandName, command);\n        }\n\n        this._defaultKeystrokeCommand = nativeEditor.keystrokeHandler.keystrokes[keystroke.keys];\n\n        nativeEditor.setKeystroke(keystroke.keys, commandName);\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof ButtonKeystroke\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        if (Lang.isFunction(super.componentWillUnmount)) {\n            super.componentWillUnmount();\n        }\n\n        this.props.editor.get('nativeEditor').setKeystroke(this.props.keystroke.keys, this._defaultKeystrokeCommand);\n    }\n};","import WidgetFocusManager from '../base/widget-focus-manager.js';\nimport React from 'react';\n\n/**\n * The ButtonDropdown class provides markup and keyboard navigation behaviour to a dropdown\n * opened from a button.\n *\n * @class ButtonDropdown\n */\nclass ButtonDropdown extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonDropdown\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <div className=\"ae-dropdown ae-arrow-box ae-arrow-box-top-left\" onFocus={this.focus.bind(this)} onKeyDown={this.handleKey.bind(this)} tabIndex=\"0\">\n                <ul className=\"ae-listbox\" role=\"listbox\">\n                    {this.props.children}\n                </ul>\n            </div>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the dropdown in the configuration.\n *\n * @default dropdown\n * @memberof ButtonDropdown\n * @property {String} key\n * @static\n */\nButtonDropdown.key = 'dropdown';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonDropdown\n * @method getDefaultProps\n */\nButtonDropdown.defaultProps = {\n    circular: false,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    }\n};\n\nexport default WidgetFocusManager(\n    ButtonDropdown\n);","import Lang from '../../oop/lang.js';\n\n/**\n * ButtonActionStyle is a mixin that provides applying style implementation for a\n * button based on the `applyStyle` and `removeStyle` API of CKEDITOR.\n *\n * To execute properly, the component has to expose the following methods which can be obtained\n * out of the box using the {{#crossLink \"ButtonStyle\"}}{{/crossLink}} mixin:\n * - `Function` {{#crossLink \"ButtonStyle/isActive\"}}{{/crossLink}} to check the active state\n * - `Function` {{#crossLink \"ButtonStyle/getStyle\"}}{{/crossLink}} to return the style that should be applied\n *\n * @class ButtonActionStyle\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Removes or applies the component style to the current selection.\n     *\n     * @instance\n     * @memberof ButtonActionStyle\n     * @method applyStyle\n     */\n    applyStyle() {\n        if (Lang.isFunction(this.isActive) && Lang.isFunction(this.getStyle)) {\n            var editor = this.props.editor.get('nativeEditor');\n\n            editor.getSelection().lock();\n\n            if (this.isActive()) {\n                editor.removeStyle(this.getStyle());\n            } else {\n                editor.applyStyle(this.getStyle());\n            }\n\n            editor.getSelection().unlock();\n\n            editor.fire('actionPerformed', this);\n        }\n    }\n};","import ReactDOM from 'react-dom';\nimport Lang from '../../oop/lang.js';\n\n/**\n * Provides functionality for managing different dropdowns inside a widget.\n *\n * @class WidgetDropdown\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            ...this.state,\n            dropdownTrigger: null,\n            itemDropdown: null\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof WidgetDropdown\n     * @method componentWillReceiveProps\n     */\n    componentWillReceiveProps(nextProps) {\n        if (Lang.isFunction(super.componentWillReceiveProps)) {\n            super.componentWillReceiveProps();\n        }\n\n        this.setState({\n            dropdownTrigger: null,\n            itemDropdown: null\n        });\n    }\n\n    /**\n     * Merges the provided object with two more properties:\n     * - expanded - boolean flag which indicates if an widget should be rendered exclusively.\n     * - toggleDropdown - function, which can be used by an widget in order to obtain exclusive state.\n     *\n     * @instance\n     * @memberof WidgetDropdown\n     * @method mergeDropdownProps\n     * @param {Object} obj The properties container which should be merged with the properties, related\n     *    to dropdown state.\n     * @param {Object} itemKey They key of an React Widget which contains the dropdown.\n     * @return {Object} The merged object.\n     */\n    mergeDropdownProps(obj, itemKey) {\n        return CKEDITOR.tools.merge(obj, {\n            expanded: this.state.itemDropdown === itemKey ? true : false,\n            tabIndex: this.state.dropdownTrigger === itemKey ? 0 : -1,\n            toggleDropdown: this.toggleDropdown.bind(this, itemKey)\n        });\n    }\n\n    /**\n     * Sets the active dropdown of the widget or discards the toggled item from the state.\n     *\n     * @instance\n     * @memberof WidgetDropdown\n     * @method toggleDropdown\n     * @param {Object} itemDropdown The widget which requests to toggle its dropdown.\n     * @param {Number} toggleDirection User movement direction when toggled via keyboard.\n     */\n    toggleDropdown(itemDropdown, toggleDirection) {\n        this.setState({\n            dropdownTrigger: itemDropdown,\n            itemDropdown: itemDropdown !== this.state.itemDropdown ? itemDropdown : null\n        }, function() {\n            if (!this.state.itemDropdown) {\n                if (this.moveFocus) {\n                    this.moveFocus(toggleDirection);\n                } else {\n                    ReactDOM.findDOMNode(this).focus();\n                }\n            }\n        });\n    }\n};","import Lang from '../../oop/lang.js';\n\n/**\n * Provides functionality for managing exclusive state of an widget.\n * The exclusive state means that a button may request to be the only rendered\n * widget in its parent container. WidgetExclusive will manage this state by\n * filtering and suppressing the other sibling widgets from displaying.\n *\n * @class WidgetExclusive\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Cancels the exclusive state of an widget.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method cancelExclusive\n     * @param {Object} itemExclusive The widget which exclusive state should be canceled.\n     */\n    cancelExclusive(itemExclusive) {\n        if (this.state.itemExclusive === itemExclusive) {\n            this.setState({\n                itemExclusive: null\n            });\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     * Calling this.setState() within this function will not trigger an additional render.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method componentWillReceiveProps\n     * @param {Object} nextProps Object containing the current set of properties.\n     */\n    componentWillReceiveProps(nextProps) {\n        if (Lang.isFunction(super.componentWillReceiveProps)) {\n            super.componentWillReceiveProps();\n        }\n\n        // Receiving properties means that the component is being re-rendered.\n        // Re-rendering is triggered by editorInteraction, so we have to\n        // reset the exclusive state and render the UI according to the new selection.\n        this.setState({\n            itemExclusive: null\n        });\n    }\n\n    /**\n     * Filters the items and returns only those with exclusive state.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method filterExclusive\n     * @param {Array} items The widgets to be filtered.\n     * @return {Array|Object} The item with executive state.\n     */\n    filterExclusive(items) {\n        return items.filter(function(item) {\n            if (this.state.itemExclusive) {\n                if (this.state.itemExclusive === item.key) {\n                    return item;\n                }\n            } else {\n                return item;\n            }\n        }.bind(this));\n    }\n\n    /**\n     * Merges the provided object with three more properties:\n     * - cancelExclusive - function, which can be used by a widget in order to cancel executive state.\n     * - renderExclusive - boolean flag which indicates if an widget should be rendered exclusively.\n     * - requestExclusive - function, which can be used by a widget in order to obtain exclusive state.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method mergeExclusiveProps\n     * @param {Object} obj The properties container which should be merged with the properties, related\n     *    to exclusive state.\n     * @param {Object} itemKey They key of an React Widget which should be rendered exclusively.\n     * @return {Object} The merged object.\n     */\n    mergeExclusiveProps(obj, itemKey) {\n        return CKEDITOR.tools.merge(obj, {\n            cancelExclusive: this.cancelExclusive.bind(this, itemKey),\n            renderExclusive: (this.state.itemExclusive === itemKey),\n            requestExclusive: this.requestExclusive.bind(this, itemKey)\n        });\n    }\n\n    /**\n     * Requests and sets exclusive state of an widget.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method requestExclusive\n     * @param {Object} itemExclusive The widget which requests exclusive state.\n     */\n    requestExclusive(itemExclusive) {\n        this.setState({\n            itemExclusive: itemExclusive\n        });\n    }\n};","var _isRangeAtElementEnd = function(range, element) {\n    // Finding if a range is at the end of an element is somewhat tricky due to how CKEditor handles\n    // ranges. It might depend on wether a source node inside the element is selected or not. For now,\n    // we need to cover the following cases:\n    //\n    // - The text length of the element is the same as the endOffset of the range\n    // - Both start and end containers match the element and the start and end offsets are 1\n\n    return element.getText().length === range.endOffset ||\n        (\n            element.equals(range.startContainer) &&\n            element.equals(range.endContainer) &&\n            range.startOffset === range.endOffset &&\n            range.endOffset === 1\n        );\n};\n\nvar embedSelectionTest = function(payload) {\n    var selectionData = payload.data.selectionData;\n\n    return !!(\n        selectionData.element &&\n        selectionData.element.getAttribute('data-widget') === 'ae_embed'\n    );\n};\n\nvar linkSelectionTest = function(payload) {\n    var nativeEditor = payload.editor.get('nativeEditor');\n    var range = nativeEditor.getSelection().getRanges()[0];\n\n    var element;\n\n    return !!(\n        nativeEditor.isSelectionEmpty() &&\n        (element = (new CKEDITOR.Link(nativeEditor)).getFromSelection()) &&\n        element.getText().length !== range.endOffset &&\n        !element.isReadOnly() &&\n        !_isRangeAtElementEnd(range, element)\n    );\n};\n\nvar imageSelectionTest = function(payload) {\n    var selectionData = payload.data.selectionData;\n\n    return !!(\n        selectionData.element &&\n        selectionData.element.getName() === 'img' &&\n        !selectionData.element.isReadOnly()\n    );\n};\n\nvar textSelectionTest = function(payload) {\n    var nativeEditor = payload.editor.get('nativeEditor');\n\n    var selectionEmpty = nativeEditor.isSelectionEmpty();\n\n    var selectionData = payload.data.selectionData;\n\n    return !!(\n        !selectionData.element &&\n        selectionData.region &&\n        !selectionEmpty &&\n        !nativeEditor.getSelection().getCommonAncestor().isReadOnly()\n    );\n};\n\nvar tableSelectionTest = function(payload) {\n    var nativeEditor = payload.editor.get('nativeEditor');\n\n    var table = new CKEDITOR.Table(nativeEditor);\n    var element = table.getFromSelection();\n\n    return !!(element && table.isEditable(element));\n};\n\nconst SelectionTest = {\n    embed: embedSelectionTest,\n    image: imageSelectionTest,\n    link: linkSelectionTest,\n    table: tableSelectionTest,\n    text: textSelectionTest\n};\n\nexport default SelectionTest;","import ReactDOM from 'react-dom';\n\n/**\n * Calculates the position where an Widget should be displayed based on the point\n * where user interacted with the editor.\n *\n * @class WidgetPosition\n * @uses WidgetInteractionPoint\n */\nconst WidgetPosition = Component => {\n    class WidgetPositionComponent extends Component {\n        /**\n         * Cancels an scheduled animation frame.\n         *\n         * @instance\n         * @memberof WidgetPosition\n         * @method cancelAnimation\n         */\n        cancelAnimation() {\n            if (window.cancelAnimationFrame) {\n                window.cancelAnimationFrame(this._animationFrameId);\n            }\n        }\n\n        /**\n         * Returns an object which contains the position of the element in page coordinates,\n         * restricted to fit to given viewport.\n         *\n         * @instance\n         * @memberof WidgetPosition\n         * @method getConstrainedPosition\n         * @param {Object} attrs The following properties, provided as numbers:\n         * - height\n         * - left\n         * - top\n         * - width\n         * @param {Object} viewPaneSize Optional. If not provided, the current viewport will be used. Should contain at least these properties:\n         * - width\n         * @return {Object} An object with `x` and `y` properties, which represent the constrained position of the\n         * element.\n         */\n        getConstrainedPosition(attrs, viewPaneSize) {\n            viewPaneSize = viewPaneSize || new CKEDITOR.dom.window(window).getViewPaneSize();\n\n            var x = attrs.left;\n            var y = attrs.top;\n\n            if (attrs.left + attrs.width > viewPaneSize.width) {\n                x -= (attrs.left + attrs.width - viewPaneSize.width);\n            }\n\n            if (y < 0) {\n                y = 0;\n            }\n\n            return {\n                x: x,\n                y: y\n            };\n        }\n\n        /**\n         * Returns the position, in page coordinates, according to which a widget should appear.\n         * Depending on the direction of the selection, the wdiget may appear above of or on bottom of the selection.\n         *\n         * It depends on the props editorEvent to analyze the following user-interaction parameters:\n         * - {Object} selectionData The data about the selection in the editor as returned from\n         * {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n         * - {Number} pos Contains the coordinates of the position, considered as most appropriate.\n         * This may be the point where the user released the mouse, or just the beginning or the end of\n         * the selection.\n         *\n         * @instance\n         * @memberof WidgetInteractionPoint\n         * @method getInteractionPoint\n         * @return {Object} An Object which contains the following properties:\n         * direction, x, y, where x and y are in page coordinates and direction can be one of these:\n         * CKEDITOR.SELECTION_BOTTOM_TO_TOP or CKEDITOR.SELECTION_TOP_TO_BOTTOM\n         */\n        getInteractionPoint() {\n            var eventPayload = this.props.editorEvent ? this.props.editorEvent.data : null;\n\n            if (!eventPayload) {\n                return;\n            }\n\n            var selectionData = eventPayload.selectionData;\n\n            var nativeEvent = eventPayload.nativeEvent;\n\n            var pos = {\n                x: eventPayload.nativeEvent.pageX,\n                y: selectionData.region.top\n            };\n\n            var direction = selectionData.region.direction;\n\n            var endRect = selectionData.region.endRect;\n\n            var startRect = selectionData.region.startRect;\n\n            if (endRect && startRect && startRect.top === endRect.top) {\n                direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n            }\n\n            var x;\n            var y;\n\n            // If we have the point where user released the mouse, show Toolbar at this point\n            // otherwise show it on the middle of the selection.\n\n            if (pos.x && pos.y) {\n                x = this._getXPoint(selectionData, pos.x);\n\n                if (direction === CKEDITOR.SELECTION_BOTTOM_TO_TOP) {\n                    y = Math.min(pos.y, selectionData.region.top);\n                } else {\n                    y = Math.max(pos.y, this._getYPoint(selectionData, nativeEvent));\n                }\n            } else {\n                x = selectionData.region.left + selectionData.region.width / 2;\n\n                if (direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM) {\n\n                    y = this._getYPoint(selectionData, nativeEvent);\n\n                } else {\n                    y = selectionData.region.top;\n                }\n            }\n\n            return {\n                direction: direction,\n                x: x,\n                y: y\n            };\n        }\n\n        /**\n         * Returns the position of the Widget.\n         *\n         * @instance\n         * @memberof WidgetInteractionPoint\n         * @method _getXPoint\n         * @param {Object} eventX The X coordinate received from the native event (mouseup).\n         * @param {Object} selectionData The data about the selection in the editor as returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n         * @protected\n         * @return {Number} The calculated X point in page coordinates.\n         */\n        _getXPoint(selectionData, eventX) {\n            var region = selectionData.region;\n\n            var left = region.startRect ? region.startRect.left : region.left;\n            var right = region.endRect ? region.endRect.right : region.right;\n\n            var x;\n\n            if (left < eventX && right > eventX) {\n                x = eventX;\n            } else {\n                var leftDist = Math.abs(left - eventX);\n                var rightDist = Math.abs(right - eventX);\n\n                if (leftDist < rightDist) { // user raised the mouse on left on the selection\n                    x = left;\n                } else {\n                    x = right;\n                }\n            }\n\n            return x;\n        }\n\n        /**\n         * Returns the position of the Widget.\n         *\n         * @instance\n         * @memberof WidgetInteractionPoint\n         * @method _getYPoint\n         * @param {Object} nativeEvent The data about event is fired\n         * @param {Object} selectionData The data about the selection in the editor as returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n         * @protected\n         * @return {Number} The calculated Y point in page coordinates.\n         */\n        _getYPoint(selectionData, nativeEvent) {\n            var y = 0;\n\n            if (selectionData && nativeEvent) {\n                var elementTarget = new CKEDITOR.dom.element(nativeEvent.target);\n\n                if (elementTarget.$ && elementTarget.getStyle('overflow') === 'auto') {\n                    y = nativeEvent.target.offsetTop + nativeEvent.target.offsetHeight;\n                } else {\n                    y = selectionData.region.bottom;\n                }\n            }\n\n            return y;\n        }\n\n        /**\n         * Returns the position of the Widget taking in consideration the\n         * {{#crossLink \"WidgetPosition/gutter:attribute\"}}{{/crossLink}} attribute.\n         *\n         * @instance\n         * @memberof WidgetPosition\n         * @protected\n         * @method  getWidgetXYPoint\n         * @param {Number} left The left offset in page coordinates where Toolbar should be shown.\n         * @param {Number} top The top offset in page coordinates where Toolbar should be shown.\n         * @param {Number} direction The direction of the selection. May be one of the following:\n         * CKEDITOR.SELECTION_BOTTOM_TO_TOP or CKEDITOR.SELECTION_TOP_TO_BOTTOM\n         * @return {Array} An Array with left and top offsets in page coordinates.\n         */\n        getWidgetXYPoint(left, top, direction) {\n            var domNode = ReactDOM.findDOMNode(this);\n\n            var gutter = this.props.gutter;\n\n            if (direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM || direction === CKEDITOR.SELECTION_BOTTOM_TO_TOP) {\n                left = left - gutter.left - (domNode.offsetWidth / 2);\n\n                top = (direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM) ? (top + gutter.top) :\n                    (top - domNode.offsetHeight - gutter.top);\n\n            } else if (direction === CKEDITOR.SELECTION_LEFT_TO_RIGHT ||\n                direction === CKEDITOR.SELECTION_RIGHT_TO_LEFT) {\n\n                left = (direction === CKEDITOR.SELECTION_LEFT_TO_RIGHT) ?\n                    (left + gutter.left + domNode.offsetHeight / 2) :\n                    (left - 3 * domNode.offsetHeight / 2 - gutter.left);\n\n                top = top - gutter.top - (domNode.offsetHeight / 2);\n            }\n\n            if (left < 0) {\n                left = 0;\n            }\n\n            if (top < 0) {\n                top = 0;\n            }\n\n            return [left, top];\n        }\n\n        /**\n         * Returns true if the widget is visible, false otherwise\n         *\n         * @instance\n         * @memberof WidgetPosition\n         * @method isVisible\n         * @return {Boolean} True if the widget is visible, false otherwise\n         */\n        isVisible() {\n            var domNode = ReactDOM.findDOMNode(this);\n\n            if (domNode) {\n                var domElement = new CKEDITOR.dom.element(domNode);\n\n                return domElement.hasClass('alloy-editor-visible');\n            }\n\n            return false;\n        }\n\n        /**\n         * Moves a widget from a starting point to a destination point.\n         *\n         * @instance\n         * @memberof WidgetPosition\n         * @method moveToPoint\n         * @param  {Object} startPoint The starting point for the movement.\n         * @param  {Object} endPoint The destination point for the movement.\n         */\n        moveToPoint(startPoint, endPoint) {\n            var domElement = new CKEDITOR.dom.element(ReactDOM.findDOMNode(this));\n\n            domElement.setStyles({\n                left: startPoint[0] + 'px',\n                top: startPoint[1] + 'px',\n                opacity: 0\n            });\n\n            domElement.removeClass('alloy-editor-invisible');\n\n            this._animate(function() {\n                domElement.addClass('ae-toolbar-transition');\n                domElement.addClass('alloy-editor-visible');\n                domElement.setStyles({\n                    left: endPoint[0] + 'px',\n                    top: endPoint[1] + 'px',\n                    opacity: 1\n                });\n            });\n        }\n\n        /**\n         * Shows the widget with the default animation transition.\n         *\n         * @instance\n         * @memberof WidgetPosition\n         * @method show\n         */\n        show() {\n            var domNode = ReactDOM.findDOMNode(this);\n\n            if (!this.isVisible() && domNode) {\n                var interactionPoint = this.getInteractionPoint();\n\n                if (interactionPoint) {\n                    var domElement = new CKEDITOR.dom.element(domNode);\n\n                    var finalX,\n                        finalY,\n                        initialX,\n                        initialY;\n\n                    finalX = initialX = parseFloat(domElement.getStyle('left'));\n                    finalY = initialY = parseFloat(domElement.getStyle('top'));\n\n                    if (this.props.constrainToViewport) {\n                        var res = this.getConstrainedPosition({\n                            height: parseFloat(domNode.offsetHeight),\n                            left: finalX,\n                            top: finalY,\n                            width: parseFloat(domNode.offsetWidth)\n                        });\n\n                        finalX = res.x;\n                        finalY = res.y;\n                    }\n\n                    if (interactionPoint.direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM) {\n                        initialY = this.props.selectionData.region.bottom;\n                    } else {\n                        initialY = this.props.selectionData.region.top;\n                    }\n\n                    this.moveToPoint([initialX, initialY], [finalX, finalY]);\n                }\n            }\n        }\n\n        /**\n         * Updates the widget position based on the current interaction point.\n         *\n         * @instance\n         * @memberof WidgetPosition\n         * @method updatePosition\n         */\n        updatePosition() {\n            var interactionPoint = this.getInteractionPoint();\n\n            var domNode = ReactDOM.findDOMNode(this);\n\n            if (interactionPoint && domNode) {\n                var xy = this.getWidgetXYPoint(interactionPoint.x, interactionPoint.y, interactionPoint.direction);\n\n                new CKEDITOR.dom.element(domNode).setStyles({\n                    left: xy[0] + 'px',\n                    top: xy[1] + 'px'\n                });\n            }\n        }\n\n        /**\n         * Requests an animation frame, if possible, to simulate an animation.\n         *\n         * @instance\n         * @memberof WidgetPosition\n         * @method _animate\n         * @param {Function} callback The function to be executed on the scheduled frame.\n         * @protected\n         */\n        _animate(callback) {\n            if (window.requestAnimationFrame) {\n                this._animationFrameId = window.requestAnimationFrame(callback);\n            } else {\n                callback();\n            }\n        }\n    }\n\n    /**\n    * Lifecycle. Returns the default values of the properties used in the widget.\n    *\n    * @instance\n    * @memberof WidgetPosition\n    * @method getDefaultProps\n    */\n    WidgetPositionComponent.defaultProps = {\n        ...Component.defaultProps,\n        gutter: {\n            left: 0,\n            top: 10\n        },\n        constrainToViewport: true\n    };\n\n    return WidgetPositionComponent;\n};\n\nexport default WidgetPosition;","import Lang from '../../oop/lang.js';\n\n/**\n * Provides functionality for displaying Widget Arrow box on top or on bottom of the widget\n * depending on the point of user interaction with the editor.\n *\n * @class WidgetArrowBox\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Returns the list of arrow box classes associated to the current element's state. It relies\n     * on the getInteractionPoint method to calculate the selection direction.\n     *\n     * @instance\n     * @memberof WidgetArrowBox\n     * @method getArrowBoxClasses\n     * @return {String} A string with the arrow box CSS classes.\n     */\n    getArrowBoxClasses() {\n        var arrowBoxClasses = 'ae-arrow-box';\n\n        if (Lang.isFunction(this.getInteractionPoint) && this.getInteractionPoint()) {\n            if (this.getInteractionPoint().direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM) {\n                arrowBoxClasses += ' ae-arrow-box-top';\n            } else {\n                arrowBoxClasses += ' ae-arrow-box-bottom';\n            }\n        }\n\n        return arrowBoxClasses;\n    }\n};","import Lang from '../../oop/lang.js';\nimport React from 'react';\n\n/**\n * ToolbarButtons is a mixin which provides a list of buttons which have to be\n * displayed on the current toolbar depending on user preferences and given state.\n *\n * @class ToolbarButtons\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Analyzes the current selection and the buttons exclusive mode value to figure out which\n     * buttons should be present in a given state.\n     *\n     * @instance\n     * @memberof ToolbarButtons\n     * @method getToolbarButtons\n     * @param {Array} buttons The buttons could be shown, prior to the state filtering.\n     * @param {Object} additionalProps Additional props that should be passed down to the buttons.\n     * @return {Array} An Array which contains the buttons that should be rendered.\n     */\n    getToolbarButtons(buttons, additionalProps) {\n        var buttonProps = {};\n\n        var nativeEditor = this.props.editor.get('nativeEditor');\n        var buttonCfg = nativeEditor.config.buttonCfg || {};\n\n        if (Lang.isFunction(buttons)) {\n            buttons = buttons.call(this) || [];\n        }\n\n        var toolbarButtons = this.filterExclusive(\n                buttons.filter(function(button) {\n                    return button && (AlloyEditor.Buttons[button] || AlloyEditor.Buttons[button.name]);\n                })\n                .map(function(button) {\n                    if (Lang.isString(button)) {\n                        buttonProps[button] = buttonCfg[button];\n                        button = AlloyEditor.Buttons[button];\n                    } else if (Lang.isString(button.name)) {\n                        buttonProps[AlloyEditor.Buttons[button.name].key] = CKEDITOR.tools.merge(buttonCfg[button], button.cfg);\n                        button = AlloyEditor.Buttons[button.name];\n                    }\n\n                    return button;\n                })\n            )\n            .map(function(button) {\n                var props = this.mergeExclusiveProps({\n                    editor: this.props.editor,\n                    key: button.key,\n                    tabKey: button.key,\n                    tabIndex: (this.props.trigger && this.props.trigger.props.tabKey === button.key) ? 0 : -1,\n                    trigger: this.props.trigger\n                }, button.key);\n\n                props = this.mergeDropdownProps(props, button.key);\n\n                if (additionalProps) {\n                    props = CKEDITOR.tools.merge(props, additionalProps);\n                }\n\n                props = CKEDITOR.tools.merge(props, buttonProps[button.key]);\n\n                return React.createElement(button, props);\n            }, this);\n\n        return toolbarButtons;\n    }\n};","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nvar KEY_ENTER = 13;\nvar KEY_ESC = 27;\n\n/**\n * The ButtonTableEdit class provides functionality for creating and editing a table in a document.\n * Provides UI for creating a table.\n *\n * @class ButtonTableEdit\n */\nclass ButtonTableEdit extends React.Component {\n    /**\n     * Lifecycle. Invoked once before the component is mounted.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method getInitialState\n     */\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            cols: 3,\n            rows: 3\n        };\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client (not on the server),\n     * immediately after the initial rendering occurs.\n     *\n     * Focuses on the link input to immediately allow editing.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        ReactDOM.findDOMNode(this.refs.rows).focus();\n    }\n\n    /**\n     * Creates a table.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method _createTable\n     * @protected\n     */\n    _createTable() {\n        var editor = this.props.editor.get('nativeEditor');\n        var tableUtils = new CKEDITOR.Table(editor);\n\n        tableUtils.create({\n            attrs: this.props.tableAttributes,\n            cols: this.state.cols,\n            rows: this.state.rows\n        });\n\n        this.props.cancelExclusive();\n\n        editor.fire('actionPerformed', this);\n    }\n\n    /**\n     * Handles a change in input value. Sets the provided value from the user back to the input.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method _handleChange\n     * @param {String} inputName The name of the input which value should be updated.\n     * @param {SyntheticEvent} event The provided event.\n     * @protected\n     */\n    _handleChange(inputName, event) {\n        var state = {};\n        state[inputName] = event.target.value;\n\n        this.setState(state);\n    }\n\n    /**\n     * Monitors key interaction inside the input element to respond to the keys:\n     * - Enter: Creates the table.\n     * - Escape: Discards the changes.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method _handleKeyDown\n     * @param {SyntheticEvent} event The keyboard event.\n     * @protected\n     */\n    _handleKeyDown(event) {\n        if (event.keyCode === KEY_ENTER || event.keyCode === KEY_ESC) {\n            event.preventDefault();\n        }\n\n        if (event.keyCode === KEY_ENTER) {\n            this._createTable();\n        } else if (event.keyCode === KEY_ESC) {\n            this.props.cancelExclusive();\n        }\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var time = Date.now();\n        var rowsId = time + 'rows';\n        var colsId = time + 'cols';\n\n        return (\n            <div className=\"ae-container-edit-table\">\n                <label htmlFor={rowsId}>{AlloyEditor.Strings.rows}</label>\n                <div className=\"ae-container-input small\">\n                    <input className=\"ae-input\" id={rowsId} onChange={this._handleChange.bind(this, 'rows')} min=\"1\" onKeyDown={this._handleKeyDown.bind(this)} placeholder=\"Rows\" ref=\"rows\" type=\"number\" value={this.state.rows}></input>\n                </div>\n\n                <label htmlFor={colsId}>{AlloyEditor.Strings.columns}</label>\n                <div className=\"ae-container-input small\">\n                    <input className=\"ae-input\" id={colsId} onChange={this._handleChange.bind(this, 'cols')} min=\"1\" onKeyDown={this._handleKeyDown.bind(this)} placeholder=\"Colums\" ref=\"cols\" type=\"number\" value={this.state.cols}></input>\n                </div>\n\n                <button aria-label=\"Confirm\" className=\"ae-button\" onClick={this._createTable.bind(this)}>\n                    <span className=\"ae-icon-ok\"></span>\n                </button>\n            </div>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableEdit\n * @memberof ButtonTableEdit\n * @property {String} key\n * @static\n */\nButtonTableEdit.key = 'tableEdit';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonTableEdit\n * @method getDefaultProps\n */\nButtonTableEdit.defaultProps = {\n    tableAttributes: {\n        border: 1,\n        cellPadding: 0,\n        cellSpacing: 0,\n        style: 'width: 100%'\n    }\n};\n\nexport default ButtonTableEdit;","import ButtonDropdown from './button-dropdown.jsx';\nimport ButtonStylesListItem from './button-styles-list-item.jsx';\nimport ButtonStylesListItemRemove from './button-styles-list-item-remove.jsx';\nimport ButtonsStylesListHeader from './button-styles-list-header.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonStylesList class provides functionality for showing a list of styles that can be\n * applied to the current selection..\n *\n * @class ButtonStylesList\n * @uses WidgetFocusManager\n */\nclass ButtonStylesList extends React.Component {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses on the list node to allow keyboard interaction.\n     *\n     * @instance\n     * @memberof ButtonStylesList\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        ReactDOM.findDOMNode(this).focus();\n    }\n\n    /**\n     * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonStylesList\n     * @method componentWillMount\n     */\n    componentWillMount() {\n        var blockStyles = [];\n        var inlineStyles = [];\n        var objectStyles = [];\n\n        this.props.styles.forEach(function(item) {\n            var style = new CKEDITOR.style(item.style);\n\n            if (style.type === CKEDITOR.STYLE_BLOCK) {\n                blockStyles.push(item);\n            } else if (style.type === CKEDITOR.STYLE_INLINE) {\n                inlineStyles.push(item);\n            } else if (style.type === CKEDITOR.STYLE_OBJECT) {\n                objectStyles.push(item);\n            }\n        });\n\n        this._blockStyles = blockStyles;\n        this._inlineStyles = inlineStyles;\n        this._objectStyles = objectStyles;\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the list.\n     *\n     * @instance\n     * @memberof ButtonStylesList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var removeStylesItem;\n\n        if (this.props.showRemoveStylesItem) {\n            removeStylesItem = <ButtonStylesListItemRemove editor={this.props.editor} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        return (\n            <ButtonDropdown {...this.props}>\n                {removeStylesItem}\n\n                <ButtonsStylesListHeader name={AlloyEditor.Strings.blockStyles} styles={this._blockStyles} />\n                {this._renderStylesItems(this._blockStyles)}\n\n                <ButtonsStylesListHeader name={AlloyEditor.Strings.inlineStyles} styles={this._inlineStyles} />\n                {this._renderStylesItems(this._inlineStyles)}\n\n                <ButtonsStylesListHeader name={AlloyEditor.Strings.objectStyles} styles={this._objectStyles} />\n                {this._renderStylesItems(this._objectStyles)}\n            </ButtonDropdown>\n        );\n    }\n\n    /**\n     * Renders instances of ButtonStylesListItem with the preview of the correspondent block, inline or object styles.\n     *\n     * @instance\n     * @memberof ButtonStylesList\n     * @method _renderStylesItems\n     * @param {Array} styles List of styles for which preview should be rendered.\n     * @protected\n     * @return {Array} Rendered instances of ButtonStylesListItem class\n     */\n    _renderStylesItems(styles) {\n        var editor = this.props.editor;\n        var items;\n\n        if (styles && styles.length) {\n            items = styles.map(function(item) {\n                return (\n                    <li key={item.name} role=\"option\">\n                        <ButtonStylesListItem activeStyle={this.props.activeStyle} editor={editor} name={item.name} style={item.style} />\n                    </li>\n                );\n            }.bind(this));\n        }\n\n        return items;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @memberof ButtonStylesList\n * @static\n * @property {String} key\n * @default buttonStylesList\n */\nButtonStylesList.key = 'buttonStylesList';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonStylesList\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonStylesList.defaultProps = {\n    circular: false,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    },\n    showRemoveStylesItem: true\n};\n\nexport default WidgetFocusManager(\n    ButtonStylesList\n);","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonStylesListItem class provides functionality for previewing a style definition\n * inside a list and applying it to the current editor selection.\n *\n * @class ButtonStylesListItem\n * @uses ButtonActionStyle\n * @uses ButtonStyle\n */\nclass ButtonStylesListItem extends React.Component {\n    /**\n     * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonStylesListItem\n     * @method componentWillMount\n     */\n    componentWillMount() {\n        // Styles with wildcard element (*) generate an empty tag in their preview < class=\"custom-class\" />.\n        // We default to element span and remove the margins to obtain a more consistent set of previews.\n        var styleCfg = {\n            element: 'span',\n            styles: {\n                margin: 0\n            }\n        };\n\n        styleCfg = CKEDITOR.tools.merge(styleCfg, this.props.style);\n\n        this._preview = new CKEDITOR.style(styleCfg).buildPreview(this.props.name);\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonStylesListItem\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        // We need to use dangerouselySetInnterHTML since we're not in control of the style\n        // preview that is generated by CKEditor.\n        var className = this.props.name === this.props.activeStyle ? 'ae-toolbar-element active' : 'ae-toolbar-element';\n\n        return (\n            <button className={className} dangerouslySetInnerHTML={{__html: this._preview}} onClick={this._onClick.bind(this)} tabIndex={this.props.tabIndex}></button>\n        );\n    }\n\n    /**\n     * Applies the item style to the editor selection.\n     *\n     * @instance\n     * @memberof ButtonStylesListItem\n     * @method _onClick\n     * @protected\n     */\n    _onClick() {\n        // Typically, we want the style to be the only one applied to the current selection, so\n        // we execute the 'removeFormat' command first. Note that block styles won't be cleaned.\n        // However, this is consistent with other editors implementations of this feature.\n        this.props.editor.get('nativeEditor').execCommand('removeFormat');\n\n        this.applyStyle();\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonStylesListItem\n * @memberof ButtonStylesListItem\n * @property {String} key\n * @static\n */\nButtonStylesListItem.key = 'buttonStylesListItem';\n\nexport default ButtonActionStyle(\n    ButtonStyle(\n        ButtonStylesListItem\n));","import React from 'react';\n\n/**\n * The ButtonStylesListItemRemove class provides functionality for previewing a style definition\n * inside a list and applying it to the current editor selection.\n *\n * @class ButtonStylesListItemRemove\n */\nclass ButtonStylesListItemRemove extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonStylesListItemRemove\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <li role=\"option\">\n                <button className=\"ae-toolbar-element\" onClick={this._removeStyles.bind(this)} tabIndex={this.props.tabIndex}>{AlloyEditor.Strings.normal}</button>\n            </li>\n        );\n    }\n\n    /**\n     * Removes all inline styles and configured block elements applied to the current selection.\n     *\n     * @instance\n     * @memberof ButtonStylesListItemRemove\n     * @method _removeStyles\n     * @protected\n     */\n    _removeStyles() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.execCommand('removeFormat');\n\n        this.props.removeBlocks.forEach(function(blockItem) {\n            var blockStyle = new CKEDITOR.style({element: blockItem});\n\n            editor.removeStyle(blockStyle);\n        });\n\n        editor.fire('actionPerformed', this);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonStylesListItemRemove\n * @memberof ButtonStylesListItemRemove\n * @property {String} key\n * @static\n */\nButtonStylesListItemRemove.key = 'buttonStylesListItemRemove';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonStylesListItemRemove\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonStylesListItemRemove.defaultProps = {\n    removeBlocks: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'pre']\n};\n\nexport default ButtonStylesListItemRemove;\n","import React from 'react';\n\n/**\n * The ButtonsStylesListHeader class provides the header of an list of style items.\n *\n * @class ButtonsStylesListHeader\n */\nclass ButtonsStylesListHeader extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonsStylesListHeader\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.props.styles && this.props.styles.length) {\n            return (\n                <span className=\"ae-list-header\">{this.props.name}</span>\n            );\n        } else {\n            return null;\n        }\n    }\n}\n\nexport default ButtonsStylesListHeader;","import ButtonDropdown from './button-dropdown.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonTargetList class provides functionality for changing the target of a link\n * in the document.\n *\n * @class ButtonTargetList\n * @uses WidgetFocusManager\n */\nclass ButtonTargetList extends React.Component {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonTargetList\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        ReactDOM.findDOMNode(this).focus();\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTargetList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var listTargets = this._renderListTargets();\n\n        return (\n            <ButtonDropdown {...this.props}>\n                {listTargets}\n            </ButtonDropdown>\n        );\n    }\n\n    /**\n     * Returns the the allowed link target items.\n     *\n     * @instance\n     * @memberof ButtonTargetList\n     * @method _getAllowedTargetItems\n     * @protected\n     * @return {Array} The allowed target items.\n     */\n    _getAllowedTargetItems() {\n        return this.props.allowedLinkTargets || [{\n            label: AlloyEditor.Strings.linkTargetDefault,\n            value: ''\n        }, {\n            label: AlloyEditor.Strings.linkTargetSelf,\n            value: '_self'\n        }, {\n            label: AlloyEditor.Strings.linkTargetBlank,\n            value: '_blank'\n        }, {\n            label: AlloyEditor.Strings.linkTargetParent,\n            value: '_parent'\n        }, {\n            label: AlloyEditor.Strings.linkTargetTop,\n            value: '_top'\n        }];\n    }\n\n    /**\n     * Renders the allowed link target items.\n     *\n     * @instance\n     * @memberof ButtonTargetList\n     * @method _renderListTargets\n     * @protected\n     * @return {Object} Returns the rendered link items\n     */\n    _renderListTargets() {\n        var targets = this._getAllowedTargetItems();\n\n        var handleLinkTargetChange = this.props.handleLinkTargetChange;\n\n        targets = targets.map(function(target) {\n            var className = this.props.selectedTarget === target.value ? 'ae-toolbar-element active' : 'ae-toolbar-element';\n\n            return (\n                <li key={target.value} role=\"option\">\n                    <button className={className} data-value={target.value} onClick={handleLinkTargetChange}>{target.label}</button>\n                </li>\n            );\n        }.bind(this));\n\n        return targets;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default linkTargetEdit\n * @memberof ButtonTargetList\n * @property {String} key\n * @static\n */\nButtonTargetList.key = 'targetList';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonTargetList\n * @method getDefaultProps\n */\nButtonTargetList.defaultProps = {\n    circular: true,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    }\n};\n\nexport default WidgetFocusManager(\n    ButtonTargetList\n);","import ButtonTargetList from './button-target-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonLinkTargetEdit class provides functionality for changing the target of a link\n * in the document.\n *\n * @class ButtonLinkTargetEdit\n */\nclass ButtonLinkTargetEdit extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonLinkTargetEdit\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var handleLinkTargetChange = this.props.handleLinkTargetChange;\n        var allowedLinkTargets = this.props.allowedTargets;\n\n        return (\n            <div className=\"ae-container-edit-link-target ae-container-dropdown ae-container-dropdown-medium ae-has-dropdown\" tabIndex=\"0\">\n                <button aria-expanded={this.props.expanded} aria-label={this.props.selectedTarget} className=\"ae-toolbar-element\" onClick={this.props.toggleDropdown.bind(this)} role=\"combobox\" tabIndex={this.props.tabIndex} title={this.props.selectedTarget}>\n                    <div className=\"ae-container\">\n                        <span className=\"ae-container-dropdown-selected-item\">{this.props.selectedTarget}</span>\n                        <span className=\"ae-icon-arrow\"></span>\n                    </div>\n                </button>\n                {this.props.expanded && (\n                    <ButtonTargetList editor={this.props.editor} onDismiss={this.props.toggleDropdown} allowedLinkTargets={allowedLinkTargets} handleLinkTargetChange={handleLinkTargetChange} selectedTarget={this.props.selectedTarget}/>\n                )}\n            </div>\n        );\n    }\n\n    /**\n     * Lifecycle. Invoked before rendering when new props or state are being received.\n     * This method is not called for the initial render or when forceUpdate is used.\n     *\n     * @instance\n     * @memberof ButtonLinkTargetEdit\n     * @method  shouldComponentUpdate\n     * @return {Boolean} Returns false when the transition to the new props and state will not\n     * require a component update.\n     */\n    shouldComponentUpdate(nextProps) {\n        return nextProps.expanded !== this.props.expanded || nextProps.selectedTarget !== this.props.selectedTarget;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default linkTargetEdit\n * @memberof ButtonLinkTargetEdit\n * @property {String} key\n * @static\n */\nButtonLinkTargetEdit.key = 'linkTargetEdit';\n\nexport default ButtonLinkTargetEdit;\n","/**\n * ButtonCfgProps is a mixin that provides a style prop and some methods to apply the resulting\n * style and checking if it is present in a given path or selection.\n *\n * @class ButtonCfgProps\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Merges the properties, passed to the current component with user's configuration\n     * via `buttonCfg` property.\n     *\n     * @instance\n     * @memberof ButtonCfgProps\n     * @method mergeButtonCfgProps\n     * @param {Object} props The properties to be merged with the provided configuration for this\n     * button. If not passed, the user configuration will be merged with `this.props`\n     * @return {Object} The merged properties\n     */\n    mergeButtonCfgProps(props) {\n        props = props || this.props;\n\n        var nativeEditor = this.props.editor.get('nativeEditor');\n        var buttonCfg = nativeEditor.config.buttonCfg || {};\n        var result = CKEDITOR.tools.merge(props, buttonCfg['linkEdit']);\n\n        return result;\n    }\n};","import ButtonCfgProps from '../base/button-props.js';\nimport ButtonLinkAutocompleteList from './button-link-autocomplete-list.jsx';\nimport ButtonLinkTargetEdit from './button-link-target-edit.jsx';\nimport Lang from '../../oop/lang.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetDropdown from '../base/widget-dropdown.js';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonLinkEdit class provides functionality for creating and editing a link in a document.\n * Provides UI for creating, editing and removing a link.\n *\n * @class ButtonLinkEdit\n * @uses ButtonCfgProps\n * @uses WidgetDropdown\n * @uses WidgetFocusManager\n */\nclass ButtonLinkEdit extends React.Component {\n    constructor(props) {\n        super(props);\n\n        var link = new CKEDITOR.Link(props.editor.get('nativeEditor')).getFromSelection();\n        var href = link ? link.getAttribute('href') : '';\n        var target = link ? link.getAttribute('target') : props.defaultLinkTarget;\n\n        this.state = {\n            autocompleteSelected: false,\n            element: link,\n            initialLink: {\n                href: href,\n                target: target\n            },\n            linkHref: href,\n            linkTarget: target\n        };\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses on the link input to immediately allow editing. This should only happen if the component\n     * is rendered in exclusive mode to prevent aggressive focus stealing.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        if (this.props.renderExclusive || this.props.manualSelection) {\n            // We need to wait for the next rendering cycle before focusing to avoid undesired\n            // scrolls on the page\n            this._focusLinkInput();\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method componentWillReceiveProps\n     */\n    componentWillReceiveProps() {\n        this.replaceState(this.getInitialState());\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var targetSelector = {\n            allowedTargets: this.props.allowedTargets,\n            editor: this.props.editor,\n            handleLinkTargetChange: this._handleLinkTargetChange.bind(this),\n            selectedTarget: this.state.linkTarget || AlloyEditor.Strings.linkTargetDefault\n        };\n\n        targetSelector = this.mergeDropdownProps(targetSelector, ButtonLinkTargetEdit.key);\n\n        var autocompleteDropdown;\n\n        if (this.props.data) {\n            var dataFn = this.props.data;\n\n            if (!Lang.isFunction(dataFn)) {\n                var items = this.props.data;\n\n                dataFn = () => items;\n            }\n\n            var autocompleteDropdownProps = {\n                autocompleteSelected: this.state.autocompleteSelected,\n                data: dataFn,\n                editor: this.props.editor,\n                handleLinkAutocompleteClick: this._handleLinkAutocompleteClick,\n                onDismiss: this.props.toggleDropdown,\n                setAutocompleteState: this._setAutocompleteState,\n                term: this.state.linkHref\n            };\n\n            autocompleteDropdownProps = this.mergeDropdownProps(autocompleteDropdownProps, ButtonLinkAutocompleteList.key);\n\n            autocompleteDropdown = <ButtonLinkAutocompleteList {...autocompleteDropdownProps} />;\n        }\n\n        var targetButtonEdit;\n\n        if (this.props.showTargetSelector) {\n            targetButtonEdit = <ButtonLinkTargetEdit {...targetSelector} />;\n        }\n\n        var buttonClearLink;\n\n        if (this.state.linkHref) {\n            buttonClearLink = <button aria-label={AlloyEditor.Strings.clearInput} className=\"ae-button ae-icon-remove\" onClick={this._clearLink.bind(this)} title={AlloyEditor.Strings.clear}></button>;\n        }\n\n        var placeholderProp = {};\n\n        if (!CKEDITOR.env.ie && AlloyEditor.Strings) {\n            placeholderProp.placeholder = AlloyEditor.Strings.editLink;\n        }\n\n        return (\n            <div className=\"ae-container-edit-link\">\n                <button aria-label={AlloyEditor.Strings.removeLink} className=\"ae-button\" disabled={!this.state.element} onClick={this._removeLink.bind(this)} title={AlloyEditor.Strings.remove}>\n                    <span className=\"ae-icon-unlink\"></span>\n                </button>\n                <div className=\"ae-container-input xxl\">\n                    {targetButtonEdit}\n                    <div className=\"ae-container-input\">\n                        <input className=\"ae-input\" onChange={this._handleLinkHrefChange.bind(this)} onKeyDown={this._handleKeyDown.bind(this)} { ...placeholderProp } ref=\"linkInput\" type=\"text\" value={this.state.linkHref}></input>\n                        {autocompleteDropdown}\n                    </div>\n                    {buttonClearLink}\n                </div>\n                <button aria-label={AlloyEditor.Strings.confirm} className=\"ae-button\" disabled={!this._isValidState()} onClick={this._updateLink.bind(this)} title={AlloyEditor.Strings.confirm}>\n                    <span className=\"ae-icon-ok\"></span>\n                </button>\n            </div>\n        );\n    }\n\n    /**\n     * Clears the link input. This only changes the component internal state, but does not\n     * affect the link element of the editor. Only the _removeLink and _updateLink methods\n     * are translated to the editor element.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _clearLink\n     * @protected\n     */\n    _clearLink() {\n        this.setState({\n            linkHref: ''\n        });\n\n        this._focusLinkInput();\n    }\n\n    /**\n     * Focuses the user cursor on the widget's input.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _focusLinkInput\n     * @protected\n     */\n    _focusLinkInput() {\n        var instance = this;\n\n        var focusLinkEl = function() {\n            ReactDOM.findDOMNode(instance.refs.linkInput).focus();\n        };\n\n        if (window.requestAnimationFrame) {\n            window.requestAnimationFrame(focusLinkEl);\n        } else {\n            setTimeout(focusLinkEl, 0);\n        }\n    }\n\n    /**\n     * Monitors key interaction inside the input element to respond to the keys:\n     * - Enter: Creates/updates the link.\n     * - Escape: Discards the changes.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _handleKeyDown\n     * @param {SyntheticEvent} event The keyboard event.\n     * @protected\n     */\n    _handleKeyDown(event) {\n        if (event.keyCode === 13 || event.keyCode === 27) {\n            event.preventDefault();\n        }\n\n        if (event.keyCode === 13) {\n            this._updateLink();\n        } else if (event.keyCode === 40) {\n            this.setState({\n                autocompleteSelected: true\n            });\n        } else if (event.keyCode === 27) {\n            var editor = this.props.editor.get('nativeEditor');\n\n            new CKEDITOR.Link(editor).advanceSelection();\n\n            this.props.editor.get('nativeEditor').fire('actionPerformed', this);\n        }\n    }\n\n    /**\n     * Updates the component state when the link input changes on user interaction.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _handleLinkHrefChange\n     * @param {SyntheticEvent} event The change event.\n     * @protected\n     */\n    _handleLinkHrefChange(event) {\n        this.setState({\n            linkHref: event.target.value\n        });\n\n        this._focusLinkInput();\n    }\n\n    /**\n     * Updates the component state when the link target changes on user interaction.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _handleLinkTargetChange\n     * @param {SyntheticEvent} event The click event.\n     * @protected\n     */\n    _handleLinkTargetChange(event) {\n        this.setState({\n            itemDropdown: null,\n            linkTarget: event.target.getAttribute('data-value')\n        });\n\n        this._focusLinkInput();\n    }\n\n    /**\n     * Updates the component state when an autocomplete link result is selected by user interaction.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _handleLinkAutocompleteClick\n     * @param {SyntheticEvent} event The click event.\n     * @protected\n     */\n    _handleLinkAutocompleteClick(event) {\n        this.setState({\n            itemDropdown: null,\n            linkHref: event.target.getAttribute('data-value')\n        });\n\n        this._focusLinkInput();\n    }\n\n    /**\n     * Verifies that the current link state is valid so the user can save the link. A valid state\n     * means that we have a non-empty href and that either that or the link target are different\n     * from the original link.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _isValidState\n     * @protected\n     * @return {Boolean} [description]\n     */\n    _isValidState() {\n        var validState =\n            this.state.linkHref && (\n                this.state.linkHref !== this.state.initialLink.href ||\n                this.state.linkTarget !== this.state.initialLink.target\n            );\n\n        return validState;\n    }\n\n    /**\n     * Removes the link in the editor element.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _removeLink\n     * @protected\n     */\n    _removeLink() {\n        var editor = this.props.editor.get('nativeEditor');\n        var linkUtils = new CKEDITOR.Link(editor);\n        var selection = editor.getSelection();\n        var bookmarks = selection.createBookmarks();\n\n        linkUtils.remove(this.state.element, { advance: true });\n\n        selection.selectBookmarks(bookmarks);\n\n        // We need to cancelExclusive with the bound parameters in case the button is used\n        // inside another in exclusive mode (such is the case of the link button)\n        this.props.cancelExclusive();\n\n        editor.fire('actionPerformed', this);\n    }\n\n    /**\n     * Update autocompleteSelected state to focus and select autocompletes dropdown\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _setAutocompleteState\n     * @protected\n     */\n    _setAutocompleteState(state) {\n        this.setState({\n            autocompleteSelected: state.selected\n        });\n    }\n\n    /**\n     * Updates the link in the editor element. If the element didn't exist previously, it will\n     * create a new <a> element with the href specified in the link input.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _updateLink\n     * @protected\n     */\n    _updateLink() {\n        var editor = this.props.editor.get('nativeEditor');\n        var linkUtils = new CKEDITOR.Link(editor, {appendProtocol: this.props.appendProtocol});\n        var linkAttrs = {\n            target: this.state.linkTarget\n        };\n        var modifySelection = { advance: true };\n\n        if (this.state.linkHref) {\n            if (this.state.element) {\n                linkAttrs.href = this.state.linkHref;\n\n                linkUtils.update(linkAttrs, this.state.element, modifySelection);\n            } else {\n                linkUtils.create(this.state.linkHref, linkAttrs, modifySelection);\n            }\n\n            editor.fire('actionPerformed', this);\n        }\n\n        // We need to cancelExclusive with the bound parameters in case the button is used\n        // inside another in exclusive mode (such is the case of the link button)\n        this.props.cancelExclusive();\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default linkEdit\n * @memberof ButtonLinkEdit\n * @property {String} key\n * @static\n */\nButtonLinkEdit.key = 'linkEdit';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonLinkEdit\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonLinkEdit.defaultProps = {\n    appendProtocol: true,\n    autocompleteUrl: '',\n    circular: true,\n    customIndexStart: true,\n    defaultLinkTarget: '',\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    },\n    showTargetSelector: true\n};\n\nexport default ButtonCfgProps(\n    WidgetDropdown(\n    WidgetFocusManager(\n        ButtonLinkEdit\n)));\n","import ButtonDropdown from './button-dropdown.jsx';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\nimport React from 'react';\n\n/**\n * The ButtonLinkAutocompleteList class provides functionality for showing a list of\n * items that can be selected for the link.\n *\n * @class ButtonLinkAutocompleteList\n * @uses WidgetFocusManager\n */\nclass ButtonLinkAutocompleteList extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            items: []\n        };\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method componentWillReceiveProps\n     */\n    componentWillReceiveProps(nextProps) {\n        if (!nextProps.term || nextProps.term !== this.props.term) {\n            clearTimeout(this._timeout);\n\n            if (nextProps.term) {\n                this._timeout = setTimeout(this._updateItems, this.props.delay);\n            } else {\n                this.setState({\n                    items: []\n                });\n            }\n        }\n\n        if (nextProps.autocompleteSelected) {\n            setTimeout(this.focus, 0);\n            this.props.setAutocompleteState({\n                selected: false\n            });\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        clearTimeout(this._timeout);\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the list.\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (!this.props.expanded || !this.state.items.length) {\n            return null;\n        }\n\n        return (\n            <ButtonDropdown>\n                {this._renderAutocompleteItems(this.state.items)}\n            </ButtonDropdown>\n        );\n    }\n\n    /**\n     * Lifecycle. Invoked before rendering when new props or state are being received.\n     * This method is not called for the initial render or when forceUpdate is used.\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method  shouldComponentUpdate\n     * @return {Boolean} Returns false when the transition to the new props and state will not\n     * require a component update.\n     */\n    shouldComponentUpdate(nextProps, nextState) {\n        return nextProps.expanded !== this.props.expanded || nextProps.term !== this.props.term || nextState.items !== this.state.items;\n    }\n\n    /**\n     * Renders a set of list items for the provided items\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method _renderAutocompleteItems\n     * @param {Array} items List of autocomplete items to render\n     * @protected\n     * @return {Array} Rendered list item instances\n     */\n    _renderAutocompleteItems(items) {\n        items = items || [];\n\n        var handleLinkAutocompleteClick = this.props.handleLinkAutocompleteClick;\n\n        return items.map(function(item) {\n            var className = this.props.term === item.url ? 'ae-toolbar-element active' : 'ae-toolbar-element';\n\n            return (\n                <li key={item.url} role=\"option\">\n                    <button className={className} onClick={handleLinkAutocompleteClick} data-value={item.url}>{item.title}</button>\n                </li>\n            );\n        }.bind(this));\n    }\n\n    /**\n     * Retrieves the data according to {this.props.term} and calls setState() with the returned data\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method _updateItems\n     * @protected\n     */\n    _updateItems() {\n        var instance = this;\n\n        if (!this.props.term) {\n            return;\n        }\n\n        var promise = Promise.resolve(this.props.data(this.props.term));\n\n        promise.then(function(items) {\n            if (items.length) {\n                !instance.props.expanded && instance.props.toggleDropdown();\n            }\n\n            instance.setState({\n                items: items\n            });\n        });\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonLinkAutocompleteList\n * @memberof ButtonLinkAutocompleteList\n * @property {String} key\n * @static\n */\nButtonLinkAutocompleteList.key = 'buttonLinkAutocompleteList';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonLinkAutocompleteList\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonLinkAutocompleteList.defaultProps = {\n    circular: false,\n    data: [],\n    delay: 100,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    }\n};\n\nexport default WidgetFocusManager(\n    ButtonLinkAutocompleteList\n);","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nvar KEY_ENTER = 13;\nvar KEY_ESC = 27;\n\n/**\n * The ButtonEmbedEdit class provides functionality for creating and editing an embed link in a document.\n * Provides UI for creating and editing an embed link.\n *\n * @class ButtonEmbedEdit\n */\nclass ButtonEmbedEdit extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = this.getInitialState();\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses on the link input to immediately allow editing. This should only happen if the component\n     * is rendered in exclusive mode to prevent aggressive focus stealing.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        if (this.props.renderExclusive || this.props.manualSelection) {\n            // We need to wait for the next rendering cycle before focusing to avoid undesired\n            // scrolls on the page\n            if (window.requestAnimationFrame) {\n                window.requestAnimationFrame(this._focusLinkInput.bind(this));\n            } else {\n                setTimeout(this._focusLinkInput.bind(this), 0);\n            }\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method componentWillReceiveProps\n     */\n    componentWillReceiveProps() {\n        this.setState(this.getInitialState());\n    }\n\n    /**\n     * Lifecycle. Invoked once before the component is mounted.\n     * The return value will be used as the initial value of this.state.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method getInitialState\n     */\n    getInitialState() {\n        var editor = this.props.editor.get('nativeEditor');\n        var embed;\n\n        var selection = editor.getSelection();\n\n        if (selection) {\n            var selectedElement = selection.getSelectedElement();\n\n            if (selectedElement) {\n                embed = selectedElement.findOne('[data-widget=\"ae_embed\"]');\n            }\n        }\n\n        var href = embed ? embed.getAttribute('data-ae-embed-url') : '';\n\n        return {\n            element: embed,\n            initialLink: {\n                href: href\n            },\n            linkHref: href\n        };\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var clearLinkStyle = {\n            opacity: this.state.linkHref ? 1 : 0\n        };\n\n        return (\n            <div className=\"ae-container-edit-link\">\n                <button aria-label={AlloyEditor.Strings.deleteEmbed} className=\"ae-button\" data-type=\"button-embed-remove\" disabled={!this.state.element} onClick={this._removeEmbed.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.deleteEmbed}>\n                    <span className=\"ae-icon-bin\"></span>\n                </button>\n                <div className=\"ae-container-input xxl\">\n                    <input className=\"ae-input\" onChange={this._handleLinkHrefChange.bind(this)} onKeyDown={this._handleKeyDown.bind(this)} placeholder={AlloyEditor.Strings.editLink} ref=\"linkInput\" type=\"text\" value={this.state.linkHref}></input>\n                    <button aria-label={AlloyEditor.Strings.clearInput} className=\"ae-button ae-icon-remove\" onClick={this._clearLink.bind(this)} style={clearLinkStyle} title={AlloyEditor.Strings.clear}></button>\n                </div>\n                <button aria-label={AlloyEditor.Strings.confirm} className=\"ae-button\" disabled={!this._isValidState()} onClick={this._embedLink.bind(this)} title={AlloyEditor.Strings.confirm}>\n                    <span className=\"ae-icon-ok\"></span>\n                </button>\n            </div>\n        );\n    }\n\n    /**\n     * Clears the link input. This only changes the component internal state, but does not\n     * affect the link element of the editor. Only the _removeLink and _updateLink methods\n     * are translated to the editor element.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _clearLink\n     * @protected\n     */\n    _clearLink() {\n        this.setState({\n            linkHref: ''\n        });\n    }\n\n    /**\n     * Triggers the embedUrl command to transform the link into an embed media object\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _embedLink\n     * @protected\n     */\n    _embedLink() {\n        var nativeEditor = this.props.editor.get('nativeEditor');\n\n        nativeEditor.execCommand('embedUrl', {\n            url: this.state.linkHref\n        });\n\n        // We need to cancelExclusive with the bound parameters in case the button is used\n        // inside another in exclusive mode (such is the case of the link button)\n        this.props.cancelExclusive();\n    }\n\n    /**\n     * Focuses the user cursor on the widget's input.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _focusLinkInput\n     * @protected\n     */\n    _focusLinkInput() {\n        ReactDOM.findDOMNode(this.refs.linkInput).focus();\n    }\n\n    /**\n     * Monitors key interaction inside the input element to respond to the keys:\n     * - Enter: Creates/updates the link.\n     * - Escape: Discards the changes.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _handleKeyDown\n     * @param {SyntheticEvent} event The keyboard event.\n     * @protected\n     */\n    _handleKeyDown(event) {\n        if (event.keyCode === KEY_ENTER || event.keyCode === KEY_ESC) {\n            event.preventDefault();\n        }\n\n        if (event.keyCode === KEY_ENTER) {\n            this._embedLink();\n        } else if (event.keyCode === KEY_ESC) {\n            var editor = this.props.editor.get('nativeEditor');\n\n            // We need to cancelExclusive with the bound parameters in case the button is used\n            // inside another in exclusive mode (such is the case of the link button)\n            this.props.cancelExclusive();\n\n            editor.fire('actionPerformed', this);\n        }\n    }\n\n    /**\n     * Updates the component state when the link input changes on user interaction.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _handleLinkHrefChange\n     * @param {SyntheticEvent} event The change event.\n     * @protected\n     */\n    _handleLinkHrefChange(event) {\n        this.setState({\n            linkHref: event.target.value\n        });\n    }\n\n    /**\n     * Verifies that the current link state is valid so the user can save the link. A valid state\n     * means that we have a non-empty href that's different from the original one.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _isValidState\n     * @protected\n     * @return {Boolean} True if the state is valid, false otherwise\n     */\n    _isValidState() {\n        var validState =\n            this.state.linkHref && (\n                this.state.linkHref !== this.state.initialLink.href\n            );\n\n        return validState;\n    }\n\n    /**\n     * Removes the embed in the editor element.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _removeEmbed\n     * @protected\n     */\n    _removeEmbed() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        var embedWrapper = this.state.element.getAscendant(function(element) {\n            return element.hasClass('cke_widget_wrapper');\n        });\n\n        embedWrapper.remove();\n\n        editor.fire('actionPerformed', this);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default embedEdit\n * @memberof ButtonEmbedEdit\n * @property {String} key\n * @static\n */\nButtonEmbedEdit.key = 'embedEdit';\n\nexport default ButtonEmbedEdit;\n","import ButtonCommand from '../base/button-command.js';\nimport React from 'react';\n\n/**\n * The ButtonCommandListItem class is a UI class that renders a ButtonCommand that can be used inside\n * a list as an item, with a string representation of its behaviour.\n *\n * @class ButtonCommandListItem\n * @uses ButtonCommand\n */\nclass ButtonCommandListItem extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonCommandListItem\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <button aria-label={this.props.description} className={this._getClassName()} onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex}>{this.props.description}</button>\n        );\n    }\n\n    /**\n     * Returns the class name of Widget.\n     *\n     * @instance\n     * @memberof ButtonCommandListItem\n     * @method _getClassName\n     * @protected\n     * @return {String} The class name of the Widget.\n     */\n    _getClassName() {\n        var className = 'ae-toolbar-element';\n\n        if (this.props.icon) {\n            className += ' ae-icon-' + this.props.icon;\n        }\n\n        return className;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonCommandListItem\n * @memberof ButtonCommandListItem\n * @property {String} key\n * @static\n */\nButtonCommandListItem.key = 'buttonCommandListItem';\n\nexport default ButtonCommand(\n    ButtonCommandListItem\n);","import React from 'react';\nimport ReactDOM from 'react-dom';\n\n/**\n * The ButtonCameraImage class takes photo from camera and inserts it to the content.\n *\n * @class ButtonCameraImage\n */\nclass ButtonCameraImage extends React.Component {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses the take photo button.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        ReactDOM.findDOMNode(this.refs.buttonTakePhoto).focus();\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        if (this._stream) {\n            if (this._stream.stop) {\n                this._stream.stop();\n            } else if (this._stream.getVideoTracks) {\n                this._stream.getVideoTracks().forEach(function(track) {\n                    track.stop();\n                });\n            }\n            this._stream = null;\n        }\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var getUserMedia = navigator.getUserMedia ||\n            navigator.webkitGetUserMedia ||\n            navigator.mozGetUserMedia ||\n            navigator.msGetUserMedia;\n\n        getUserMedia.call(navigator, {\n            video: true,\n            audio: false\n        }, this._handleStreamSuccess.bind(this), this._handleStreamError.bind(this));\n\n        return (\n            <div className=\"ae-camera\">\n                <video ref=\"videoContainer\">Video stream not available.</video>\n                <button className=\"ae-camera-shoot\" onClick={this.takePhoto.bind(this)} ref=\"buttonTakePhoto\">Take photo</button>\n                <canvas className=\"ae-camera-canvas\" ref=\"canvasContainer\"></canvas>\n            </div>\n        );\n    }\n\n    /**\n     * Takes photo from the video stream and inserts in into editor's content.\n     *\n     * @fires ButtonCameraImage#imageCameraAdd\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method takePhoto\n     */\n    takePhoto() {\n        var videoEl = ReactDOM.findDOMNode(this.refs.videoContainer);\n        var canvasEl = ReactDOM.findDOMNode(this.refs.canvasContainer);\n\n        var context = canvasEl.getContext('2d');\n\n        var height = this._videoHeight;\n        var width = this.props.videoWidth;\n\n        if (width && height) {\n            canvasEl.width = width;\n            canvasEl.height = height;\n\n            context.drawImage(videoEl, 0, 0, width, height);\n\n            var imgURL = canvasEl.toDataURL('image/png');\n\n            var el = CKEDITOR.dom.element.createFromHtml('<img src=\"' + imgURL + '\">');\n\n            var editor = this.props.editor.get('nativeEditor');\n\n            editor.insertElement(el);\n\n            this.props.cancelExclusive();\n\n            editor.fire('actionPerformed', this);\n\n            editor.fire('imageCameraAdd', el);\n        }\n    }\n\n    /**\n     * Displays error message in case of video stream capturing failure.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method _handleStreamError\n     * @param {Event} error The fired event in case of error.\n     * @protected\n     */\n    _handleStreamError(error) {\n        window.alert('An error occurred! ' + error);\n    }\n\n    /**\n     * Starts streaming video in the video element and sets width/height to the video\n     * and canvas elements.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method _handleStreamSuccess\n     * @param {Object} stream The video stream\n     * @protected\n     */\n    _handleStreamSuccess(stream) {\n        var videoEl = ReactDOM.findDOMNode(this.refs.videoContainer);\n        var canvasEl = ReactDOM.findDOMNode(this.refs.canvasContainer);\n\n        videoEl.addEventListener('canplay', function(event) {\n            var height = videoEl.videoHeight / (videoEl.videoWidth/this.props.videoWidth);\n\n            if (isNaN(height)) {\n                height = this.props.videoWidth / (4/3);\n            }\n\n            videoEl.setAttribute('width', this.props.videoWidth);\n            videoEl.setAttribute('height', height);\n            canvasEl.setAttribute('width', this.props.videoWidth);\n            canvasEl.setAttribute('height', height);\n\n            this._videoHeight = height;\n        }.bind(this), false);\n\n        this._stream = stream;\n\n        if (navigator.mozGetUserMedia) {\n            videoEl.mozSrcObject = stream;\n        } else {\n            videoEl.src = (window.URL || window.webkitURL).createObjectURL(stream);\n        }\n\n        videoEl.play();\n\n        ReactDOM.findDOMNode(this.refs.buttonTakePhoto).disabled = false;\n    }\n\n    /**\n     * Fired when an image is being taken from the camera and added as an element to the editor.\n     *\n     * @event ButtonCameraImage#imageCameraAdd\n     * @memberof ButtonCameraImage\n     * @param {CKEDITOR.dom.element} el The created img element in editor.\n     */\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default cameraImage\n * @memberof ButtonCameraImage\n * @property {String} key\n * @static\n */\nButtonCameraImage.key = 'cameraImage';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonCameraImage\n * @method getDefaultProps\n */\nButtonCameraImage.defaultProps = {\n    videoWidth: 320\n};\n\nexport default ButtonCameraImage;\n","import Lang from './lang';\n\n/**\n * Sets the prototype, constructor and superclass properties to support an inheritance strategy\n * that can chain constructors and methods. Static members will not be inherited.\n *\n * @memberof OOP\n * @method extend\n * @param {Function} receiver The class which will extend another class.\n * @param {Function} supplier The class which will provide the properties the child class.\n * @param {Object} protoProps Prototype properties to add/override.\n * @param {Object} staticProps Static properties to add/overwrite.\n * @return {Function} The extended class.\n * @static\n */\nconst extend = function(receiver, supplier, protoProps, staticProps) {\n    if (!supplier || !receiver) {\n        throw 'extend failed, verify dependencies';\n    }\n\n    var supplierProto = supplier.prototype, receiverProto = Object.create(supplierProto);\n    receiver.prototype = receiverProto;\n\n    receiverProto.constructor = receiver;\n    receiver.superclass = supplierProto;\n\n    // assign constructor property\n    if (supplier !== Object && supplierProto.constructor === Object.prototype.constructor) {\n        supplierProto.constructor = supplier;\n    }\n\n    // add prototype overrides\n    if (protoProps) {\n        Lang.mix(receiverProto, protoProps);\n    }\n\n    // add object overrides\n    if (staticProps) {\n        Lang.mix(receiver, staticProps);\n    }\n\n    return receiver;\n};\n\nexport default extend;","import Lang from '../../oop/lang.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport ToolbarButtons from '../base/toolbar-buttons.js';\nimport WidgetArrowBox from '../base/widget-arrow-box.js';\nimport WidgetDropdown from '../base/widget-dropdown.js';\nimport WidgetExclusive from '../base/widget-exclusive.js';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\nimport WidgetPosition from '../base/widget-position.js';\n\n/**\n * The ToolbarStyles class hosts the buttons for styling a text selection.\n *\n * @class ToolbarStyles\n * @uses ToolbarButtons\n * @uses WidgetArrowBox\n * @uses WidgetDropdown\n * @uses WidgetExclusive\n * @uses WidgetFocusManager\n * @uses WidgetPosition\n */\nclass ToolbarStyles extends React.Component{\n    constructor(props) {\n        super(props);\n\n        this.state = {};\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client (not on the server),\n     * immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        this._updatePosition();\n    }\n\n    /**\n     * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method componentDidUpdate\n     * @param {Object} prevProps The previous state of the component's properties.\n     * @param {Object} prevState Component's previous state.\n     */\n    componentDidUpdate(prevProps, prevState) {\n        this._updatePosition();\n    }\n\n    /**\n     * Lifecycle. Renders the buttons for adding content or hides the toolbar\n     * if user interacted with a non-editable element.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method render\n     * @return {Object|null} The content which should be rendered.\n     */\n    render() {\n        var currentSelection = this._getCurrentSelection();\n\n        if (currentSelection) {\n            var getArrowBoxClassesFn = this._getSelectionFunction(currentSelection.getArrowBoxClasses);\n            var arrowBoxClasses;\n\n            if (getArrowBoxClassesFn) {\n                arrowBoxClasses = getArrowBoxClassesFn();\n            } else {\n                arrowBoxClasses = this.getArrowBoxClasses();\n            }\n\n            var cssClasses = 'ae-toolbar-styles ' + arrowBoxClasses;\n\n            var buttons = this.getToolbarButtons(\n                currentSelection.buttons,\n                {\n                    manualSelection: this.props.editorEvent ? this.props.editorEvent.data.manualSelection : null,\n                    selectionType: currentSelection.name\n                }\n            );\n\n            return (\n                <div aria-label={AlloyEditor.Strings.styles} className={cssClasses} data-tabindex={this.props.config.tabIndex || 0} onFocus={this.focus.bind(this)} onKeyDown={this.handleKey.bind(this)} role=\"toolbar\" tabIndex=\"-1\">\n                    <div className=\"ae-container\">\n                        {buttons}\n                    </div>\n                </div>\n            );\n        }\n\n        return null;\n    }\n\n    /**\n     * Retrieve a function from String. It converts a fully qualified string into the mapped function.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method _getSelectionFunction\n     * @param {Function|String} selectionFn A function, or a fully qualified string pointing to the desired one (e.g. 'AlloyEditor.SelectionTest.image').\n     * @protected\n     * @return {Function} The mapped function.\n     */\n    _getSelectionFunction(selectionFn) {\n        var selectionFunction;\n\n        if (Lang.isFunction(selectionFn)) {\n            selectionFunction = selectionFn;\n\n        } else if (Lang.isString(selectionFn)) {\n            var parts = selectionFn.split('.');\n            var currentMember = window;\n            var property = parts.shift();\n\n            while (property && Lang.isObject(currentMember) && Lang.isObject(currentMember[property])) {\n                currentMember = currentMember[property];\n                property = parts.shift();\n            }\n\n            if (Lang.isFunction(currentMember)) {\n                selectionFunction = currentMember;\n            }\n        }\n\n        return selectionFunction;\n    }\n\n    /**\n     * Analyzes the current editor selection and returns the selection configuration that matches.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method _getCurrentSelection\n     * @protected\n     * @return {Object} The matched selection configuration.\n     */\n    _getCurrentSelection() {\n        var eventPayload = this.props.editorEvent ? this.props.editorEvent.data : null;\n        var selection;\n\n        if (eventPayload) {\n            this.props.config.selections.some(function(item) {\n                var testFn = this._getSelectionFunction(item.test);\n                var result;\n\n                if (testFn) {\n                    result = eventPayload.manualSelection === item.name ||testFn({\n                        data: eventPayload,\n                        editor: this.props.editor\n                    });\n                }\n\n                if (result) {\n                    selection = item;\n                }\n\n                return result;\n            }, this);\n        }\n\n        return selection;\n    }\n\n    /**\n     * Calculates and sets the position of the toolbar.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method _updatePosition\n     * @protected\n     */\n    _updatePosition() {\n        // If component is not mounted, there is nothing to do\n        if (!ReactDOM.findDOMNode(this)) {\n            return;\n        }\n\n        var currentSelection = this._getCurrentSelection();\n        var result;\n\n        // If current selection has a function called `setPosition`, call it\n        // and check the returned value. If false, fallback to the default positioning logic.\n        if (currentSelection) {\n            var setPositionFn = this._getSelectionFunction(currentSelection.setPosition);\n\n            if (setPositionFn) {\n                result = setPositionFn.call(this, {\n                    editor: this.props.editor,\n                    editorEvent: this.props.editorEvent,\n                    selectionData: this.props.selectionData\n                });\n            }\n        }\n\n        if (!result) {\n            this.updatePosition();\n            this.show();\n        }\n    }\n}\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ToolbarStyles\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nToolbarStyles.defaultProps = {\n    circular: true,\n    descendants: '.ae-input, .ae-button:not([disabled]), .ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        next: [39, 40],\n        prev: [37, 38]\n    }\n};\n\n/**\n* The name which will be used as an alias of the button in the configuration.\n*\n* @default styles\n* @memberof ToolbarStyles\n* @property {String} key\n* @static\n*/\nToolbarStyles.key = 'styles';\n\nexport default WidgetArrowBox(\n    WidgetDropdown(\n    WidgetExclusive(\n    WidgetFocusManager(\n    WidgetPosition(\n    ToolbarButtons(\n        ToolbarStyles\n))))));","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport ToolbarButtons from '../base/toolbar-buttons.js';\nimport WidgetArrowBox from '../base/widget-arrow-box.js';\nimport WidgetDropdown from '../base/widget-dropdown.js';\nimport WidgetExclusive from '../base/widget-exclusive.js';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\nimport WidgetPosition from '../base/widget-position.js';\n\nvar POSITION_LEFT = 1;\nvar POSITION_RIGHT = 2;\n\n/**\n * The ToolbarAdd class provides functionality for adding content to the editor.\n *\n * @class ToolbarAdd\n * @uses ToolbarButtons\n * @uses WidgetArrowBox\n * @uses WidgetDropdown\n * @uses WidgetExclusive\n * @uses WidgetFocusManager\n * @uses WidgetPosition\n */\nclass ToolbarAdd extends React.Component{\n    constructor(props) {\n        super(props);\n\n        this.state = {};\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client (not on the server),\n     * immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        this._updatePosition();\n    }\n\n    /**\n     * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method componentDidUpdate\n     * @param {Object} prevProps The previous state of the component's properties.\n     * @param {Object} prevState Component's previous state.\n     */\n    componentDidUpdate(prevProps, prevState) {\n        this._updatePosition();\n\n        // In case of exclusive rendering, focus the first descendant (button)\n        // so the user will be able to start interacting with the buttons immediately.\n        if (this.props.renderExclusive) {\n            this.focus();\n        }\n    }\n\n    /**\n     * Lifecycle. Renders the buttons for adding content or hides the toolbar\n     * if user interacted with a non-editable element.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method render\n     * @return {Object|null} The content which should be rendered.\n     */\n    render() {\n        // Some operations such as `requestExclusive` may force editor to blur which will\n        // invalidate the `props.editorEvent` stored value, without causing a `props` change.\n        // For example, if the editor is empty, `ae_placeholder` plugin will remove\n        // the target from the DOM and will prevent `add` toolbar from rendering.\n        //\n        // It should be safe to assume that if you have been able to render the toolbar\n        // and request the exclusive mode, then rendering might be kept until the exclusive mode is left.\n        if (!this.state.itemExclusive &&\n                this.props.editorEvent &&\n                this.props.editorEvent.data.nativeEvent.target &&\n                !this.props.editorEvent.data.nativeEvent.target.isContentEditable) {\n            return null;\n        }\n\n        var buttons = this._getButtons();\n        var className = this._getToolbarClassName();\n\n        return (\n            <div aria-label={AlloyEditor.Strings.add} className={className} data-tabindex={this.props.config.tabIndex || 0} onFocus={this.focus.bind(this)} onKeyDown={this.handleKey.bind(this)} role=\"toolbar\" tabIndex=\"-1\">\n                <div className=\"ae-container\">\n                    {buttons}\n                </div>\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of buttons that will eventually render to HTML.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method _getButtons\n     * @protected\n     * @return {Object} The buttons which have to be rendered.\n     */\n    _getButtons() {\n        var buttons;\n\n        if (this.props.renderExclusive) {\n            buttons = this.getToolbarButtons(this.props.config.buttons);\n        } else {\n            if (this.props.selectionData && this.props.selectionData.region) {\n                buttons = (\n                    <button aria-label={AlloyEditor.Strings.add} className=\"ae-button ae-button-add\" onClick={this.props.requestExclusive.bind(this, ToolbarAdd.key)} title={AlloyEditor.Strings.add}>\n                        <span className=\"ae-icon-add\"></span>\n                    </button>\n                );\n            }\n        }\n\n        return buttons;\n    }\n\n    /**\n     * Returns the class name of the toolbar in case of both exclusive and normal mode.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method _getToolbarClassName\n     * @protected\n     * @return {String} The class name which have to be applied to the DOM element.\n     */\n    _getToolbarClassName() {\n        var cssClass = 'ae-toolbar-add';\n\n        if (this.props.renderExclusive) {\n            cssClass = 'ae-toolbar ' + this.getArrowBoxClasses();\n        }\n\n        return cssClass;\n    }\n\n    /**\n     * Calculates and sets the position of the toolbar in exclusive or normal mode.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method _updatePosition\n     * @protected\n     */\n    _updatePosition() {\n        var region;\n\n        // If component is not mounted, there is nothing to do\n        if (!ReactDOM.findDOMNode(this)) {\n            return;\n        }\n\n        if (this.props.renderExclusive) {\n            this.updatePosition();\n            this.show();\n        } else {\n            if (this.props.selectionData) {\n                region = this.props.selectionData.region;\n            }\n\n            if (region) {\n                var domNode = ReactDOM.findDOMNode(this);\n\n                var domElement = new CKEDITOR.dom.element(domNode);\n\n                var startRect = region.startRect || region;\n\n                var nativeEditor = this.props.editor.get('nativeEditor');\n\n                var clientRect = nativeEditor.editable().getClientRect();\n\n                var offsetLeft;\n\n                var position = this.props.config.position || this.props.position;\n\n                if (position === POSITION_LEFT) {\n                    offsetLeft = clientRect.left - domNode.offsetWidth - this.props.gutterExclusive.left + 'px';\n                } else {\n                    offsetLeft = clientRect.right + this.props.gutterExclusive.left + 'px';\n                }\n\n                domNode.style.left = offsetLeft;\n\n                domNode.style.top = Math.floor((region.bottom + region.top) / 2) + 'px';\n\n                if (nativeEditor.element.getStyle('overflow') !== 'auto') {\n                    domNode.style.top = Math.floor(region.top - domNode.offsetHeight/2 + startRect.height/2) + 'px';\n                } else {\n                    domNode.style.top = Math.floor( nativeEditor.element.$.offsetTop + (startRect.height / 2) - (domNode.offsetHeight / 2) ) + 'px';\n                }\n\n                domNode.style.opacity = 1;\n\n                domElement.removeClass('ae-arrow-box');\n\n                this.cancelAnimation();\n            }\n        }\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default add\n * @memberof ToolbarAdd\n * @property {String} key\n * @static\n */\nToolbarAdd.key = 'add';\n\n/**\n * Defines the constant for positioning the Toolbar on left of the editable area.\n *\n * @default 1\n * @memberof ToolbarAdd\n * @property {String} left\n * @static\n */\nToolbarAdd.left = POSITION_LEFT;\n\n/**\n * Defines the constant for positioning the Toolbar on right of the editable area.\n *\n * @default 2\n * @memberof ToolbarAdd\n * @property {String} right\n * @static\n */\nToolbarAdd.right = POSITION_RIGHT;\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ToolbarAdd\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nToolbarAdd.defaultProps = {\n    circular: true,\n    descendants: '.ae-button',\n    gutterExclusive: {\n        left: 10,\n        top: 0\n    },\n    keys: {\n        dismiss: [27],\n        next: [39, 40],\n        prev: [37, 38]\n    },\n    position: POSITION_LEFT\n};\n\nexport default WidgetArrowBox(\n    WidgetDropdown(\n    WidgetExclusive(\n    WidgetFocusManager(\n    WidgetPosition(\n    ToolbarButtons(\n        ToolbarAdd\n))))));","import ToolbarAdd from './toolbar-add.jsx';\nimport ToolbarStyles from './toolbar-styles.jsx';\n\nexport default {\n    [ToolbarAdd.key]: ToolbarAdd,\n    [ToolbarStyles.key]: ToolbarStyles\n};","import ButtonCommand from '../base/button-command.js';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonUnderline class provides functionality for underlying a text selection.\n *\n * @class ButtonUnderline\n * @uses ButtonCommand\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonUnderline extends React.Component{\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonUnderline\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.underline} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-underline\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.underline}>\n                <span className=\"ae-icon-underline\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default underline\n * @memberof ButtonUnderline\n * @property {String} key\n * @static\n */\nButtonUnderline.key = 'underline';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonUnderline\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonUnderline.defaultProps = {\n    command: 'underline',\n    keystroke: {\n        fn: 'execCommand',\n        keys: CKEDITOR.CTRL + 85 /*U*/\n    },\n    style: 'coreStyles_underline'\n};\n\nexport default ButtonCommand(\n    ButtonKeystroke(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonUnderline\n))));","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonUnorderedlist class provides functionality for creating unordered lists in an editor.\n *\n * @class ButtonUnorderedlist\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonUnorderedlist extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonUnorderedlist\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.bulletedlist} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-ul\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.bulletedlist}>\n                <span className=\"ae-icon-bulleted-list\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default ul\n * @memberof ButtonUnorderedlist\n * @property {String} key\n * @static\n */\nButtonUnorderedlist.key = 'ul';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonUnorderedlist\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonUnorderedlist.defaultProps = {\n    command: 'bulletedlist',\n    style: {\n        element: 'ul'\n    }\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonUnorderedlist\n)));","import ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonTwitter class provides functionality for creating a link which\n * allows people to tweet part of the content in the editor.\n *\n * @class ButtonTwitter\n * @uses ButtonStateClasses\n */\nclass ButtonTwitter extends React.Component {\n    /**\n     * Creates or removes the twitter link on the selection.\n     *\n     * @instance\n     * @memberof ButtonTwitter\n     * @method handleClick\n     */\n    handleClick() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        var linkUtils = new CKEDITOR.Link(editor);\n\n        if (this.isActive()) {\n            linkUtils.remove(linkUtils.getFromSelection());\n        } else {\n            linkUtils.create(\n                this._getHref(),\n                {\n                    'class': 'ae-twitter-link',\n                    'target': '_blank'\n                }\n            );\n        }\n\n        editor.fire('actionPerformed', this);\n    }\n\n    /**\n     * Checks if the current selection is contained within a link that points to twitter.com/intent/tweet.\n     *\n     * @instance\n     * @memberof ButtonTwitter\n     * @method isActive\n     * @return {Boolean} True if the selection is inside a twitter link, false otherwise.\n     */\n    isActive() {\n        var link = new CKEDITOR.Link(this.props.editor.get('nativeEditor')).getFromSelection();\n\n        return (link && (link.getAttribute('href').indexOf('twitter.com/intent/tweet') !== -1));\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTwitter\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.twitter} className={cssClass} data-type=\"button-twitter\" onClick={this.handleClick.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.twitter}>\n                <span className=\"ae-icon-twitter\"></span>\n            </button>\n        );\n    }\n\n    /**\n     * Generates the appropriate twitter url based on the selected text and the configuration\n     * options received via props.\n     *\n     * @instance\n     * @memberof ButtonTwitter\n     * @method _getHref\n     * @protected\n     * @return {String} A valid twitter url with the selected text and given configuration.\n     */\n    _getHref() {\n        var nativeEditor = this.props.editor.get('nativeEditor');\n        var selectedText = nativeEditor.getSelection().getSelectedText();\n        var url = this.props.url;\n        var via = this.props.via;\n        var twitterHref = 'https://twitter.com/intent/tweet?text=' + selectedText;\n\n        if (url) {\n            twitterHref += '&url=' + url;\n        }\n\n        if (via) {\n            twitterHref += '&via=' + via;\n        }\n\n        return twitterHref;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default twitter\n * @memberof ButtonTwitter\n * @property {String} key\n * @static\n */\nButtonTwitter.key = 'twitter';\n\nexport default ButtonStateClasses(\n    ButtonTwitter\n);","import ButtonTableEdit from './button-table-edit.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTable class provides functionality for creating and editing a table in a document. ButtonTable\n * renders in two different modes:\n *\n * - Normal: Just a button that allows to switch to the edition mode\n * - Exclusive: The ButtonTableEdit UI with all the table edition controls.\n *\n * @class ButtonTable\n */\nclass ButtonTable extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTable\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.props.renderExclusive) {\n            return (\n                <ButtonTableEdit {...this.props} />\n            );\n        } else {\n            return (\n                <button aria-label={AlloyEditor.Strings.table} className=\"ae-button\" data-type=\"button-table\" onClick={this.props.requestExclusive} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.table}>\n                    <span className=\"ae-icon-table\"></span>\n                </button>\n            );\n        }\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default table\n * @memberof ButtonTable\n * @property {String} key\n * @static\n */\nButtonTable.key = 'table';\n\nexport default ButtonTable;","import ButtonCommandsList from './button-commands-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableRow class provides functionality to work with table rows.\n *\n * @class ButtonTableRow\n */\nclass ButtonTableRow extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableRow\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var buttonCommandsList;\n        var buttonCommandsListId;\n\n        if (this.props.expanded) {\n            buttonCommandsListId = ButtonTableRow.key + 'List';\n            buttonCommandsList = <ButtonCommandsList commands={this._getCommands()} editor={this.props.editor} listId={buttonCommandsListId} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        return (\n            <div className=\"ae-container ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label={AlloyEditor.Strings.row} aria-owns={buttonCommandsListId} className=\"ae-button\" onClick={this.props.toggleDropdown.bind(this)} role=\"combobox\" tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.row}>\n                    <span className=\"ae-icon-row\"></span>\n                </button>\n                {buttonCommandsList}\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of commands. If a list of commands was passed\n     * as property `commands`, it will take a precedence over the default ones.\n     *\n     * @instance\n     * @memberof ButtonTableRow\n     * @method _getCommands\n     * @protected\n     * @return {Array} The list of available commands.\n     */\n    _getCommands() {\n        return this.props.commands || [\n            {\n                command: 'rowInsertBefore',\n                label: AlloyEditor.Strings.rowInsertBefore\n            },\n            {\n                command: 'rowInsertAfter',\n                label: AlloyEditor.Strings.rowInsertAfter\n            },\n            {\n                command: 'rowDelete',\n                label: AlloyEditor.Strings.rowDelete\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableRow\n * @memberof ButtonTableRow\n * @property {String} key\n * @static\n */\nButtonTableRow.key = 'tableRow';\n\nexport default ButtonTableRow;","import React from 'react';\n\n/**\n * The ButtonTableRemove class provides functionality for removing a table\n *\n * @class ButtonTableRemove\n */\nclass ButtonTableRemove extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableRemove\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <button aria-label={AlloyEditor.Strings.deleteTable} className=\"ae-button\" data-type=\"button-table-remove\" onClick={this._removeTable.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.deleteTable}>\n                <span className=\"ae-icon-bin\"></span>\n            </button>\n        );\n    }\n\n    /**\n     * Removes the table in the editor element.\n     *\n     * @instance\n     * @memberof ButtonTableRemove\n     * @method _removeTable\n     * @protected\n     */\n    _removeTable() {\n        var editor = this.props.editor.get('nativeEditor');\n        var tableUtils = new CKEDITOR.Table(editor);\n\n        tableUtils.remove();\n\n        editor.fire('actionPerformed', this);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableRemove\n * @memberof ButtonTableRemove\n * @property {String} key\n * @static\n */\nButtonTableRemove.key = 'tableRemove';\n\nexport default ButtonTableRemove;","import ButtonCommandsList from './button-commands-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableHeading class provides functionality to work with table heading.\n *\n * @class ButtonTableHeading\n */\nclass ButtonTableHeading extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableHeading\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var buttonCommandsList;\n        var buttonCommandsListId;\n\n        if (this.props.expanded) {\n            buttonCommandsListId = ButtonTableHeading.key + 'List';\n            buttonCommandsList = <ButtonCommandsList commands={this._getCommands()} editor={this.props.editor} listId={buttonCommandsListId} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        var activeHeading = new CKEDITOR.Table(this.props.editor.get('nativeEditor')).getHeading();\n        var activeHeadingIntro = AlloyEditor.Strings.headers + ':';\n        var activeHeadingLabel = AlloyEditor.Strings['headers' + activeHeading];\n\n        return (\n            <div className=\"ae-container-dropdown-xl ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label=\"\" className=\"ae-toolbar-element\" onClick={this.props.toggleDropdown.bind(this)} role=\"combobox\" tabIndex={this.props.tabIndex} title=\"\">\n                    <div className=\"ae-container\">\n                        <span className=\"ae-container-dropdown-selected-item\">{activeHeadingIntro} <strong>{activeHeadingLabel}</strong></span>\n                        <span className=\"ae-icon-arrow\"></span>\n                    </div>\n                </button>\n                {buttonCommandsList}\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of commands. If a list of commands was passed\n     * as property `commands`, it will take a precedence over the default ones.\n     *\n     * @instance\n     * @memberof ButtonTableHeading\n     * @method _getCommands\n     * @protected\n     * @return {Array} The list of available commands.\n     */\n    _getCommands() {\n        return this.props.commands || [\n            {\n                command: 'tableHeadingNone',\n                label: AlloyEditor.Strings.headersNone\n            },\n            {\n                command: 'tableHeadingRow',\n                label: AlloyEditor.Strings.headersRow\n            },\n            {\n                command: 'tableHeadingColumn',\n                label: AlloyEditor.Strings.headersColumn\n            },\n            {\n                command: 'tableHeadingBoth',\n                label: AlloyEditor.Strings.headersBoth\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableRow\n * @memberof ButtonTableHeading\n * @property {String} key\n * @static\n */\nButtonTableHeading.key = 'tableHeading';\n\nexport default ButtonTableHeading;","import ButtonCommandsList from './button-commands-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableColumn class provides functionality to work with table columns.\n *\n * @class ButtonTableColumn\n */\nclass ButtonTableColumn extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableColumn\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var buttonCommandsList,\n            buttonCommandsListId;\n\n        if (this.props.expanded) {\n            buttonCommandsListId = ButtonTableColumn.key + 'List';\n            buttonCommandsList = <ButtonCommandsList commands={this._getCommands()} editor={this.props.editor} listId={buttonCommandsListId} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        return (\n            <div className=\"ae-container ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label={AlloyEditor.Strings.column} aria-owns={buttonCommandsListId} className=\"ae-button\" onClick={this.props.toggleDropdown.bind(this)} role=\"listbox\" tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.column}>\n                    <span className=\"ae-icon-column\"></span>\n                </button>\n                {buttonCommandsList}\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of commands. If a list of commands was passed\n     * as property `commands`, it will take a precedence over the default ones.\n     *\n     * @instance\n     * @memberof ButtonTableColumn\n     * @method _getCommands\n     * @protected\n     * @return {Array} The list of available commands.\n     */\n    _getCommands() {\n        return this.props.commands || [\n            {\n                command: 'columnInsertBefore',\n                label: AlloyEditor.Strings.columnInsertBefore\n            },\n            {\n                command: 'columnInsertAfter',\n                label: AlloyEditor.Strings.columnInsertAfter\n            },\n            {\n                command: 'columnDelete',\n                label: AlloyEditor.Strings.columnDelete\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableColumn\n * @memberof ButtonTableColumn\n * @property {String} key\n * @static\n */\nButtonTableColumn.key = 'tableColumn';\n\nexport default ButtonTableColumn;","import ButtonCommandsList from './button-commands-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableCell class provides functionality to work with table cells.\n *\n * @class ButtonTableCell\n */\nclass ButtonTableCell extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableCell\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var buttonCommandsList;\n        var buttonCommandsListId;\n\n        if (this.props.expanded) {\n            buttonCommandsListId = ButtonTableCell.key + 'List';\n            buttonCommandsList = <ButtonCommandsList commands={this._getCommands()} editor={this.props.editor} listId={buttonCommandsListId} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        return (\n            <div className=\"ae-container ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label={AlloyEditor.Strings.cell} aria-owns={buttonCommandsListId} className=\"ae-button\" onClick={this.props.toggleDropdown.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.cell}>\n                    <span className=\"ae-icon-cell\"></span>\n                </button>\n                {buttonCommandsList}\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of commands. If a list of commands was passed\n     * as property `commands`, it will take a precedence over the default ones.\n     *\n     * @instance\n     * @memberof ButtonTableCell\n     * @method _getCommands\n     * @protected\n     * @return {Array} The list of available commands.\n     */\n    _getCommands() {\n        return this.props.commands || [\n            {\n                command: 'cellInsertBefore',\n                label: AlloyEditor.Strings.cellInsertBefore\n            },\n            {\n                command: 'cellInsertAfter',\n                label: AlloyEditor.Strings.cellInsertAfter\n            },\n            {\n                command: 'cellDelete',\n                label: AlloyEditor.Strings.cellDelete\n            },\n            {\n                command: 'cellMerge',\n                label: AlloyEditor.Strings.cellMerge\n            },\n            {\n                command: 'cellMergeDown',\n                label: AlloyEditor.Strings.cellMergeDown\n            },\n            {\n                command: 'cellMergeRight',\n                label: AlloyEditor.Strings.cellMergeRight\n            },\n            {\n                command: 'cellHorizontalSplit',\n                label: AlloyEditor.Strings.cellSplitHorizontal\n            },\n            {\n                command: 'cellVerticalSplit',\n                label: AlloyEditor.Strings.cellSplitVertical\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableCell\n * @memberof ButtonTableCell\n * @property {String} key\n * @static\n */\nButtonTableCell.key = 'tableCell';\n\nexport default ButtonTableCell;","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonSuperscript class provides functionality for applying superscript style to a text selection.\n *\n * @class ButtonSuperscript\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonSuperscript extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonSuperscript\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.superscript} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-superscript\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.superscript}>\n                <span className=\"ae-icon-superscript\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default superscript\n * @memberof ButtonSuperscript\n * @property {String} key\n * @static\n */\nButtonSuperscript.key = 'superscript';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonSuperscript\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonSuperscript.defaultProps = {\n    command: 'superscript',\n    style: 'coreStyles_superscript'\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonSuperscript\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonSubscript class provides functionality for applying subscript style to a text selection.\n *\n * @class ButtonSubscript\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonSubscript extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonSubscript\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.subscript} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-subscript\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.subscript}>\n                <span className=\"ae-icon-subscript\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default subscript\n * @memberof ButtonSubscript\n * @property {String} key\n * @static\n */\nButtonSubscript.key = 'subscript';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonSubscript\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonSubscript.defaultProps = {\n    command: 'subscript',\n    style: 'coreStyles_subscript'\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonSubscript\n)));","import ButtonStylesList from './button-styles-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonStyles class provides functionality for styling a selection with a list of\n * configurable and customizable styles. The allowed styles follow CKEDITOR.Style configuration\n * (http://docs.ckeditor.com/#!/api/CKEDITOR.style)\n *\n * @class ButtonStyles\n */\nclass ButtonStyles extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonStyles\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var activeStyle = AlloyEditor.Strings.normal;\n\n        var styles = this._getStyles();\n\n        styles.forEach(function(item) {\n            if (this._checkActive(item.style)) {\n                activeStyle = item.name;\n            }\n        }.bind(this));\n\n        var buttonStylesList;\n\n        if (this.props.expanded) {\n            buttonStylesList = <ButtonStylesList activeStyle={activeStyle} editor={this.props.editor} onDismiss={this.props.toggleDropdown} showRemoveStylesItem={this.props.showRemoveStylesItem} styles={styles} />;\n        }\n\n        return (\n            <div className=\"ae-container-dropdown ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label={AlloyEditor.Strings.styles + ' ' + activeStyle} className=\"ae-toolbar-element\" onClick={this.props.toggleDropdown.bind(this)} role=\"combobox\" tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.styles + ' ' + activeStyle}>\n                    <div className=\"ae-container\">\n                        <span className=\"ae-container-dropdown-selected-item\">{activeStyle}</span>\n                        <span className=\"ae-icon-arrow\"></span>\n                    </div>\n                </button>\n                {buttonStylesList}\n            </div>\n        );\n    }\n\n    /**\n     * Checks if the given style definition is applied to the current selection in the editor.\n     *\n     * @instance\n     * @memberof ButtonStyles\n     * @method _checkActive\n     * @param {Object} styleConfig Style definition as per http://docs.ckeditor.com/#!/api/CKEDITOR.style.\n     * @protected\n     * @return {Boolean} Returns true if the style is applied to the selection, false otherwise.\n     */\n    _checkActive(styleConfig) {\n        var nativeEditor = this.props.editor.get('nativeEditor');\n\n        // Styles with wildcard element (*) won't be considered active by CKEditor. Defaulting\n        // to a 'span' element works for most of those cases with no defined element.\n        styleConfig = CKEDITOR.tools.merge({element: 'span'}, styleConfig);\n\n        var style = new CKEDITOR.style(styleConfig);\n\n        return style.checkActive(nativeEditor.elementPath(), nativeEditor);\n    }\n\n    /**\n     * Returns an array of styles. Each style consists from two properties:\n     * - name - the style name, for example \"h1\"\n     * - style - an object with one property, called `element` which value\n     * represents the style which have to be applied to the element.\n     *\n     * @instance\n     * @memberof ButtonStyles\n     * @method _getStyles\n     * @protected\n     * @return {Array<object>} An array of objects containing the styles.\n     */\n    _getStyles() {\n        return this.props.styles || [\n            {\n                name: AlloyEditor.Strings.h1,\n                style: {\n                    element: 'h1'\n                }\n            },\n            {\n                name: AlloyEditor.Strings.h2,\n                style: {\n                    element: 'h2'\n                }\n            },\n            {\n                name: AlloyEditor.Strings.formatted,\n                style: {\n                    element: 'pre'\n                }\n            },\n            {\n                name: AlloyEditor.Strings.cite,\n                style: {\n                    element: 'cite'\n                }\n            },\n            {\n                name: AlloyEditor.Strings.code,\n                style: {\n                    element: 'code'\n                }\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default styles\n * @memberof ButtonStyles\n * @property {String} key\n * @static\n */\nButtonStyles.key = 'styles';\n\nexport default ButtonStyles;","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonStrike class styles a selection with strike style.\n *\n * @class ButtonStrike\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonStrike extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     * @instance\n     * @memberof ButtonStrike\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.strike} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-strike\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.strike}>\n                <span className=\"ae-icon-strike\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default strike\n * @memberof ButtonStrike\n * @property {String} key\n * @static\n */\nButtonStrike.key = 'strike';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonStrike\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonStrike.defaultProps = {\n    command: 'strike',\n    style: 'coreStyles_strike'\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonStrike\n)));","import ButtonCommand from '../base/button-command.js';\nimport React from 'react';\n\n/**\n * The ButtonRemoveFormat class removes style formatting.\n *\n * @class ButtonRemoveFormat\n * @uses ButtonCommand\n */\nclass ButtonRemoveFormat extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonRemoveFormat\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <button aria-label={AlloyEditor.Strings.removeformat} className='ae-button' data-type=\"button-removeformat\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.removeformat}>\n                <span className=\"ae-icon-removeformat\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default removeFormat\n * @memberof ButtonRemoveFormat\n * @property {String} key\n * @static\n */\nButtonRemoveFormat.key = 'removeFormat';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonRemoveFormat\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonRemoveFormat.defaultProps = {\n    command: 'removeFormat'\n};\n\nexport default ButtonCommand(\n    ButtonRemoveFormat\n);","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonQuote class wraps a selection in `blockquote` element.\n *\n * @class ButtonQuote\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonQuote extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonQuote\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.quote} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-quote\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.quote}>\n                <span className=\"ae-icon-quote\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default quote\n * @memberof ButtonQuote\n * @property {String} key\n * @static\n */\nButtonQuote.key = 'quote';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonQuote\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonQuote.defaultProps = {\n    command: 'blockquote',\n    style: {\n        element: 'blockquote'\n    }\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonQuote\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonParagraphJustify class provides functionality for justfying a paragraph.\n *\n * @class ButtonParagraphJustify\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphJustify extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonParagraphJustify\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignJustify} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-paragraph-justify\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignJustify}>\n                <span className=\"ae-icon-align-justified\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default paragraphJustify\n * @memberof ButtonParagraphJustify\n * @property {String} key\n * @static\n */\nButtonParagraphJustify.key = 'paragraphJustify';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonParagraphJustify\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonParagraphJustify.defaultProps = {\n    command: 'justifyblock'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonParagraphJustify\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonParagraphCenter class provides functionality for centering a paragraph.\n *\n * @class ButtonParagraphCenter\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphCenter extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonParagraphCenter\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignCenter} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-paragraph-center\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignCenter}>\n                <span className=\"ae-icon-align-center\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default paragraphCenter\n * @memberof ButtonParagraphCenter\n * @property {String} key\n * @static\n */\nButtonParagraphCenter.key = 'paragraphCenter';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonParagraphCenter\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonParagraphCenter.defaultProps = {\n    command: 'justifycenter'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonParagraphCenter\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n/**\n * The ButtonParagraphAlignRight class provides functionality for aligning a paragraph on right.\n *\n * @class ButtonParagraphAlignRight\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphAlignRight extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonParagraphAlignRight\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignRight} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-paragraph-align-right\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignRight}>\n                <span className=\"ae-icon-align-right\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default paragraphRight\n * @memberof ButtonParagraphAlignRight\n * @property {String} key\n * @static\n */\nButtonParagraphAlignRight.key = 'paragraphRight';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonParagraphAlignRight\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonParagraphAlignRight.defaultProps = {\n    command: 'justifyright'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonParagraphAlignRight\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n/**\n * The ButtonParagraphAlignLeft class provides functionality for aligning a paragraph on left.\n *\n * @class ButtonParagraphAlignLeft\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphAlignLeft extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonParagraphAlignLeft\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignLeft} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-paragraph-align-left\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignLeft}>\n                <span className=\"ae-icon-align-left\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default paragraphLeft\n * @memberof ButtonParagraphAlignLeft\n * @property {String} key\n * @static\n */\nButtonParagraphAlignLeft.key = 'paragraphLeft';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonParagraphAlignLeft\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonParagraphAlignLeft.defaultProps = {\n    command: 'justifyleft'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonParagraphAlignLeft\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonOutdentBlock class provides functionality for outdenting blocks.\n *\n * @class ButtonOutdentBlock\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonOutdentBlock extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonOutdentBlock\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.outdent} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-outdent-block\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.outdent}>\n                <span className=\"ae-icon-outdent-block\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default indentBlock\n * @memberof ButtonOutdentBlock\n * @property {String} key\n * @static\n */\nButtonOutdentBlock.key = 'outdentBlock';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonOutdentBlock\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonOutdentBlock.defaultProps = {\n    command: 'outdent'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonOutdentBlock\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonOrderedList class provides functionality for creating ordered lists in an editor.\n *\n * @class ButtonOrderedList\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonOrderedList extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonOrderedList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.numberedlist} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-ol\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.numberedlist}>\n                <span className=\"ae-icon-numbered-list\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default ol\n * @memberof ButtonOrderedList\n * @property {String} key\n * @static\n */\nButtonOrderedList.key = 'ol';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonOrderedList\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonOrderedList.defaultProps = {\n    command: 'numberedlist',\n    style: {\n        element: 'ol'\n    }\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonOrderedList\n)));","import ButtonCfgProps from '../base/button-props.js';\nimport ButtonLinkEdit from './button-link-edit.jsx';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonLink class provides functionality for creating and editing a link in a document. ButtonLink\n * renders in two different modes:\n *\n * - Normal: Just a button that allows to switch to the edition mode\n * - Exclusive: The ButtonLinkEdit UI with all the link edition controls.\n *\n * @class ButtonLink\n * @uses ButtonCfgProps\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n */\nclass ButtonLink extends React.Component {\n    /**\n     * Checks if the current selection is contained within a link.\n     *\n     * @instance\n     * @memberof ButtonLink\n     * @method isActive\n     * @return {Boolean} True if the selection is inside a link, false otherwise.\n     */\n    isActive() {\n        return (new CKEDITOR.Link(this.props.editor.get('nativeEditor')).getFromSelection() !== null);\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonLink\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        if (this.props.renderExclusive) {\n            var props = this.mergeButtonCfgProps();\n\n            return (\n                <ButtonLinkEdit {...props} />\n            );\n        } else {\n            return (\n                <button aria-label={AlloyEditor.Strings.link} className={cssClass} data-type=\"button-link\" onClick={this._requestExclusive.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.link}>\n                    <span className=\"ae-icon-link\"></span>\n                </button>\n            );\n        }\n    }\n\n    /**\n     * Requests the link button to be rendered in exclusive mode to allow the creation of a link.\n     *\n     * @instance\n     * @memberof ButtonLink\n     * @method _requestExclusive\n     * @protected\n     */\n    _requestExclusive() {\n        this.props.requestExclusive(ButtonLink.key);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default link\n * @memberof ButtonLink\n * @property {String} key\n * @static\n */\nButtonLink.key = 'link';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonLink\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonLink.defaultProps = {\n    keystroke: {\n        fn: '_requestExclusive',\n        keys: CKEDITOR.CTRL + 76 /*L*/\n    }\n};\n\nexport default ButtonCfgProps(\n    ButtonKeystroke(\n    ButtonStateClasses(\n        ButtonLink\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonItalic class provides functionality for styling an selection with italic (em) style.\n *\n * @class ButtonItalic\n * @uses ButtonCommand\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonItalic extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonItalic\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.italic} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-italic\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.italic}>\n                <span className=\"ae-icon-italic\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default italic\n * @memberof ButtonItalic\n * @property {String} key\n * @static\n */\nButtonItalic.key = 'italic';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonItalic\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonItalic.defaultProps = {\n    command: 'italic',\n    keystroke: {\n        fn: 'execCommand',\n        keys: CKEDITOR.CTRL + 73 /*I*/\n    },\n    style: 'coreStyles_italic'\n};\n\nexport default ButtonCommand(\n    ButtonKeystroke(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonItalic\n))));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonIndentBlock class provides functionality for indenting the selected blocks.\n *\n * @class ButtonIndentBlock\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonIndentBlock extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonIndentBlock\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.indent} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-indent-block\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.indent}>\n                <span className=\"ae-icon-indent-block\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default indentBlock\n * @memberof ButtonIndentBlock\n * @property {String} key\n * @static\n */\nButtonIndentBlock.key = 'indentBlock';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonIndentBlock\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonIndentBlock.defaultProps = {\n    command: 'indent'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonIndentBlock\n)));","import React from 'react';\nimport ReactDOM from 'react-dom';\n\n/**\n * The ButtonImage class inserts an image to the content.\n *\n * @class ButtonImage\n */\nclass ButtonImage extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonImage\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var inputSyle = {display: 'none'};\n\n        return (\n            <div>\n                <button aria-label={AlloyEditor.Strings.image} className=\"ae-button\" data-type=\"button-image\" onClick={this.handleClick.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.image}>\n                    <span className=\"ae-icon-image\"></span>\n                </button>\n\n                <input accept=\"image/*\" onChange={this._onInputChange.bind(this)} ref=\"fileInput\" style={inputSyle} type=\"file\"/>\n            </div>\n        );\n    }\n\n    /**\n     * Simulates click on the input element. This will open browser's native file open dialog.\n     *\n     * @instance\n     * @memberof ButtonImage\n     * @method handleClick\n     * @param {SyntheticEvent} event The received click event on the button.\n     */\n    handleClick() {\n        ReactDOM.findDOMNode(this.refs.fileInput).click();\n    }\n\n    /**\n     * On input change, reads the chosen file and fires an event `beforeImageAdd` with the image which will be added\n     * to the content. The image file will be passed in the `imageFiles` property.\n     * If any of the listeners returns `false` or cancels the event, the image won't be added to the content.\n     * Otherwise, an event `imageAdd` will be fired with the inserted element into the editable area.\n     * The passed params will be:\n     * - `el` - the created img element\n     * - `file` - the original image file from the input element\n     *\n     * @fires ButtonImage#beforeImageAdd\n     * @fires ButtonImage#imageAdd\n     * @instance\n     * @memberof ButtonImage\n     * @method _onInputChange\n     * @protected\n     */\n    _onInputChange() {\n        var inputEl = ReactDOM.findDOMNode(this.refs.fileInput);\n\n        // On IE11 the function might be called with an empty array of\n        // files. In such a case, no actions will be taken.\n        if (!inputEl.files.length) {\n            return;\n        }\n\n        var reader = new FileReader();\n        var file = inputEl.files[0];\n\n        reader.onload = function(event) {\n            var editor = this.props.editor.get('nativeEditor');\n\n            var result = editor.fire('beforeImageAdd', {\n                imageFiles: file\n            });\n\n            if (!!result) {\n                var el = CKEDITOR.dom.element.createFromHtml('<img src=\"' + event.target.result + '\">');\n\n                editor.insertElement(el);\n\n                editor.fire('actionPerformed', this);\n\n                var imageData = {\n                    el: el,\n                    file: file\n                };\n\n\n                editor.fire('imageAdd', imageData);\n            }\n        }.bind(this);\n\n        reader.readAsDataURL(file);\n\n        inputEl.value = '';\n    }\n\n    /**\n     * Fired before adding images to the editor.\n     *\n     * @event ButtonImage#beforeImageAdd\n     * @instance\n     * @memberof ButtonImage\n     * @param {Array} imageFiles Array of image files\n     */\n\n    /**\n     * Fired when an image is being added to the editor successfully.\n     *\n     * @event ButtonImage#imageAdd\n     * @instance\n     * @memberof ButtonImage\n     * @param {CKEDITOR.dom.element} el The created image with src as Data URI\n     * @param {File} file The image file\n     */\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default image\n * @memberof ButtonImage\n * @property {String} key\n * @static\n */\nButtonImage.key = 'image';\n\nexport default ButtonImage;","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonImageAlignRight class provides functionality for aligning an image on right.\n *\n * @class ButtonImageAlignRight\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonImageAlignRight extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonImageAlignRight\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignRight} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-image-align-right\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignRight}>\n                <span className=\"ae-icon-align-right\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default imageRight\n * @memberof ButtonImageAlignRight\n * @property {String} key\n * @static\n */\nButtonImageAlignRight.key = 'imageRight';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonImageAlignRight\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonImageAlignRight.defaultProps = {\n    command: 'justifyright'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonImageAlignRight\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonImageAlignLeft class provides functionality for aligning an image on left.\n *\n * @class ButtonImageAlignLeft\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonImageAlignLeft extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonImageAlignLeft\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignLeft} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-image-align-left\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignLeft}>\n                <span className=\"ae-icon-align-left\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default imageLeft\n * @memberof ButtonImageAlignLeft\n * @property {String} key\n * @static\n */\nButtonImageAlignLeft.key = 'imageLeft';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonImageAlignLeft\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonImageAlignLeft.defaultProps = {\n    command: 'justifyleft'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonImageAlignLeft\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonImageAlignCenter class provides functionality for aligning an image in the center.\n *\n * @class ButtonImageAlignCenter\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonImageAlignCenter extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonImageAlignCenter\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignCenter} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-image-align-center\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignCenter}>\n                <span className=\"ae-icon-align-center\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default imageCenter\n * @memberof ButtonImageAlignCenter\n * @property {String} key\n * @static\n */\nButtonImageAlignCenter.key = 'imageCenter';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonImageAlignCenter\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonImageAlignCenter.defaultProps = {\n    command: 'justifycenter'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonImageAlignCenter\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonHline class provides inserts horizontal line.\n *\n * @class ButtonHline\n * @uses ButtonCommand\n * @uses ButtonStyle\n */\nclass ButtonHline extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonHline\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <button aria-label={AlloyEditor.Strings.horizontalrule} className=\"ae-button\" data-type=\"button-hline\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.horizontalrule}>\n                <span className=\"ae-icon-separator\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default hline\n * @memberof ButtonHline\n * @property {String} key\n * @static\n */\nButtonHline.key = 'hline';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonHline\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonHline.defaultProps = {\n    command: 'horizontalrule',\n    style: {\n        element: 'hr'\n    }\n};\n\nexport default ButtonCommand(\n    ButtonStyle(\n        ButtonHline\n));","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonH2 class provides wraps a selection in `h2` element.\n *\n * @class ButtonH2\n * @uses ButtonActionStyle\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonH2 extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonH2\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.h2} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-h2\" onClick={this.applyStyle.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.h2}>\n                <span className=\"ae-icon-h2\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default h2\n * @memberof ButtonH2\n * @property {String} key\n * @static\n */\nButtonH2.key = 'h2';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonH2\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonH2.defaultProps = {\n    style: {\n        element: 'h2'\n    }\n};\n\nexport default ButtonActionStyle(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonH2\n)));","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonH1 class provides wraps a selection in `h1` element.\n *\n * @class ButtonH1\n * @uses ButtonActionStyle\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonH1 extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonH1\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.h1} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-h1\" onClick={this.applyStyle.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.h1}>\n                <span className=\"ae-icon-h1\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default h1\n * @memberof ButtonH1\n * @property {String} key\n * @static\n */\nButtonH1.key = 'h1';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonH1\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonH1.defaultProps = {\n    style: {\n        element: 'h1'\n    }\n};\n\nexport default ButtonActionStyle(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonH1\n)));","import ButtonEmbedEdit from './button-embed-edit.jsx';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport React from 'react';\n\n/**\n * The ButtonEmbed class provides functionality for creating and editing an embed link in a document.\n * ButtonEmbed renders in two different modes:\n *\n * - Normal: Just a button that allows to switch to the edition mode\n * - Exclusive: The ButtonEmbedEdit UI with all the link edition controls.\n *\n * @class ButtonEmbed\n * @uses ButtonKeystroke\n */\nclass ButtonEmbed extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonEmbed\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.props.renderExclusive) {\n            return (\n                <ButtonEmbedEdit {...this.props} />\n            );\n        } else {\n            return (\n                <button aria-label={AlloyEditor.Strings.link} className=\"ae-button\" data-type=\"button-embed\" onClick={this._requestExclusive.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.link}>\n                    <span className=\"ae-icon-add\"></span>\n                </button>\n            );\n        }\n    }\n\n    /**\n     * Requests the link button to be rendered in exclusive mode to allow the embedding of a link.\n     *\n     * @instance\n     * @memberof ButtonEmbed\n     * @method _requestExclusive\n     * @protected\n     */\n    _requestExclusive() {\n        this.props.requestExclusive(ButtonEmbed.key);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default embed\n * @memberof ButtonEmbed\n * @property {String} key\n * @static\n */\nButtonEmbed .key = 'embed';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonEmbed\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonEmbed.defaultProps = {\n    keystroke: {\n        fn: '_requestExclusive',\n        keys: CKEDITOR.CTRL + CKEDITOR.SHIFT + 76 /*L*/\n    }\n};\n\nexport default ButtonKeystroke(\n    ButtonEmbed\n);","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonCode class provides wraps a selection in `pre` element.\n *\n * @class ButtonCode\n * @uses ButtonActionStyle\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonCode extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonCode\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.code} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-code\" onClick={this.applyStyle.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.code}>\n                <span className=\"ae-icon-code\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default code\n * @memberof ButtonCode\n * @property {String} key\n * @static\n */\nButtonCode.key = 'code';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonCode\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonCode.defaultProps = {\n    style: {\n        element: 'pre'\n    }\n};\n\nexport default ButtonActionStyle(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonCode\n)));","import ButtonCameraImage from './button-camera-image.jsx';\nimport React from 'react';\n\n/**\n * The ButtonCamera class renders in two different ways:\n *\n * - Normal: Just a button that allows to switch to the edition mode.\n * - Exclusive: Renders ButtonCameraImage in order to take photo from the camera.\n *\n * @class ButtonCamera\n */\nclass ButtonCamera extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonCamera\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.props.renderExclusive) {\n            return (\n                <ButtonCameraImage {...this.props} />\n            );\n        } else {\n            var disabled = !(navigator.getUserMedia ||\n                (navigator.webkitGetUserMedia && location.protocol === 'https') ||\n                navigator.mozGetUserMedia ||\n                navigator.msGetUserMedia);\n\n            var label = disabled ? AlloyEditor.Strings.cameraDisabled : AlloyEditor.Strings.camera;\n\n            return (\n                <button aria-label={label} className=\"ae-button\" data-type=\"button-image-camera\" disabled={disabled} onClick={this.props.requestExclusive.bind(ButtonCamera.key)} tabIndex={this.props.tabIndex} title={label}>\n                    <span className=\"ae-icon-camera\"></span>\n                </button>\n            );\n        }\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default camera\n * @memberof ButtonCamera\n * @property {String} key\n * @static\n */\nButtonCamera.key = 'camera';\n\nexport default ButtonCamera;\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonBold class provides functionality for styling an selection with strong (bold) style.\n *\n * @class ButtonBold\n * @uses ButtonCommand\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonBold extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonBold\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.bold} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-bold\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.bold}>\n                <span className=\"ae-icon-bold\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default bold\n * @memberof ButtonBold\n * @property {String} key\n * @static\n */\nButtonBold.key = 'bold';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonBold\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonBold.defaultProps = {\n    command: 'bold',\n    keystroke: {\n        fn: 'execCommand',\n        keys: CKEDITOR.CTRL + 66 /*B*/\n    },\n    style: 'coreStyles_bold'\n};\n\nexport default ButtonCommand(\n    ButtonKeystroke(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonBold\n))));\n","import ButtonBold from './button-bold.jsx';\nimport ButtonCameraImage from './button-camera-image.jsx';\nimport ButtonCamera from './button-camera.jsx';\nimport ButtonCode from './button-code.jsx';\nimport ButtonCommandListItem from './button-command-list-item.jsx';\nimport ButtonCommandsList from './button-commands-list.jsx';\nimport ButtonDropdown from './button-dropdown.jsx';\nimport ButtonEmbedEdit from './button-embed-edit.jsx';\nimport ButtonEmbed from './button-embed.jsx';\nimport ButtonH1 from './button-h1.jsx';\nimport ButtonH2 from './button-h2.jsx';\nimport ButtonHline from './button-hline.jsx';\nimport ButtonImageAlignCenter from './button-image-align-center.jsx';\nimport ButtonImageAlignLeft from './button-image-align-left.jsx';\nimport ButtonImageAlignRight from './button-image-Align-right.jsx';\nimport ButtonImage from './button-image.jsx';\nimport ButtonIndentBlock from './button-indent-block.jsx';\nimport ButtonItalic from './button-italic.jsx';\nimport ButtonLinkAutocompleteList from './button-link-autocomplete-list.jsx';\nimport ButtonLinkEdit from './button-link-edit.jsx';\nimport ButtonLinkTargetEdit from './button-link-target-edit.jsx';\nimport ButtonLink from './button-link.jsx';\nimport ButtonOl from './button-ol.jsx';\nimport ButtonOutdentBlock from './button-outdent-block.jsx';\nimport ButtonParagraphAlignLeft from './button-paragraph-align-left.jsx';\nimport ButtonParagraphAlignRight from './button-paragraph-align-right.jsx';\nimport ButtonParagraphCenter from './button-paragraph-center.jsx';\nimport ButtonParagraphJustify from './button-paragraph-justify.jsx';\nimport ButtonQuote from './button-quote.jsx';\nimport ButtonRemoveFormat from './button-remove-format.jsx';\nimport ButtonStrike from './button-strike.jsx';\nimport ButtonStylesListHeader from './button-styles-list-header.jsx';\nimport ButtonStylesListItemRemove from './button-styles-list-item-remove.jsx';\nimport ButtonStylesListItem from './button-styles-list-item.jsx';\nimport ButtonStylesList from './button-styles-list.jsx';\nimport ButtonStyles from './button-styles.jsx';\nimport ButtonSubscript from './button-subscript.jsx';\nimport ButtonSuperscript from './button-superscript.jsx';\nimport ButtonTableCell from './button-table-cell.jsx';\nimport ButtonTableColumn from './button-table-column.jsx';\nimport ButtonTableEdit from './button-table-edit.jsx';\nimport ButtonTableHeading from './button-table-heading.jsx';\nimport ButtonTableRemove from './button-table-remove.jsx';\nimport ButtonTableRow from './button-table-row.jsx';\nimport ButtonTable from './button-table.jsx';\nimport ButtonTargetList from './button-target-list.jsx';\nimport ButtonTwitter from './button-twitter.jsx';\nimport ButtonUl from './button-ul.jsx';\nimport ButtonUnderline from './button-underline.jsx';\n\nexport default {\n    [ButtonBold.key]: ButtonBold,\n    [ButtonCameraImage.key]: ButtonCameraImage,\n    [ButtonCamera.key]: ButtonCamera,\n    [ButtonCode.key]: ButtonCode,\n    [ButtonCommandListItem.key]: ButtonCommandListItem,\n    [ButtonCommandsList.key]: ButtonCommandsList,\n    [ButtonDropdown.key]: ButtonDropdown,\n    [ButtonEmbedEdit.key]: ButtonEmbedEdit,\n    [ButtonEmbed.key]: ButtonEmbed,\n    [ButtonH1.key]: ButtonH1,\n    [ButtonH2.key]: ButtonH2,\n    [ButtonHline.key]: ButtonHline,\n    [ButtonImageAlignCenter.key]: ButtonImageAlignCenter,\n    [ButtonImageAlignLeft.key]: ButtonImageAlignLeft,\n    [ButtonImageAlignRight.key]: ButtonImageAlignRight,\n    [ButtonImage.key]: ButtonImage,\n    [ButtonIndentBlock.key]: ButtonIndentBlock,\n    [ButtonItalic.key]: ButtonItalic,\n    [ButtonLinkAutocompleteList.key]: ButtonLinkAutocompleteList,\n    [ButtonLinkEdit.key]: ButtonLinkEdit,\n    [ButtonLinkTargetEdit.key]: ButtonLinkTargetEdit,\n    [ButtonLink.key]: ButtonLink,\n    [ButtonOl.key]: ButtonOl,\n    [ButtonOutdentBlock.key]: ButtonOutdentBlock,\n    [ButtonParagraphAlignLeft.key]: ButtonParagraphAlignLeft,\n    [ButtonParagraphAlignRight.key]: ButtonParagraphAlignRight,\n    [ButtonParagraphCenter.key]: ButtonParagraphCenter,\n    [ButtonParagraphJustify.key]: ButtonParagraphJustify,\n    [ButtonQuote.key]: ButtonQuote,\n    [ButtonRemoveFormat.key]: ButtonRemoveFormat,\n    [ButtonStrike.key]: ButtonStrike,\n    [ButtonStylesListHeader.key]: ButtonStylesListHeader,\n    [ButtonStylesListItemRemove.key]: ButtonStylesListItemRemove,\n    [ButtonStylesListItem.key]: ButtonStylesListItem,\n    [ButtonStylesList.key]: ButtonStylesList,\n    [ButtonStyles.key]: ButtonStyles,\n    [ButtonSubscript.key]: ButtonSubscript,\n    [ButtonSuperscript.key]: ButtonSuperscript,\n    [ButtonTableCell.key]: ButtonTableCell,\n    [ButtonTableColumn.key]: ButtonTableColumn,\n    [ButtonTableEdit.key]: ButtonTableEdit,\n    [ButtonTableHeading.key]: ButtonTableHeading,\n    [ButtonTableRemove.key]: ButtonTableRemove,\n    [ButtonTableRow.key]: ButtonTableRow,\n    [ButtonTable.key]: ButtonTable,\n    [ButtonTargetList.key]: ButtonTargetList,\n    [ButtonTwitter.key]: ButtonTwitter,\n    [ButtonUl.key]: ButtonUl,\n    [ButtonUnderline.key]: ButtonUnderline\n};","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetExclusive from './base/widget-exclusive.js';\nimport WidgetFocusManager from './base/widget-focus-manager.js';\n\n/**\n * The main editor UI class manages a hierarchy of widgets (toolbars and buttons).\n *\n * @class UI\n * @uses WidgetExclusive\n * @uses WidgetFocusManager\n */\nclass UI extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            hidden: false\n        };\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof UI\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.on('editorInteraction', this._onEditorInteraction, this);\n        editor.on('actionPerformed', this._onActionPerformed, this);\n        editor.on('key', this._onEditorKey, this);\n\n        // Set up events for hiding the UI when user stops interacting with the editor.\n        // This may happen when he just clicks outside of the editor. However,\n        // this does not include a situation when he clicks on some button, part of\n        // editor's UI.\n\n        // It is not easy to debounce _setUIHidden on mousedown, because if we\n        // debounce it, when the handler is being invoked, the target might be no more part\n        // of the editor's UI - onActionPerformed causes re-render.\n        this._mousedownListener = function (event) {\n            this._setUIHidden(event.target);\n        }.bind(this);\n\n        this._keyDownListener = CKEDITOR.tools.debounce(function(event) {\n            this._setUIHidden(document.activeElement);\n        }, this.props.eventsDelay, this);\n\n        document.addEventListener('mousedown', this._mousedownListener);\n        document.addEventListener('keydown', this._keyDownListener);\n    }\n\n    /**\n     * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n     * Fires `ariaUpdate` event passing ARIA related messages.\n     * Fires `editorUpdate` event passing the previous and current properties and state.\n     *\n     * @instance\n     * @memberof UI\n     * @method componentDidUpdate\n     */\n    componentDidUpdate (prevProps, prevState) {\n        var domNode = ReactDOM.findDOMNode(this);\n\n        var editor = this.props.editor.get('nativeEditor');\n\n        if (domNode) {\n            editor.fire('ariaUpdate', {\n                message: this._getAvailableToolbarsMessage(domNode)\n            });\n        }\n\n        editor.fire('editorUpdate', {\n            prevProps: prevProps,\n            prevState: prevState,\n            props: this.props,\n            state: this.state\n        });\n    }\n\n    _getAriaUpdateTemplate(ariaUpdate) {\n        if (!this._ariaUpdateTemplates) {\n            this._ariaUpdateTemplates = {};\n        }\n\n        if (!this._ariaUpdateTemplates[ariaUpdate]) {\n            this._ariaUpdateTemplates[ariaUpdate] = new CKEDITOR.template(this._getAriaUpdates()[ariaUpdate]);\n        }\n\n        return this._ariaUpdateTemplates[ariaUpdate];\n    }\n\n    /**\n     * Returns the templates for ARIA messages.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _getAriaUpdates\n     * @return {Object} ARIA relates messages. Default:\n     * {\n     *      noToolbar: AlloyEditor.Strings.ariaUpdateNoToolbar,\n     *      oneToolbar: AlloyEditor.Strings.ariaUpdateOneToolbar,\n     *      manyToolbars: AlloyEditor.Strings.ariaUpdateManyToolbars\n     *  }\n     */\n    _getAriaUpdates() {\n        return this.props.ariaUpdates || {\n            noToolbar: AlloyEditor.Strings.ariaUpdateNoToolbar,\n            oneToolbar: AlloyEditor.Strings.ariaUpdateOneToolbar,\n            manyToolbars: AlloyEditor.Strings.ariaUpdateManyToolbars\n        };\n    }\n\n    /**\n     * Returns an ARIA message which represents the number of currently available toolbars.\n     *\n     * @instance\n     * @memberof UI\n     * @method _getAvailableToolbarsMessage\n     * @protected\n     * @param {CKEDITOR.dom.element} domNode The DOM node from which the available toolbars will be retrieved.\n     * @return {String} The ARIA message for the number of available toolbars\n     */\n    _getAvailableToolbarsMessage(domNode) {\n        var toolbarsNodeList = domNode.querySelectorAll('[role=\"toolbar\"]');\n\n        if (!toolbarsNodeList.length) {\n            return this._getAriaUpdates().noToolbar;\n        } else {\n            var toolbarNames = Array.prototype.slice.call(toolbarsNodeList).map(function(toolbar) {\n                return toolbar.getAttribute('aria-label');\n            });\n\n            var ariaUpdate = toolbarNames.length === 1 ? 'oneToolbar' : 'manyToolbars';\n\n            return this._getAriaUpdateTemplate(ariaUpdate).output({\n                toolbars: toolbarNames.join(',').replace(/,([^,]*)$/, ' and ' + '$1')\n            });\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof UI\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        if (this._mousedownListener) {\n            document.removeEventListener('mousedown', this._mousedownListener);\n        }\n\n        if (this._keyDownListener) {\n            this._keyDownListener.detach();\n            document.removeEventListener('keydown', this._keyDownListener);\n        }\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the editor. This may include several toolbars and buttons.\n     * The editor's UI also takes care of rendering the items in exclusive mode.\n     *\n     * @instance\n     * @memberof UI\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.state.hidden) {\n            return null;\n        }\n\n        var toolbars = Object.keys(this.props.toolbars).map(function(toolbar) {\n            return AlloyEditor.Toolbars[toolbar] || window[toolbar];\n        });\n\n        toolbars = this.filterExclusive(toolbars).map(function(toolbar) {\n            var props = this.mergeExclusiveProps({\n                config: this.props.toolbars[toolbar.key],\n                editor: this.props.editor,\n                editorEvent: this.state.editorEvent,\n                key: toolbar.key,\n                onDismiss: this._onDismissToolbarFocus,\n                selectionData: this.state.selectionData\n            }, toolbar.key);\n\n            return React.createElement(toolbar, props);\n        }.bind(this));\n\n        return (\n            <div className=\"ae-toolbars\" onKeyDown={this.handleKey.bind(this)}>\n                {toolbars}\n            </div>\n        );\n    }\n\n    /**\n     * Listener to the editor's `actionPerformed` event. Sets state and redraws the UI of the editor.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _onActionPerformed\n     * @param {SynteticEvent} event The provided event\n     */\n    _onActionPerformed(event) {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.focus();\n\n        this.setState({\n            itemExclusive: null,\n            selectionData: editor.getSelectionData()\n        });\n    }\n\n    /**\n     * Executed when a dismiss key is pressed over a toolbar to return the focus to the editor.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _onDismissToolbarFocus\n     */\n    _onDismissToolbarFocus() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.focus();\n    }\n\n    /**\n     * Listener to the editor's `userInteraction` event. Retrieves the data about the user selection and\n     * provides it via component's state property.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _onEditorInteraction\n     * @param {SynteticEvent} event The provided event\n     */\n    _onEditorInteraction(event) {\n        this.setState({\n            editorEvent: event,\n            hidden: false,\n            itemExclusive: null,\n            selectionData: event.data.selectionData\n        });\n    }\n\n    /**\n     * Focuses on the active toolbar when the combination ALT+F10 is pressed inside the editor.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _onEditorKey\n     */\n    _onEditorKey(event) {\n        var nativeEvent = event.data.domEvent.$;\n\n        if (nativeEvent.altKey && nativeEvent.keyCode === 121) {\n            this.focus();\n        }\n    }\n\n    /**\n     * Checks if the target with which the user interacted is part of editor's UI or it is\n     * the editable area. If none of these, sets the state of editor's UI to be hidden.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _setUIHidden\n     * @param {DOMElement} target The DOM element with which user interacted lastly.\n     */\n    _setUIHidden(target) {\n        var domNode = ReactDOM.findDOMNode(this);\n\n        if (domNode) {\n            var editable = this.props.editor.get('nativeEditor').editable();\n            var targetNode = new CKEDITOR.dom.node(target);\n\n            if (!editable) {\n                this.setState({\n                    hidden: true\n                });\n            } else {\n                var res = (editable.$ === target) || editable.contains(targetNode) ||\n                    (new CKEDITOR.dom.element(domNode)).contains(targetNode);\n\n                if (!res) {\n                    this.setState({\n                        hidden: true\n                    });\n                }\n            }\n        }\n    }\n}\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof UI\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nUI.defaultProps = {\n    circular: true,\n    descendants: '[class^=ae-toolbar-]',\n    eventsDelay: 0,\n    keys: {\n        next: 9\n    }\n};\n\n/**\n * Fired when component updates and when it is rendered in the DOM.\n * The payload consists from a `message` property containing the ARIA message.\n *\n * @event ariaUpdate\n */\n\n/**\n * Fired when component updates. The payload consists from an object with the following\n * properties:\n * - prevProps - The previous properties of the component\n * - prevState - The previous state of the component\n * - props - The current properties of the component\n * - state - The current state of the component\n *\n * @event ariaUpdate\n */\n\nexport default WidgetExclusive(\n    WidgetFocusManager(\n        UI\n));","import ReactDOM from 'react-dom';\n\n// Default gutter value for toolbar positioning\nvar DEFAULT_GUTTER = {\n    left: 0,\n    top: 0\n};\n\n/**\n * Centers a Toolbar according to given rectangle\n *\n * @method centerToolbar\n * @param {Object} toolbar The toolbar to be centered\n * @param {Object} rect The rectangle according to which the Toolbar will be centered\n */\nvar centerToolbar = function(toolbar, rect) {\n    var toolbarNode = ReactDOM.findDOMNode(toolbar);\n\n    var halfNodeWidth = toolbarNode.offsetWidth / 2;\n    var scrollPosition = new CKEDITOR.dom.window(window).getScrollPosition();\n\n    var gutter = toolbar.props.gutter || DEFAULT_GUTTER;\n\n    var widgetXY = toolbar.getWidgetXYPoint(rect.left + rect.width / 2 - scrollPosition.x, rect.top + scrollPosition.y, CKEDITOR.SELECTION_BOTTOM_TO_TOP);\n\n    toolbar.moveToPoint([\n        widgetXY[0],\n        widgetXY[1]\n    ], [\n        rect.left + rect.width / 2 - halfNodeWidth - scrollPosition.x,\n        rect.top - toolbarNode.offsetHeight + scrollPosition.y - gutter.top\n    ]);\n};\n\n/**\n * Sets the position of a toolbar according to the position of the selected image\n *\n * @method imageSelectionSetPosition\n * @param {Object} payload Payload, should contain the selection data for retrieving the\n * client rectangle of the selected image\n * @return {Boolean} True, in all cases\n */\nvar imageSelectionSetPosition = function(payload) {\n    centerToolbar(this, payload.selectionData.element.getClientRect());\n\n    return true;\n};\n\n/**\n * Sets the position of a toolbar according to the position of the selected image\n *\n * @method tableSelectionSetPosition\n * @param {Object} payload Object, which contains the selection data for retrieving the\n * client rectangle of the selected table\n * @return {Boolean} True, in all cases\n */\nvar tableSelectionSetPosition = function(payload) {\n    var nativeEditor = payload.editor.get('nativeEditor');\n\n    var table = new CKEDITOR.Table(nativeEditor).getFromSelection();\n\n    centerToolbar(this, table.getClientRect());\n\n    return true;\n};\n\nconst SelectionSetPosition = {\n    image: imageSelectionSetPosition,\n    table: tableSelectionSetPosition\n};\n\nexport default SelectionSetPosition;","var tableSelectionGetArrowBoxClasses = function() {\n    return 'ae-arrow-box ae-arrow-box-bottom';\n};\n\nconst SelectionGetArrowBoxClasses = {\n    table: tableSelectionGetArrowBoxClasses\n};\n\nexport default SelectionGetArrowBoxClasses;","import SelectionGetArrowBoxClasses from './selection-arrowbox.js';\nimport SelectionSetPosition from './selection-position.js';\nimport SelectionTest from './selection-test.js';\n\nconst Selections = [{\n    name: 'embed',\n    buttons: ['embedRemove', 'embedEdit'],\n    test: SelectionTest.embed\n}, {\n    name: 'link',\n    buttons: ['linkEdit'],\n    test: SelectionTest.link\n}, {\n    name: 'image',\n    buttons: ['imageLeft', 'imageCenter', 'imageRight'],\n    setPosition: SelectionSetPosition.image,\n    test: SelectionTest.image\n}, {\n    name: 'text',\n    buttons: ['styles', 'bold', 'italic', 'underline', 'link', 'twitter'],\n    test: SelectionTest.text\n}, {\n    name: 'table',\n    buttons: ['tableHeading', 'tableRow', 'tableColumn', 'tableCell', 'tableRemove'],\n    getArrowBoxClasses: SelectionGetArrowBoxClasses.table,\n    setPosition: SelectionSetPosition.table,\n    test: SelectionTest.table\n}];\n\nexport default Selections;","import Lang from './lang.js';\n\n/**\n * Attribute implementation.\n *\n * @class Attribute\n * @constructor\n*/\nfunction Attribute(config) {\n    this.__config__ = config || {};\n    this.__ATTRS__ = {};\n}\n\nAttribute.prototype = {\n    constructor: Attribute,\n\n    /**\n     * Retrieves the value of an attribute.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method get\n     * @param {String} attr The attribute which value should be retrieved.\n     * @return {Any} The value of the attribute.\n     */\n    get: function(attr) {\n        var currentAttr = this.constructor.ATTRS[attr];\n\n        if (!currentAttr) {\n            return;\n        }\n\n        if (!this._isInitialized(attr)) {\n            this._init(attr);\n        }\n\n        var curValue = this.__ATTRS__[attr];\n\n        if (currentAttr.getter) {\n            curValue = this._callStringOrFunction(currentAttr.getter, curValue);\n        }\n\n        return curValue;\n    },\n\n    /**\n     * Sets the value of an attribute.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method set\n     * @param {String} attr The attribute which value should be set.\n     * @param {Any} value The value which should be set to the attribute.\n     */\n    set: function(attr, value) {\n        var currentAttr = this.constructor.ATTRS[attr];\n\n        if (!currentAttr) {\n            return;\n        }\n\n        if (!this._isInitialized(attr)) {\n            this._init(attr);\n        }\n\n        if (currentAttr.readOnly) {\n            return;\n        }\n\n        if (currentAttr.writeOnce && this._isInitialized(attr)) {\n            return;\n        }\n\n        if (currentAttr.validator && !this._callStringOrFunction(currentAttr.validator, value)) {\n            return;\n        }\n\n        if (currentAttr.setter) {\n            value = this._callStringOrFunction(currentAttr.setter, value);\n        }\n\n        this.__ATTRS__[attr] = value;\n    },\n\n    /**\n     * Calls the provided param as function with the supplied arguments.\n     * If param provided as string, a corresponding function in this object will\n     * be called. If provided param is a function, it will be directly called.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method _callStringOrFunction\n     * @param  {Any|Array} args The arguments which will be provided to the called function\n     * @param  {String|Function} stringOrFunction The function which should be called\n     * @protected\n     * @return {Any} The returned value from the called function\n     */\n    _callStringOrFunction: function(stringOrFunction, args) {\n        var result = null;\n\n        if (!Lang.isArray(args)) {\n            args = [args];\n        }\n\n        if (Lang.isString(stringOrFunction) && Lang.isFunction(this[stringOrFunction])) {\n            result = this[stringOrFunction].apply(this, args);\n        } else if (Lang.isFunction(stringOrFunction)) {\n            result = stringOrFunction.apply(this, args);\n        }\n\n        return result;\n    },\n\n    /**\n     * Initializes an attribute. Sets its default value depending on the flags of the\n     * attribute and the passed configuration object to the constructor.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method _init\n     * @param {String} attr The name of the attribute which have to be initialized.\n     * @protected\n     */\n    _init: function(attr) {\n        var value;\n\n        var currentAttr = this.constructor.ATTRS[attr];\n\n        // Check if there is default value or passed one via configuration object\n        var hasDefaultValue = Object.prototype.hasOwnProperty.call(currentAttr, 'value');\n        var hasPassedValueViaConfig = Object.prototype.hasOwnProperty.call(this.__config__, attr);\n\n        // If there is valueFn, set the value to be the result of invocation of this function\n        if (currentAttr.valueFn) {\n            value = this._callStringOrFunction(currentAttr.valueFn, value);\n\n            this.__ATTRS__[attr] = value;\n        }\n        // else if the attribute has readOnly flag, set the default value from the attribute,\n        // regardless if there is value or not\n        else if (currentAttr.readOnly) {\n            value = currentAttr.value;\n        }\n        // else if the attribute has writeOnce value, set it from the passed configuration or from the\n        // default value, in this order. Otherwise, return miserable.\n        else if (currentAttr.writeOnce) {\n            if (hasPassedValueViaConfig) {\n                value = this.__config__[attr];\n            } else if (hasDefaultValue) {\n                value = currentAttr.value;\n            } else {\n                return;\n            }\n        }\n        // These two cases below are easy - set the value to be from the passed config or\n        // from the default value, in this order.\n        else if (hasPassedValueViaConfig) {\n            value = this.__config__[attr];\n        } else if (hasDefaultValue) {\n            value = currentAttr.value;\n        }\n\n        // If there is validator, and user passed config object - check the returned value.\n        // If it is false, then set as initial value the default one.\n        // However, if there is no default value, just return.\n        if (currentAttr.validator && hasPassedValueViaConfig && !this._callStringOrFunction(currentAttr.validator, value)) {\n            if (hasDefaultValue) {\n                value = currentAttr.value;\n            } else {\n                return;\n            }\n        }\n\n        // If there is setter and user passed config object - pass the value thought the setter.\n        // The value might be one from defaultFn, default value or provided from the config.\n        if (currentAttr.setter && hasPassedValueViaConfig) {\n            value = this._callStringOrFunction(currentAttr.setter, value);\n        }\n\n        // Finally, set the value as initial value to the storage with values.\n        this.__ATTRS__[attr] = value;\n    },\n\n    /**\n     * Checks if an attribute is initialized. An attribute is considered as initialized\n     * when there is an own property with this name in the local collection of attribute values\n     * for the current instance.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method _isInitialized\n     * @param {String} attr The attribute which should be checked if it is initialized.\n     * @protected\n     * @return {Boolean} Returns true if the attribute has been initialized, false otherwise.\n     */\n    _isInitialized: function(attr) {\n        return Object.prototype.hasOwnProperty.call(this.__ATTRS__, attr);\n    }\n};\n\nexport default Attribute;","import Attribute from './attribute.js';\nimport Lang from './lang.js';\nimport extend from './oop.js';\n\n/**\n * Quick and dirty impl of Base class.\n *\n * @class Base\n * @constructor\n */\nfunction Base(config) {\n    Base.superclass.constructor.call(this, config);\n\n    this.init(config);\n}\n\nextend(Base, Attribute, {\n    /**\n     * Calls the `initializer` method of each class which extends Base starting from the parent to the child.\n     * Will pass the configuration object to each initializer method.\n     *\n     * @instance\n     * @memberof Base\n     * @method init\n     * @param {Object} config Configuration object\n     */\n    init: function(config) {\n        this._callChain('initializer', config);\n    },\n\n    /**\n     * Calls the `destructor` method of each class which extends Base starting from the parent to the child.\n     *\n     * @instance\n     * @memberof Base\n     * @method destroy\n     */\n    destroy: function() {\n        this._callChain('destructor');\n    },\n\n    /**\n     * Calls a method of each class, which is being present in the hierarchy starting from parent to the child.\n     *\n     * @instance\n     * @memberof Base\n     * @method _callChain\n     * @param {Object|Array} args The arguments with which the method should be invoked\n     * @param {String} wat  The method, which should be invoked\n     * @protected\n     */\n    _callChain: function(wat, args) {\n        var arr = [];\n\n        var ctor = this.constructor;\n\n        while (ctor) {\n            if (Lang.isFunction(ctor.prototype[wat])) {\n                arr.push(ctor.prototype[wat]);\n            }\n\n            ctor = ctor.superclass ? ctor.superclass.constructor : null;\n        }\n\n        arr = arr.reverse();\n\n        args = Lang.isArray(args) ? args : [args];\n\n        for (var i = 0; i < arr.length; i++) {\n            var item = arr[i];\n\n            item.apply(this, args);\n        }\n    }\n});\n\nexport default Base;","(function() {\n    'use strict';\n\n    /* istanbul ignore if */\n    if (CKEDITOR.plugins.get('ae_uibridge')) {\n        return;\n    }\n\n    /**\n     * CKEditor plugin that extends CKEDITOR.ui.add function so an add handler can be specified\n     * on top of the original ones. It bridges the calls to add components via:\n     * - editor.ui.add(name, type, definition)\n     *\n     * @class CKEDITOR.plugins.ae_uibridge\n     * @constructor\n     */\n    CKEDITOR.plugins.add('ae_uibridge', {\n        /**\n         * Initialization of the plugin, part of CKEditor plugin lifecycle.\n         *\n         * @method beforeInit\n         * @param {Object} editor The current editor instance\n         */\n        beforeInit: function(editor) {\n            var originalUIAddFn = editor.ui.add;\n\n            editor.ui.add = function(name, type, definition) {\n                originalUIAddFn.apply(this, arguments);\n\n                var typeHandler = this._.handlers[type];\n\n                if (typeHandler && typeHandler.add) {\n                    typeHandler.add(name, definition, editor);\n                    AlloyEditor.registerBridgeButton(name, editor.__processingPlugin__.plugin.name);\n                }\n            };\n        }\n    });\n}());","/**\n * @license Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\t'use strict';\n\n    if (CKEDITOR.plugins.get('ae_tabletools')){\n\t\treturn;\n    }\n\n\tvar cellNodeRegex = /^(?:td|th)$/;\n\n\tfunction getSelectedCells( selection ) {\n\t\tvar ranges = selection.getRanges();\n\t\tvar retval = [];\n\t\tvar database = {};\n\n\t\tfunction moveOutOfCellGuard( node ) {\n\t\t\t// Apply to the first cell only.\n\t\t\tif ( retval.length > 0 )\n\t\t\t\treturn;\n\n\t\t\t// If we are exiting from the first </td>, then the td should definitely be\n\t\t\t// included.\n\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT && cellNodeRegex.test( node.getName() ) && !node.getCustomData( 'selected_cell' ) ) {\n\t\t\t\tCKEDITOR.dom.element.setMarker( database, node, 'selected_cell', true );\n\t\t\t\tretval.push( node );\n\t\t\t}\n\t\t}\n\n\t\tfor ( var i = 0; i < ranges.length; i++ ) {\n\t\t\tvar range = ranges[ i ];\n\n\t\t\tif ( range.collapsed ) {\n\t\t\t\t// Walker does not handle collapsed ranges yet - fall back to old API.\n\t\t\t\tvar startNode = range.getCommonAncestor();\n\t\t\t\tvar nearestCell = startNode.getAscendant( 'td', true ) || startNode.getAscendant( 'th', true );\n\t\t\t\tif ( nearestCell )\n\t\t\t\t\tretval.push( nearestCell );\n\t\t\t} else {\n\t\t\t\tvar walker = new CKEDITOR.dom.walker( range );\n\t\t\t\tvar node;\n\t\t\t\twalker.guard = moveOutOfCellGuard;\n\n\t\t\t\twhile ( ( node = walker.next() ) ) {\n\t\t\t\t\t// If may be possible for us to have a range like this:\n\t\t\t\t\t// <td>^1</td><td>^2</td>\n\t\t\t\t\t// The 2nd td shouldn't be included.\n\t\t\t\t\t//\n\t\t\t\t\t// So we have to take care to include a td we've entered only when we've\n\t\t\t\t\t// walked into its children.\n\n\t\t\t\t\tif ( node.type != CKEDITOR.NODE_ELEMENT || !node.is( CKEDITOR.dtd.table ) ) {\n\t\t\t\t\t\tvar parent = node.getAscendant( 'td', true ) || node.getAscendant( 'th', true );\n\t\t\t\t\t\tif ( parent && !parent.getCustomData( 'selected_cell' ) ) {\n\t\t\t\t\t\t\tCKEDITOR.dom.element.setMarker( database, parent, 'selected_cell', true );\n\t\t\t\t\t\t\tretval.push( parent );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tCKEDITOR.dom.element.clearAllMarkers( database );\n\n\t\treturn retval;\n\t}\n\n\tfunction getFocusElementAfterDelCells( cellsToDelete ) {\n\t\tvar i = 0,\n\t\t\tlast = cellsToDelete.length - 1,\n\t\t\tdatabase = {},\n\t\t\tcell, focusedCell, tr;\n\n\t\twhile ( ( cell = cellsToDelete[ i++ ] ) )\n\t\t\tCKEDITOR.dom.element.setMarker( database, cell, 'delete_cell', true );\n\n\t\t// 1.first we check left or right side focusable cell row by row;\n\t\ti = 0;\n\t\twhile ( ( cell = cellsToDelete[ i++ ] ) ) {\n\t\t\tif ( ( focusedCell = cell.getPrevious() ) && !focusedCell.getCustomData( 'delete_cell' ) || ( focusedCell = cell.getNext() ) && !focusedCell.getCustomData( 'delete_cell' ) ) {\n\t\t\t\tCKEDITOR.dom.element.clearAllMarkers( database );\n\t\t\t\treturn focusedCell;\n\t\t\t}\n\t\t}\n\n\t\tCKEDITOR.dom.element.clearAllMarkers( database );\n\n\t\t// 2. then we check the toppest row (outside the selection area square) focusable cell\n\t\ttr = cellsToDelete[ 0 ].getParent();\n\t\tif ( ( tr = tr.getPrevious() ) )\n\t\t\treturn tr.getLast();\n\n\t\t// 3. last we check the lowerest  row focusable cell\n\t\ttr = cellsToDelete[ last ].getParent();\n\t\tif ( ( tr = tr.getNext() ) )\n\t\t\treturn tr.getChild( 0 );\n\n\t\treturn null;\n\t}\n\n\tfunction insertRow( selection, insertBefore ) {\n\t\tvar cells = getSelectedCells( selection ),\n\t\t\tfirstCell = cells[ 0 ],\n\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\tdoc = firstCell.getDocument(),\n\t\t\tstartRow = cells[ 0 ].getParent(),\n\t\t\tstartRowIndex = startRow.$.rowIndex,\n\t\t\tlastCell = cells[ cells.length - 1 ],\n\t\t\tendRowIndex = lastCell.getParent().$.rowIndex + lastCell.$.rowSpan - 1,\n\t\t\tendRow = new CKEDITOR.dom.element( table.$.rows[ endRowIndex ] ),\n\t\t\trowIndex = insertBefore ? startRowIndex : endRowIndex,\n\t\t\trow = insertBefore ? startRow : endRow;\n\n\t\tvar map = CKEDITOR.tools.buildTableMap( table ),\n\t\t\tcloneRow = map[ rowIndex ],\n\t\t\tnextRow = insertBefore ? map[ rowIndex - 1 ] : map[ rowIndex + 1 ],\n\t\t\twidth = map[ 0 ].length;\n\n\t\tvar newRow = doc.createElement( 'tr' );\n\t\tfor ( var i = 0; cloneRow[ i ] && i < width; i++ ) {\n\t\t\tvar cell;\n\t\t\t// Check whether there's a spanning row here, do not break it.\n\t\t\tif ( cloneRow[ i ].rowSpan > 1 && nextRow && cloneRow[ i ] == nextRow[ i ] ) {\n\t\t\t\tcell = cloneRow[ i ];\n\t\t\t\tcell.rowSpan += 1;\n\t\t\t} else {\n\t\t\t\tcell = new CKEDITOR.dom.element( cloneRow[ i ] ).clone();\n\t\t\t\tcell.removeAttribute( 'rowSpan' );\n\t\t\t\tcell.appendBogus();\n\t\t\t\tnewRow.append( cell );\n\t\t\t\tcell = cell.$;\n\t\t\t}\n\n\t\t\ti += cell.colSpan - 1;\n\t\t}\n\n\t\tinsertBefore ? newRow.insertBefore( row ) : newRow.insertAfter( row );\n\t}\n\n\tfunction deleteRows( selectionOrRow ) {\n\t\tif ( selectionOrRow instanceof CKEDITOR.dom.selection ) {\n\t\t\tvar cells = getSelectedCells( selectionOrRow ),\n\t\t\t\tfirstCell = cells[ 0 ],\n\t\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\t\tstartRow = cells[ 0 ].getParent(),\n\t\t\t\tstartRowIndex = startRow.$.rowIndex,\n\t\t\t\tlastCell = cells[ cells.length - 1 ],\n\t\t\t\tendRowIndex = lastCell.getParent().$.rowIndex + lastCell.$.rowSpan - 1,\n\t\t\t\trowsToDelete = [];\n\n\t\t\t// Delete cell or reduce cell spans by checking through the table map.\n\t\t\tfor ( var i = startRowIndex; i <= endRowIndex; i++ ) {\n\t\t\t\tvar mapRow = map[ i ],\n\t\t\t\t\trow = new CKEDITOR.dom.element( table.$.rows[ i ] );\n\n\t\t\t\tfor ( var j = 0; j < mapRow.length; j++ ) {\n\t\t\t\t\tvar cell = new CKEDITOR.dom.element( mapRow[ j ] ),\n\t\t\t\t\t\tcellRowIndex = cell.getParent().$.rowIndex;\n\n\t\t\t\t\tif ( cell.$.rowSpan == 1 )\n\t\t\t\t\t\tcell.remove();\n\t\t\t\t\t// Row spanned cell.\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Span row of the cell, reduce spanning.\n\t\t\t\t\t\tcell.$.rowSpan -= 1;\n\t\t\t\t\t\t// Root row of the cell, root cell to next row.\n\t\t\t\t\t\tif ( cellRowIndex == i ) {\n\t\t\t\t\t\t\tvar nextMapRow = map[ i + 1 ];\n\t\t\t\t\t\t\tnextMapRow[ j - 1 ] ? cell.insertAfter( new CKEDITOR.dom.element( nextMapRow[ j - 1 ] ) ) : new CKEDITOR.dom.element( table.$.rows[ i + 1 ] ).append( cell, 1 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tj += cell.$.colSpan - 1;\n\t\t\t\t}\n\n\t\t\t\trowsToDelete.push( row );\n\t\t\t}\n\n\t\t\tvar rows = table.$.rows;\n\n\t\t\t// Where to put the cursor after rows been deleted?\n\t\t\t// 1. Into next sibling row if any;\n\t\t\t// 2. Into previous sibling row if any;\n\t\t\t// 3. Into table's parent element if it's the very last row.\n\t\t\tvar cursorPosition = new CKEDITOR.dom.element( rows[ endRowIndex + 1 ] || ( startRowIndex > 0 ? rows[ startRowIndex - 1 ] : null ) || table.$.parentNode );\n\n\t\t\tfor ( i = rowsToDelete.length; i >= 0; i-- )\n\t\t\t\tdeleteRows( rowsToDelete[ i ] );\n\n\t\t\treturn cursorPosition;\n\t\t} else if ( selectionOrRow instanceof CKEDITOR.dom.element ) {\n\t\t\ttable = selectionOrRow.getAscendant( 'table' );\n\n\t\t\tif ( table.$.rows.length == 1 )\n\t\t\t\ttable.remove();\n\t\t\telse\n\t\t\t\tselectionOrRow.remove();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfunction getCellColIndex( cell, isStart ) {\n\t\tvar row = cell.getParent(),\n\t\t\trowCells = row.$.cells;\n\n\t\tvar colIndex = 0;\n\t\tfor ( var i = 0; i < rowCells.length; i++ ) {\n\t\t\tvar mapCell = rowCells[ i ];\n\t\t\tcolIndex += isStart ? 1 : mapCell.colSpan;\n\t\t\tif ( mapCell == cell.$ )\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn colIndex - 1;\n\t}\n\n\tfunction getColumnsIndices( cells, isStart ) {\n\t\tvar retval = isStart ? Infinity : 0;\n\t\tfor ( var i = 0; i < cells.length; i++ ) {\n\t\t\tvar colIndex = getCellColIndex( cells[ i ], isStart );\n\t\t\tif ( isStart ? colIndex < retval : colIndex > retval )\n\t\t\t\tretval = colIndex;\n\t\t}\n\t\treturn retval;\n\t}\n\n\tfunction insertColumn( selection, insertBefore ) {\n\t\tvar cells = getSelectedCells( selection ),\n\t\t\tfirstCell = cells[ 0 ],\n\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\tstartCol = getColumnsIndices( cells, 1 ),\n\t\t\tlastCol = getColumnsIndices( cells ),\n\t\t\tcolIndex = insertBefore ? startCol : lastCol;\n\n\t\tvar map = CKEDITOR.tools.buildTableMap( table ),\n\t\t\tcloneCol = [],\n\t\t\tnextCol = [],\n\t\t\theight = map.length;\n\n\t\tfor ( var i = 0; i < height; i++ ) {\n\t\t\tcloneCol.push( map[ i ][ colIndex ] );\n\t\t\tvar nextCell = insertBefore ? map[ i ][ colIndex - 1 ] : map[ i ][ colIndex + 1 ];\n\t\t\tnextCol.push( nextCell );\n\t\t}\n\n\t\tfor ( i = 0; i < height; i++ ) {\n\t\t\tvar cell;\n\n\t\t\tif ( !cloneCol[ i ] )\n\t\t\t\tcontinue;\n\n\t\t\t// Check whether there's a spanning column here, do not break it.\n\t\t\tif ( cloneCol[ i ].colSpan > 1 && nextCol[ i ] == cloneCol[ i ] ) {\n\t\t\t\tcell = cloneCol[ i ];\n\t\t\t\tcell.colSpan += 1;\n\t\t\t} else {\n\t\t\t\tcell = new CKEDITOR.dom.element( cloneCol[ i ] ).clone();\n\t\t\t\tcell.removeAttribute( 'colSpan' );\n\t\t\t\tcell.appendBogus();\n\t\t\t\tcell[ insertBefore ? 'insertBefore' : 'insertAfter' ].call( cell, new CKEDITOR.dom.element( cloneCol[ i ] ) );\n\t\t\t\tcell = cell.$;\n\t\t\t}\n\n\t\t\ti += cell.rowSpan - 1;\n\t\t}\n\t}\n\n\tfunction deleteColumns( selectionOrCell ) {\n\t\tvar cells = getSelectedCells( selectionOrCell ),\n\t\t\tfirstCell = cells[ 0 ],\n\t\t\tlastCell = cells[ cells.length - 1 ],\n\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\tstartColIndex, endColIndex,\n\t\t\trowsToDelete = [];\n\n\t\t// Figure out selected cells' column indices.\n\t\tfor ( var i = 0, rows = map.length; i < rows; i++ ) {\n\t\t\tfor ( var j = 0, cols = map[ i ].length; j < cols; j++ ) {\n\t\t\t\tif ( map[ i ][ j ] == firstCell.$ )\n\t\t\t\t\tstartColIndex = j;\n\t\t\t\tif ( map[ i ][ j ] == lastCell.$ )\n\t\t\t\t\tendColIndex = j;\n\t\t\t}\n\t\t}\n\n\t\t// Delete cell or reduce cell spans by checking through the table map.\n\t\tfor ( i = startColIndex; i <= endColIndex; i++ ) {\n\t\t\tfor ( j = 0; j < map.length; j++ ) {\n\t\t\t\tvar mapRow = map[ j ],\n\t\t\t\t\trow = new CKEDITOR.dom.element( table.$.rows[ j ] ),\n\t\t\t\t\tcell = new CKEDITOR.dom.element( mapRow[ i ] );\n\n\t\t\t\tif ( cell.$ ) {\n\t\t\t\t\tif ( cell.$.colSpan == 1 )\n\t\t\t\t\t\tcell.remove();\n\t\t\t\t\t// Reduce the col spans.\n\t\t\t\t\telse\n\t\t\t\t\t\tcell.$.colSpan -= 1;\n\n\t\t\t\t\tj += cell.$.rowSpan - 1;\n\n\t\t\t\t\tif ( !row.$.cells.length )\n\t\t\t\t\t\trowsToDelete.push( row );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar firstRowCells = table.$.rows[ 0 ] && table.$.rows[ 0 ].cells;\n\n\t\t// Where to put the cursor after columns been deleted?\n\t\t// 1. Into next cell of the first row if any;\n\t\t// 2. Into previous cell of the first row if any;\n\t\t// 3. Into table's parent element;\n\t\tvar cursorPosition = new CKEDITOR.dom.element( firstRowCells[ startColIndex ] || ( startColIndex ? firstRowCells[ startColIndex - 1 ] : table.$.parentNode ) );\n\n\t\t// Delete table rows only if all columns are gone (do not remove empty row).\n\t\tif ( rowsToDelete.length == rows )\n\t\t\ttable.remove();\n\n\t\treturn cursorPosition;\n\t}\n\n\tfunction insertCell( selection, insertBefore ) {\n\t\tvar startElement = selection.getStartElement();\n\t\tvar cell = startElement.getAscendant( 'td', 1 ) || startElement.getAscendant( 'th', 1 );\n\n\t\tif ( !cell )\n\t\t\treturn;\n\n\t\t// Create the new cell element to be added.\n\t\tvar newCell = cell.clone();\n\t\tnewCell.appendBogus();\n\n\t\tif ( insertBefore )\n\t\t\tnewCell.insertBefore( cell );\n\t\telse\n\t\t\tnewCell.insertAfter( cell );\n\t}\n\n\tfunction deleteCells( selectionOrCell ) {\n\t\tif ( selectionOrCell instanceof CKEDITOR.dom.selection ) {\n\t\t\tvar cellsToDelete = getSelectedCells( selectionOrCell );\n\t\t\tvar table = cellsToDelete[ 0 ] && cellsToDelete[ 0 ].getAscendant( 'table' );\n\t\t\tvar cellToFocus = getFocusElementAfterDelCells( cellsToDelete );\n\n\t\t\tfor ( var i = cellsToDelete.length - 1; i >= 0; i-- )\n\t\t\t\tdeleteCells( cellsToDelete[ i ] );\n\n\t\t\tif ( cellToFocus )\n\t\t\t\tplaceCursorInCell( cellToFocus, true );\n\t\t\telse if ( table )\n\t\t\t\ttable.remove();\n\t\t} else if ( selectionOrCell instanceof CKEDITOR.dom.element ) {\n\t\t\tvar tr = selectionOrCell.getParent();\n\t\t\tif ( tr.getChildCount() == 1 )\n\t\t\t\ttr.remove();\n\t\t\telse\n\t\t\t\tselectionOrCell.remove();\n\t\t}\n\t}\n\n\t// Remove filler at end and empty spaces around the cell content.\n\tfunction trimCell( cell ) {\n\t\tvar bogus = cell.getBogus();\n\t\tbogus && bogus.remove();\n\t\tcell.trim();\n\t}\n\n\tfunction placeCursorInCell( cell, placeAtEnd ) {\n\t\tvar docInner = cell.getDocument(),\n\t\t\tdocOuter = CKEDITOR.document;\n\n\t\t// Fixing \"Unspecified error\" thrown in IE10 by resetting\n\t\t// selection the dirty and shameful way (#10308).\n\t\t// We can not apply this hack to IE8 because\n\t\t// it causes error (#11058).\n\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version == 10 ) {\n\t\t\tdocOuter.focus();\n\t\t\tdocInner.focus();\n\t\t}\n\n\t\tvar range = new CKEDITOR.dom.range( docInner );\n\t\tif ( !range[ 'moveToElementEdit' + ( placeAtEnd ? 'End' : 'Start' ) ]( cell ) ) {\n\t\t\trange.selectNodeContents( cell );\n\t\t\trange.collapse( placeAtEnd ? false : true );\n\t\t}\n\t\trange.select( true );\n\t}\n\n\tfunction cellInRow( tableMap, rowIndex, cell ) {\n\t\tvar oRow = tableMap[ rowIndex ];\n\t\tif ( typeof cell == 'undefined' )\n\t\t\treturn oRow;\n\n\t\tfor ( var c = 0; oRow && c < oRow.length; c++ ) {\n\t\t\tif ( cell.is && oRow[ c ] == cell.$ )\n\t\t\t\treturn c;\n\t\t\telse if ( c == cell )\n\t\t\t\treturn new CKEDITOR.dom.element( oRow[ c ] );\n\t\t}\n\t\treturn cell.is ? -1 : null;\n\t}\n\n\tfunction cellInCol( tableMap, colIndex ) {\n\t\tvar oCol = [];\n\t\tfor ( var r = 0; r < tableMap.length; r++ ) {\n\t\t\tvar row = tableMap[ r ];\n\t\t\toCol.push( row[ colIndex ] );\n\n\t\t\t// Avoid adding duplicate cells.\n\t\t\tif ( row[ colIndex ].rowSpan > 1 )\n\t\t\t\tr += row[ colIndex ].rowSpan - 1;\n\t\t}\n\t\treturn oCol;\n\t}\n\n\tfunction mergeCells( selection, mergeDirection, isDetect ) {\n\t\tvar cells = getSelectedCells( selection );\n\n\t\t// Invalid merge request if:\n\t\t// 1. In batch mode despite that less than two selected.\n\t\t// 2. In solo mode while not exactly only one selected.\n\t\t// 3. Cells distributed in different table groups (e.g. from both thead and tbody).\n\t\tvar commonAncestor;\n\t\tif ( ( mergeDirection ? cells.length != 1 : cells.length < 2 ) || ( commonAncestor = selection.getCommonAncestor() ) && commonAncestor.type == CKEDITOR.NODE_ELEMENT && commonAncestor.is( 'table' ) )\n\t\t\treturn false;\n\n\t\tvar cell,\n\t\t\tfirstCell = cells[ 0 ],\n\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\tmapHeight = map.length,\n\t\t\tmapWidth = map[ 0 ].length,\n\t\t\tstartRow = firstCell.getParent().$.rowIndex,\n\t\t\tstartColumn = cellInRow( map, startRow, firstCell );\n\n\t\tif ( mergeDirection ) {\n\t\t\tvar targetCell;\n\t\t\ttry {\n\t\t\t\tvar rowspan = parseInt( firstCell.getAttribute( 'rowspan' ), 10 ) || 1;\n\t\t\t\tvar colspan = parseInt( firstCell.getAttribute( 'colspan' ), 10 ) || 1;\n\n\t\t\t\ttargetCell = map[ mergeDirection == 'up' ? ( startRow - rowspan ) : mergeDirection == 'down' ? ( startRow + rowspan ) : startRow ][\n\t\t\t\t\tmergeDirection == 'left' ?\n\t\t\t\t\t\t( startColumn - colspan ) :\n\t\t\t\t\tmergeDirection == 'right' ? ( startColumn + colspan ) : startColumn ];\n\n\t\t\t} catch ( er ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// 1. No cell could be merged.\n\t\t\t// 2. Same cell actually.\n\t\t\tif ( !targetCell || firstCell.$ == targetCell )\n\t\t\t\treturn false;\n\n\t\t\t// Sort in map order regardless of the DOM sequence.\n\t\t\tcells[ ( mergeDirection == 'up' || mergeDirection == 'left' ) ? 'unshift' : 'push' ]( new CKEDITOR.dom.element( targetCell ) );\n\t\t}\n\n\t\t// Start from here are merging way ignorance (merge up/right, batch merge).\n\t\tvar doc = firstCell.getDocument(),\n\t\t\tlastRowIndex = startRow,\n\t\t\ttotalRowSpan = 0,\n\t\t\ttotalColSpan = 0,\n\t\t\t// Use a documentFragment as buffer when appending cell contents.\n\t\t\tfrag = !isDetect && new CKEDITOR.dom.documentFragment( doc ),\n\t\t\tdimension = 0;\n\n\t\tfor ( var i = 0; i < cells.length; i++ ) {\n\t\t\tcell = cells[ i ];\n\n\t\t\tvar tr = cell.getParent(),\n\t\t\t\tcellFirstChild = cell.getFirst(),\n\t\t\t\tcolSpan = cell.$.colSpan,\n\t\t\t\trowSpan = cell.$.rowSpan,\n\t\t\t\trowIndex = tr.$.rowIndex,\n\t\t\t\tcolIndex = cellInRow( map, rowIndex, cell );\n\n\t\t\t// Accumulated the actual places taken by all selected cells.\n\t\t\tdimension += colSpan * rowSpan;\n\t\t\t// Accumulated the maximum virtual spans from column and row.\n\t\t\ttotalColSpan = Math.max( totalColSpan, colIndex - startColumn + colSpan );\n\t\t\ttotalRowSpan = Math.max( totalRowSpan, rowIndex - startRow + rowSpan );\n\n\t\t\tif ( !isDetect ) {\n\t\t\t\t// Trim all cell fillers and check to remove empty cells.\n\t\t\t\tif ( trimCell( cell ), cell.getChildren().count() ) {\n\t\t\t\t\t// Merge vertically cells as two separated paragraphs.\n\t\t\t\t\tif ( rowIndex != lastRowIndex && cellFirstChild && !( cellFirstChild.isBlockBoundary && cellFirstChild.isBlockBoundary( { br: 1 } ) ) ) {\n\t\t\t\t\t\tvar last = frag.getLast( CKEDITOR.dom.walker.whitespaces( true ) );\n\t\t\t\t\t\tif ( last && !( last.is && last.is( 'br' ) ) )\n\t\t\t\t\t\t\tfrag.append( 'br' );\n\t\t\t\t\t}\n\n\t\t\t\t\tcell.moveChildren( frag );\n\t\t\t\t}\n\t\t\t\ti ? cell.remove() : cell.setHtml( '' );\n\t\t\t}\n\t\t\tlastRowIndex = rowIndex;\n\t\t}\n\n\t\tif ( !isDetect ) {\n\t\t\tfrag.moveChildren( firstCell );\n\n\t\t\tfirstCell.appendBogus();\n\n\t\t\tif ( totalColSpan >= mapWidth )\n\t\t\t\tfirstCell.removeAttribute( 'rowSpan' );\n\t\t\telse\n\t\t\t\tfirstCell.$.rowSpan = totalRowSpan;\n\n\t\t\tif ( totalRowSpan >= mapHeight )\n\t\t\t\tfirstCell.removeAttribute( 'colSpan' );\n\t\t\telse\n\t\t\t\tfirstCell.$.colSpan = totalColSpan;\n\n\t\t\t// Swip empty <tr> left at the end of table due to the merging.\n\t\t\tvar trs = new CKEDITOR.dom.nodeList( table.$.rows ),\n\t\t\t\tcount = trs.count();\n\n\t\t\tfor ( i = count - 1; i >= 0; i-- ) {\n\t\t\t\tvar tailTr = trs.getItem( i );\n\t\t\t\tif ( !tailTr.$.cells.length ) {\n\t\t\t\t\ttailTr.remove();\n\t\t\t\t\tcount++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn firstCell;\n\t\t}\n\t\t// Be able to merge cells only if actual dimension of selected\n\t\t// cells equals to the caculated rectangle.\n\t\telse {\n\t\t\treturn ( totalRowSpan * totalColSpan ) == dimension;\n\t\t}\n\t}\n\n\tfunction verticalSplitCell( selection, isDetect ) {\n\t\tvar cells = getSelectedCells( selection );\n\t\tif ( cells.length > 1 )\n\t\t\treturn false;\n\t\telse if ( isDetect )\n\t\t\treturn true;\n\n\t\tvar cell = cells[ 0 ],\n\t\t\ttr = cell.getParent(),\n\t\t\ttable = tr.getAscendant( 'table' ),\n\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\trowIndex = tr.$.rowIndex,\n\t\t\tcolIndex = cellInRow( map, rowIndex, cell ),\n\t\t\trowSpan = cell.$.rowSpan,\n\t\t\tnewCell, newRowSpan, newCellRowSpan, newRowIndex;\n\n\t\tif ( rowSpan > 1 ) {\n\t\t\tnewRowSpan = Math.ceil( rowSpan / 2 );\n\t\t\tnewCellRowSpan = Math.floor( rowSpan / 2 );\n\t\t\tnewRowIndex = rowIndex + newRowSpan;\n\t\t\tvar newCellTr = new CKEDITOR.dom.element( table.$.rows[ newRowIndex ] ),\n\t\t\t\tnewCellRow = cellInRow( map, newRowIndex ),\n\t\t\t\tcandidateCell;\n\n\t\t\tnewCell = cell.clone();\n\n\t\t\t// Figure out where to insert the new cell by checking the vitual row.\n\t\t\tfor ( var c = 0; c < newCellRow.length; c++ ) {\n\t\t\t\tcandidateCell = newCellRow[ c ];\n\t\t\t\t// Catch first cell actually following the column.\n\t\t\t\tif ( candidateCell.parentNode == newCellTr.$ && c > colIndex ) {\n\t\t\t\t\tnewCell.insertBefore( new CKEDITOR.dom.element( candidateCell ) );\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tcandidateCell = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// The destination row is empty, append at will.\n\t\t\tif ( !candidateCell )\n\t\t\t\tnewCellTr.append( newCell );\n\t\t} else {\n\t\t\tnewCellRowSpan = newRowSpan = 1;\n\n\t\t\tnewCellTr = tr.clone();\n\t\t\tnewCellTr.insertAfter( tr );\n\t\t\tnewCellTr.append( newCell = cell.clone() );\n\n\t\t\tvar cellsInSameRow = cellInRow( map, rowIndex );\n\t\t\tfor ( var i = 0; i < cellsInSameRow.length; i++ )\n\t\t\t\tcellsInSameRow[ i ].rowSpan++;\n\t\t}\n\n\t\tnewCell.appendBogus();\n\n\t\tcell.$.rowSpan = newRowSpan;\n\t\tnewCell.$.rowSpan = newCellRowSpan;\n\t\tif ( newRowSpan == 1 )\n\t\t\tcell.removeAttribute( 'rowSpan' );\n\t\tif ( newCellRowSpan == 1 )\n\t\t\tnewCell.removeAttribute( 'rowSpan' );\n\n\t\treturn newCell;\n\t}\n\n\tfunction horizontalSplitCell( selection, isDetect ) {\n\t\tvar cells = getSelectedCells( selection );\n\t\tif ( cells.length > 1 )\n\t\t\treturn false;\n\t\telse if ( isDetect )\n\t\t\treturn true;\n\n\t\tvar cell = cells[ 0 ],\n\t\t\ttr = cell.getParent(),\n\t\t\ttable = tr.getAscendant( 'table' ),\n\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\trowIndex = tr.$.rowIndex,\n\t\t\tcolIndex = cellInRow( map, rowIndex, cell ),\n\t\t\tcolSpan = cell.$.colSpan,\n\t\t\tnewCell, newColSpan, newCellColSpan;\n\n\t\tif ( colSpan > 1 ) {\n\t\t\tnewColSpan = Math.ceil( colSpan / 2 );\n\t\t\tnewCellColSpan = Math.floor( colSpan / 2 );\n\t\t} else {\n\t\t\tnewCellColSpan = newColSpan = 1;\n\t\t\tvar cellsInSameCol = cellInCol( map, colIndex );\n\t\t\tfor ( var i = 0; i < cellsInSameCol.length; i++ )\n\t\t\t\tcellsInSameCol[ i ].colSpan++;\n\t\t}\n\t\tnewCell = cell.clone();\n\t\tnewCell.insertAfter( cell );\n\t\tnewCell.appendBogus();\n\n\t\tcell.$.colSpan = newColSpan;\n\t\tnewCell.$.colSpan = newCellColSpan;\n\t\tif ( newColSpan == 1 )\n\t\t\tcell.removeAttribute( 'colSpan' );\n\t\tif ( newCellColSpan == 1 )\n\t\t\tnewCell.removeAttribute( 'colSpan' );\n\n\t\treturn newCell;\n\t}\n\n\tCKEDITOR.plugins.add('ae_tabletools', {\n\t\tinit: function( editor ) {\n\t\t\tvar lang = editor.lang.table;\n\n\t\t\tfunction createDef( def ) {\n\t\t\t\treturn CKEDITOR.tools.extend( def || {}, {\n\t\t\t\t\tcontextSensitive: 1,\n\t\t\t\t\trefresh: function( editor, path ) {\n\t\t\t\t\t\tthis.setState( path.contains( { td: 1, th: 1 }, 1 ) ? CKEDITOR.TRISTATE_OFF : CKEDITOR.TRISTATE_DISABLED );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\tfunction addCmd( name, def ) {\n\t\t\t\tvar cmd = editor.getCommand(name);\n\n\t\t\t\tif (cmd) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcmd = editor.addCommand(name, def);\n\t\t\t\teditor.addFeature(cmd);\n\t\t\t}\n\n\t\t\taddCmd( 'rowDelete', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tplaceCursorInCell( deleteRows( selection ) );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'rowInsertBefore', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertRow( selection, true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'rowInsertAfter', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertRow( selection );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'columnDelete', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tvar element = deleteColumns( selection );\n\t\t\t\t\telement && placeCursorInCell( element, true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'columnInsertBefore', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertColumn( selection, true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'columnInsertAfter', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertColumn( selection );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellDelete', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tdeleteCells( selection );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellMerge', createDef( {\n\t\t\t\tallowedContent: 'td[colspan,rowspan]',\n\t\t\t\trequiredContent: 'td[colspan,rowspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( mergeCells( editor.getSelection() ), true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellMergeRight', createDef( {\n\t\t\t\tallowedContent: 'td[colspan]',\n\t\t\t\trequiredContent: 'td[colspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( mergeCells( editor.getSelection(), 'right' ), true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellMergeDown', createDef( {\n\t\t\t\tallowedContent: 'td[rowspan]',\n\t\t\t\trequiredContent: 'td[rowspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( mergeCells( editor.getSelection(), 'down' ), true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellVerticalSplit', createDef( {\n\t\t\t\tallowedContent: 'td[rowspan]',\n\t\t\t\trequiredContent: 'td[rowspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( verticalSplitCell( editor.getSelection() ) );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellHorizontalSplit', createDef( {\n\t\t\t\tallowedContent: 'td[colspan]',\n\t\t\t\trequiredContent: 'td[colspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( horizontalSplitCell( editor.getSelection() ) );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellInsertBefore', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertCell( selection, true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellInsertAfter', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertCell( selection );\n\t\t\t\t}\n\t\t\t} ) );\n\t\t},\n\n\t\tgetSelectedCells: getSelectedCells\n\n\t});\n} )();\n\n/**\n * Create a two-dimension array that reflects the actual layout of table cells,\n * with cell spans, with mappings to the original td elements.\n *\n * @param {CKEDITOR.dom.element} table\n * @member CKEDITOR.tools\n */\nCKEDITOR.tools.buildTableMap = function( table ) {\n\tvar aRows = table.$.rows;\n\n\t// Row and Column counters.\n\tvar r = -1;\n\n\tvar aMap = [];\n\n\tfor ( var i = 0; i < aRows.length; i++ ) {\n\t\tr++;\n\t\t!aMap[ r ] && ( aMap[ r ] = [] );\n\n\t\tvar c = -1;\n\n\t\tfor ( var j = 0; j < aRows[ i ].cells.length; j++ ) {\n\t\t\tvar oCell = aRows[ i ].cells[ j ];\n\n\t\t\tc++;\n\t\t\twhile ( aMap[ r ][ c ] )\n\t\t\t\tc++;\n\n\t\t\tvar iColSpan = isNaN( oCell.colSpan ) ? 1 : oCell.colSpan;\n\t\t\tvar iRowSpan = isNaN( oCell.rowSpan ) ? 1 : oCell.rowSpan;\n\n\t\t\tfor ( var rs = 0; rs < iRowSpan; rs++ ) {\n\t\t\t\tif ( !aMap[ r + rs ] )\n\t\t\t\t\taMap[ r + rs ] = [];\n\n\t\t\t\tfor ( var cs = 0; cs < iColSpan; cs++ ) {\n\t\t\t\t\taMap[ r + rs ][ c + cs ] = aRows[ i ].cells[ j ];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc += iColSpan - 1;\n\t\t}\n\t}\n\treturn aMap;\n};\n","/**\n * @license Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_tableresize')) {\n        return;\n    }\n\n    var pxUnit = CKEDITOR.tools.cssLength;\n\n    function getWidth(el) {\n        return CKEDITOR.env.ie ? el.$.clientWidth : parseInt(el.getComputedStyle('width'), 10);\n    }\n\n    function getBorderWidth(element, side) {\n        var computed = element.getComputedStyle('border-' + side + '-width'),\n            borderMap = {\n                thin: '0px',\n                medium: '1px',\n                thick: '2px'\n            };\n\n        if (computed.indexOf('px') < 0) {\n            // look up keywords\n            if (computed in borderMap && element.getComputedStyle('border-style') != 'none') {\n                computed = borderMap[computed];\n            } else {\n                computed = 0;\n            }\n        }\n\n        return parseInt(computed, 10);\n    }\n\n    // Gets the table row that contains the most columns.\n    function getMasterPillarRow(table) {\n        var $rows = table.$.rows,\n            maxCells = 0,\n            cellsCount, $elected, $tr;\n\n        for (var i = 0, len = $rows.length; i < len; i++) {\n            $tr = $rows[i];\n            cellsCount = $tr.cells.length;\n\n            if (cellsCount > maxCells) {\n                maxCells = cellsCount;\n                $elected = $tr;\n            }\n        }\n\n        return $elected;\n    }\n\n    function buildTableColumnPillars(table) {\n        var pillars = [],\n            pillarIndex = -1,\n            rtl = (table.getComputedStyle('direction') === 'rtl');\n\n        // Get the raw row element that cointains the most columns.\n        var $tr = getMasterPillarRow(table);\n\n        // Get the tbody element and position, which will be used to set the\n        // top and bottom boundaries.\n        var tbody = new CKEDITOR.dom.element(table.$.tBodies[0]),\n            tbodyPosition = tbody.getDocumentPosition();\n\n        // Loop thorugh all cells, building pillars after each one of them.\n        for (var i = 0, len = $tr.cells.length; i < len; i++) {\n            // Both the current cell and the successive one will be used in the\n            // pillar size calculation.\n            var td = new CKEDITOR.dom.element($tr.cells[i]),\n                nextTd = $tr.cells[i + 1] && new CKEDITOR.dom.element($tr.cells[i + 1]);\n\n            pillarIndex += td.$.colSpan || 1;\n\n            // Calculate the pillar boundary positions.\n            var pillarLeft, pillarRight, pillarWidth;\n\n            var x = td.getDocumentPosition().x;\n\n            // Calculate positions based on the current cell.\n            rtl ? pillarRight = x + getBorderWidth(td, 'left') : pillarLeft = x + td.$.offsetWidth - getBorderWidth(td, 'right');\n\n            // Calculate positions based on the next cell, if available.\n            if (nextTd) {\n                x = nextTd.getDocumentPosition().x;\n\n                rtl ? pillarLeft = x + nextTd.$.offsetWidth - getBorderWidth(nextTd, 'right') : pillarRight = x + getBorderWidth(nextTd, 'left');\n            }\n            // Otherwise calculate positions based on the table (for last cell).\n            else {\n                x = table.getDocumentPosition().x;\n\n                rtl ? pillarLeft = x : pillarRight = x + table.$.offsetWidth;\n            }\n\n            pillarWidth = Math.max(pillarRight - pillarLeft, 4);\n\n            // The pillar should reflects exactly the shape of the hovered\n            // column border line.\n            pillars.push({\n                table: table,\n                index: pillarIndex,\n                x: pillarLeft,\n                y: tbodyPosition.y,\n                width: pillarWidth,\n                height: tbody.$.offsetHeight,\n                rtl: rtl\n            });\n        }\n\n        return pillars;\n    }\n\n    function getPillarAtPosition(pillars, positionX) {\n        for (var i = 0, len = pillars.length; i < len; i++) {\n            var pillar = pillars[i];\n\n            if (positionX >= pillar.x && positionX <= (pillar.x + pillar.width)) {\n                return pillar;\n            }\n        }\n\n        return null;\n    }\n\n    function cancel(evt) {\n        (evt.data || evt).preventDefault();\n    }\n\n    function columnResizer(editor) {\n        var pillar, document, resizer, isResizing, startOffset, currentShift;\n\n        var leftSideCells, rightSideCells, leftShiftBoundary, rightShiftBoundary;\n\n        function detach() {\n            pillar = null;\n            currentShift = 0;\n            isResizing = 0;\n\n            document.removeListener('mouseup', onMouseUp);\n            resizer.removeListener('mousedown', onMouseDown);\n            resizer.removeListener('mousemove', onMouseMove);\n\n            document.getBody().setStyle('cursor', 'auto');\n        }\n\n        function resizeStart() {\n            // Before starting to resize, figure out which cells to change\n            // and the boundaries of this resizing shift.\n\n            var columnIndex = pillar.index,\n                map = CKEDITOR.tools.buildTableMap(pillar.table),\n                leftColumnCells = [],\n                rightColumnCells = [],\n                leftMinSize = Number.MAX_VALUE,\n                rightMinSize = leftMinSize,\n                rtl = pillar.rtl;\n\n            for (var i = 0, len = map.length; i < len; i++) {\n                var row = map[i],\n                    leftCell = row[columnIndex + (rtl ? 1 : 0)],\n                    rightCell = row[columnIndex + (rtl ? 0 : 1)];\n\n                leftCell = leftCell && new CKEDITOR.dom.element(leftCell);\n                rightCell = rightCell && new CKEDITOR.dom.element(rightCell);\n\n                if (!leftCell || !rightCell || !leftCell.equals(rightCell)) {\n                    leftCell && (leftMinSize = Math.min(leftMinSize, getWidth(leftCell)));\n                    rightCell && (rightMinSize = Math.min(rightMinSize, getWidth(rightCell)));\n\n                    leftColumnCells.push(leftCell);\n                    rightColumnCells.push(rightCell);\n                }\n            }\n\n            // Cache the list of cells to be resized.\n            leftSideCells = leftColumnCells;\n            rightSideCells = rightColumnCells;\n\n            // Cache the resize limit boundaries.\n            leftShiftBoundary = pillar.x - leftMinSize;\n            rightShiftBoundary = pillar.x + rightMinSize;\n\n            resizer.setOpacity(0.5);\n            startOffset = parseInt(resizer.getStyle('left'), 10);\n            currentShift = 0;\n            isResizing = 1;\n\n            resizer.on('mousemove', onMouseMove);\n\n            // Prevent the native drag behavior otherwise 'mousemove' won't fire.\n            document.on('dragstart', cancel);\n        }\n\n        function resizeEnd() {\n            isResizing = 0;\n\n            resizer.setOpacity(0);\n\n            currentShift && resizeColumn();\n\n            var table = pillar.table;\n            setTimeout(function() {\n                table.removeCustomData('_cke_table_pillars');\n            }, 0);\n\n            document.removeListener('dragstart', cancel);\n        }\n\n        function resizeColumn() {\n            var rtl = pillar.rtl,\n                cellsCount = rtl ? rightSideCells.length : leftSideCells.length;\n\n            // Perform the actual resize to table cells, only for those by side of the pillar.\n            for (var i = 0; i < cellsCount; i++) {\n                var leftCell = leftSideCells[i],\n                    rightCell = rightSideCells[i],\n                    table = pillar.table;\n\n                // Defer the resizing to avoid any interference among cells.\n                CKEDITOR.tools.setTimeout(function(leftCell, leftOldWidth, rightCell, rightOldWidth, tableWidth, sizeShift) {\n                    // 1px is the minimum valid width (#11626).\n                    leftCell && leftCell.setStyle('width', pxUnit(Math.max(leftOldWidth + sizeShift, 1)));\n                    rightCell && rightCell.setStyle('width', pxUnit(Math.max(rightOldWidth - sizeShift, 1)));\n\n                    // If we're in the last cell, we need to resize the table as well\n                    if (tableWidth) {\n                        table.setStyle('width', pxUnit(tableWidth + sizeShift * (rtl ? -1 : 1)));\n                    }\n                }, 0, this, [\n                    leftCell, leftCell && getWidth(leftCell),\n                    rightCell, rightCell && getWidth(rightCell), (!leftCell || !rightCell) && (getWidth(table) + getBorderWidth(table, 'left') + getBorderWidth(table, 'right')),\n                    currentShift\n                ]);\n            }\n        }\n\n        function onMouseDown(evt) {\n            cancel(evt);\n\n            resizeStart();\n\n            document.on('mouseup', onMouseUp, this);\n        }\n\n        function onMouseUp(evt) {\n            evt.removeListener();\n\n            resizeEnd();\n        }\n\n        function onMouseMove(evt) {\n            move(evt.data.getPageOffset().x);\n        }\n\n        document = editor.document;\n\n        resizer = CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on ' +\n            'style=\"position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;' +\n            'padding:0;background-color:#004;background-image:none;border:0px none;z-index:10\"></div>', document);\n\n        // Clean DOM when editor is destroyed.\n        editor.on('destroy', function() {\n            resizer.remove();\n        });\n\n        // Place the resizer after body to prevent it\n        // from being editable.\n        document.getDocumentElement().append(resizer);\n\n        this.attachTo = function(targetPillar) {\n            // Accept only one pillar at a time.\n            if (isResizing) {\n                return;\n            }\n\n            pillar = targetPillar;\n\n            resizer.setStyles({\n                width: pxUnit(targetPillar.width),\n                height: pxUnit(targetPillar.height),\n                left: pxUnit(targetPillar.x),\n                top: pxUnit(targetPillar.y)\n            });\n\n            resizer.on('mousedown', onMouseDown, this);\n\n            document.getBody().setStyle('cursor', 'col-resize');\n\n            // Display the resizer to receive events but don't show it,\n            // only change the cursor to resizable shape.\n            resizer.show();\n        };\n\n        var move = this.move = function(posX) {\n            if (!pillar){\n                return 0;\n            }\n\n            if (!isResizing && (posX < pillar.x || posX > (pillar.x + pillar.width))) {\n                detach();\n                return 0;\n            }\n\n            var resizerNewPosition = posX - Math.round(resizer.$.offsetWidth / 2);\n\n            if (isResizing) {\n                if (resizerNewPosition === leftShiftBoundary || resizerNewPosition === rightShiftBoundary) {\n                    return 1;\n                }\n\n                resizerNewPosition = Math.max(resizerNewPosition, leftShiftBoundary);\n                resizerNewPosition = Math.min(resizerNewPosition, rightShiftBoundary);\n\n                currentShift = resizerNewPosition - startOffset;\n            }\n\n            resizer.setStyle('left', pxUnit(resizerNewPosition));\n\n            return 1;\n        };\n    }\n\n    function clearPillarsCache(evt) {\n        var target = evt.data.getTarget();\n\n        if (evt.name === 'mouseout') {\n            // Bypass interal mouse move.\n            if (!target.is('table')) {\n                return;\n            }\n\n            var dest = new CKEDITOR.dom.element(evt.data.$.relatedTarget || evt.data.$.toElement);\n            while (dest && dest.$ && !dest.equals(target) && !dest.is('body')) {\n                dest = dest.getParent();\n            }\n            if (!dest || dest.equals(target)) {\n                return;\n            }\n        }\n\n        target.getAscendant('table', 1).removeCustomData('_cke_table_pillars');\n        evt.removeListener();\n    }\n\n    CKEDITOR.plugins.add('ae_tableresize', {\n        requires: 'ae_tabletools',\n\n        init: function(editor) {\n            editor.on('contentDom', function() {\n                var resizer,\n                    editable = editor.editable();\n\n                // In Classic editor it is better to use document\n                // instead of editable so event will work below body.\n                editable.attachListener(editable.isInline() ? editable : editor.document, 'mousemove', function(evt) {\n                    evt = evt.data;\n\n                    var target = evt.getTarget();\n\n                    // FF may return document and IE8 some UFO (object with no nodeType property...)\n                    // instead of an element (#11823).\n                    if (target.type !== CKEDITOR.NODE_ELEMENT) {\n                        return;\n                    }\n\n                    var pageX = evt.getPageOffset().x;\n\n                    // If we're already attached to a pillar, simply move the\n                    // resizer.\n                    if (resizer && resizer.move(pageX)) {\n                        cancel(evt);\n                        return;\n                    }\n\n                    // Considering table, tr, td, tbody but nothing else.\n                    var table, pillars;\n\n                    if (!target.is('table') && !target.getAscendant('tbody', 1)) {\n                        return;\n                    }\n\n                    table = target.getAscendant('table', 1);\n\n                    // Make sure the table we found is inside the container\n                    // (eg. we should not use tables the editor is embedded within)\n                    if (!editor.editable().contains(table)) {\n                        return;\n                    }\n\n                    if (!(pillars = table.getCustomData('_cke_table_pillars'))) {\n                        // Cache table pillars calculation result.\n                        table.setCustomData('_cke_table_pillars', (pillars = buildTableColumnPillars(table)));\n                        table.on('mouseout', clearPillarsCache);\n                        table.on('mousedown', clearPillarsCache);\n                    }\n\n                    var pillar = getPillarAtPosition(pillars, pageX);\n                    if (pillar) {\n                        !resizer && (resizer = new columnResizer(editor));\n                        resizer.attachTo(pillar);\n                    }\n                });\n            });\n        }\n    });\n\n}());\n","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_selectionkeystrokes')) {\n        return;\n    }\n\n    /**\n     * CKEditor plugin that simulates editor interaction events based on manual keystrokes. This\n     * can be used to trigger different reactions in the editor.\n     *\n     * @class CKEDITOR.plugins.ae_selectionkeystrokes\n     */\n    CKEDITOR.plugins.add(\n        'ae_selectionkeystrokes', {\n            requires: 'ae_selectionregion',\n\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function adds a command to the editor for every defined selectionKeystroke\n             * in the configuration and maps it to the specified keystroke.\n             *\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                if (editor.config.selectionKeystrokes) {\n                    editor.config.selectionKeystrokes.forEach(function(selectionKeystroke) {\n                        var command = new CKEDITOR.command(editor, {\n                            exec: function(editor) {\n                                editor.fire('editorInteraction', {\n                                    manualSelection: selectionKeystroke.selection,\n                                    nativeEvent: {},\n                                    selectionData: editor.getSelectionData()\n                                });\n                            }\n                        });\n\n                        var commandName = 'selectionKeystroke' + selectionKeystroke.selection;\n\n                        editor.addCommand(commandName, command);\n                        editor.setKeystroke(selectionKeystroke.keys, commandName);\n                    });\n                }\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_placeholder')) {\n        return;\n    }\n\n    /**\n     * CKEDITOR enterMode config set the behavior of paragraphs\n     * When the content is empty CKEDITOR keeps the enterMode string\n     * into the content\n     * @property\n     * @type {string}\n     */\n    var brFiller = CKEDITOR.env.needsBrFiller ? '<br>' : '';\n\n    var enterModeEmptyValue = {\n        1: ['<p>' + brFiller + '</p>'],\n        2: ['', ' ', brFiller],\n        3: ['<div>' + brFiller + '</div>']\n    };\n\n    /**\n     * CKEditor plugin which allows adding a placeholder to the editor. In this case, if there\n     * is no content to the editor, there will be hint to the user.\n     *\n     * @class CKEDITOR.plugins.ae_placeholder\n     */\n\n    /**\n     * Specifies the placeholder class which have to be aded to editor when editor is not focused.\n     *\n     * @attribute placeholderClass\n     * @default ae_placeholder\n     * @type String\n     */\n\n    CKEDITOR.plugins.add(\n        'ae_placeholder', {\n\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers a 'blur' and 'contentDom' event listeners.\n             *\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.on('blur', this._checkEmptyData, this);\n                editor.on('change', this._checkEmptyData, this);\n                editor.on('focus', this._removePlaceholderClass, this);\n                editor.once('contentDom', this._checkEmptyData, this);\n            },\n\n            /**\n             * Removes any data from the content and adds a class,\n             * specified by the \"placeholderClass\" config attribute.\n             *\n             * @protected\n             * @method _checkEmptyData\n             * @param {CKEDITOR.dom.event} editor event, fired from CKEditor\n             */\n            _checkEmptyData: function(event) {\n                var editor = event.editor;\n\n                var editableNode = editor.editable();\n\n                var innerHtml = editableNode.$.innerHTML.trim();\n\n                var isEmpty = enterModeEmptyValue[editor.config.enterMode].some(function(element) {\n                    return innerHtml === element;\n                });\n\n                if (isEmpty) {\n                    editableNode.addClass(editor.config.placeholderClass);\n                } else {\n                    editableNode.removeClass(editor.config.placeholderClass);\n                }\n            },\n\n            /**\n             * Remove placeholder class when input is focused\n             *\n             * @protected\n             * @method _removePlaceholderClass\n             + @param {CKEDITOR.dom.event} editor event, fired from CKEditor\n             */\n            _removePlaceholderClass: function(event) {\n                var editor = event.editor;\n\n                var editorNode = new CKEDITOR.dom.element(editor.element.$);\n\n                editorNode.removeClass(editor.config.placeholderClass);\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_pasteimages')) {\n        return;\n    }\n\n    /**\n     * CKEditor plugin which allows pasting images directly into the editable area. The image will be encoded\n     * as Data URI. An event `beforeImageAdd` will be fired with the list of pasted images. If any of the listeners\n     * returns `false` or cancels the event, the images won't be added to the content. Otherwise,\n     * an event `imageAdd` will be fired with the inserted element into the editable area.\n     *\n     * @class CKEDITOR.plugins.ae_pasteimages\n     */\n\n    /**\n     * Fired before adding images to the editor.\n     * @event beforeImageAdd\n     * @param {Array} imageFiles Array of image files\n     */\n\n    /**\n     * Fired when an image is being added to the editor successfully.\n     *\n     * @event imageAdd\n     * @param {CKEDITOR.dom.element} el The created image with src as Data URI\n     * @param {File} file The image file\n     */\n\n    CKEDITOR.plugins.add(\n        'ae_pasteimages', {\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers a 'paste' event on the editing area.\n             *\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    editable.attachListener(editable, 'paste', this._onPaste, this, {\n                        editor: editor\n                    });\n                }.bind(this));\n            },\n\n            /**\n             * The function creates an img element with src the image data as Data URI.\n             * Then, it fires an 'imageAdd' event via CKEditor's event system. The passed\n             * params will be:\n             * - `el` - the created img element\n             * - `file` - the original pasted data\n             *\n             * @method _onPaste\n             * @protected\n             * @param {CKEDITOR.dom.event} event A `paste` event, as received natively from CKEditor\n             */\n            _onPaste: function(event) {\n                if (event.data.$.clipboardData) {\n                    var pastedData = event.data.$.clipboardData.items[0];\n                    var editor = event.listenerData.editor;\n\n                    if (pastedData.type.indexOf('image') === 0) {\n                        var reader = new FileReader();\n                        var imageFile = pastedData.getAsFile();\n\n                        reader.onload = function(event) {\n                            var result = editor.fire('beforeImageAdd', {\n                                imageFiles: imageFile\n                            });\n\n                            if (!!result) {\n                                var el = CKEDITOR.dom.element.createFromHtml('<img src=\"' + event.target.result + '\">');\n\n                                editor.insertElement(el);\n\n                                var imageData = {\n                                    el: el,\n                                    file: imageFile\n                                };\n\n                                editor.fire('imageAdd', imageData);\n                            }\n                        }.bind(this);\n\n                        reader.readAsDataURL(imageFile);\n                    }\n                }\n            }\n        }\n    );\n}());","import SelectionTest from '../selections/selection-test.js';\n\n(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_imagealignment')) {\n        return;\n    }\n\n    /**\n     * Enum for supported image alignments\n     * @type {Object}\n     */\n    var IMAGE_ALIGNMENT = {\n        CENTER: 'center',\n        LEFT: 'left',\n        RIGHT: 'right'\n    };\n\n    /**\n     * Enum values for supported image alignments\n     * @type {Array}\n     */\n    var ALIGN_VALUES = [\n        IMAGE_ALIGNMENT.LEFT,\n        IMAGE_ALIGNMENT.RIGHT,\n        IMAGE_ALIGNMENT.CENTER\n    ];\n\n    /**\n     * Necessary styles for the center alignment\n     * @type {Array.<Object>}\n     */\n    var CENTERED_IMAGE_STYLE = [{\n        name: 'display',\n        value: 'block'\n    }, {\n        name: 'margin-left',\n        value: 'auto'\n    }, {\n        name: 'margin-right',\n        value: 'auto'\n    }];\n\n    /**\n     * Retrieves the alignment value of an image.\n     *\n     * @param {CKEDITOR.dom.element} image The image element\n     * @return {String} The alignment value\n     */\n    var getImageAlignment = function(image) {\n        var imageAlignment = image.getStyle('float');\n\n        if (!imageAlignment || imageAlignment === 'inherit' || imageAlignment === 'none') {\n            imageAlignment = image.getAttribute('align');\n        }\n\n        if (!imageAlignment) {\n            var centeredImage = CENTERED_IMAGE_STYLE.every(function(style) {\n                var styleCheck = image.getStyle(style.name) === style.value;\n\n                if (!styleCheck && style.vendorPrefixes) {\n                    styleCheck = style.vendorPrefixes.some(function(vendorPrefix) {\n                        return image.getStyle(vendorPrefix + style.name) === style.value;\n                    });\n                }\n\n                return styleCheck;\n            });\n\n            imageAlignment = centeredImage ? IMAGE_ALIGNMENT.CENTER : null;\n        }\n\n        return imageAlignment;\n    };\n\n    /**\n     * Removes the alignment value of an image\n     *\n     * @param {CKEDITOR.dom.element} image The image element\n     * @param {String} imageAlignment The image alignment value to be removed\n     */\n    var removeImageAlignment = function(image, imageAlignment) {\n        if (imageAlignment === IMAGE_ALIGNMENT.LEFT || imageAlignment === IMAGE_ALIGNMENT.RIGHT) {\n            image.removeStyle('float');\n\n            if (imageAlignment === getImageAlignment(image)) {\n                image.removeAttribute('align');\n            }\n        } else if (imageAlignment === IMAGE_ALIGNMENT.CENTER) {\n            CENTERED_IMAGE_STYLE.forEach(function(style) {\n                image.removeStyle(style.name);\n\n                if (style.vendorPrefixes) {\n                    style.vendorPrefixes.forEach(function(vendorPrefix) {\n                        image.removeStyle(vendorPrefix + style.name);\n                    });\n                }\n            });\n        }\n    };\n\n    /**\n     * Sets the alignment value of an image\n     *\n     * @param {CKEDITOR.dom.element} image The image element\n     * @param {String} imageAlignment The image alignment value to be set\n     */\n    var setImageAlignment = function(image, imageAlignment) {\n        removeImageAlignment(image, getImageAlignment(image));\n\n        if (imageAlignment === IMAGE_ALIGNMENT.LEFT || imageAlignment === IMAGE_ALIGNMENT.RIGHT) {\n            image.setStyle('float', imageAlignment);\n        } else if (imageAlignment === IMAGE_ALIGNMENT.CENTER) {\n            CENTERED_IMAGE_STYLE.forEach(function(style) {\n                image.setStyle(style.name, style.value);\n\n                if (style.vendorPrefixes) {\n                    style.vendorPrefixes.forEach(function(vendorPrefix) {\n                        image.setStyle(vendorPrefix + style.name, style.value);\n                    });\n                }\n            });\n        }\n    };\n\n    /**\n     * CKEditor plugin which modifies the justify commands to properly align images. This\n     * plugin is an excerpt of CKEditor's original image one that can be found at\n     * https://github.com/ckeditor/ckeditor-dev/blob/master/plugins/image/plugin.js\n     *\n     * @class CKEDITOR.plugins.ae_imagealignment\n     */\n    CKEDITOR.plugins.add(\n        'ae_imagealignment', {\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers a 'paste' event on the editing area.\n             *\n             * @method afterInit\n             * @param {Object} editor The current editor instance\n             */\n            afterInit: function(editor) {\n                var self = this;\n\n                ALIGN_VALUES.forEach(function(value) {\n                    var command = editor.getCommand('justify' + value);\n\n                    if (command) {\n                        command.on('exec', function(event) {\n                            var selectionData = editor.getSelectionData();\n\n                            if (selectionData && SelectionTest.image({data: {selectionData: selectionData}})) {\n                                var image = selectionData.element;\n\n                                var imageAlignment = getImageAlignment(image);\n\n                                if (imageAlignment === value) {\n                                    removeImageAlignment(image, value);\n                                } else {\n                                    setImageAlignment(image, value);\n                                }\n\n                                event.cancel();\n\n                                self.refreshCommands(editor, new CKEDITOR.dom.elementPath(image));\n                            }\n                        });\n\n                        command.on('refresh', function(event) {\n                            var selectionData = {\n                                element: event.data.path.lastElement\n                            };\n\n                            if (SelectionTest.image({data: {selectionData: selectionData}})) {\n                                var imageAlignment = getImageAlignment(selectionData.element);\n\n                                this.setState(imageAlignment === value ? CKEDITOR.TRISTATE_ON : CKEDITOR.TRISTATE_OFF);\n\n                                event.cancel();\n                            }\n                        });\n                    }\n                });\n            },\n\n            /**\n             * Forces a refresh of the modified justify commands. This is needed because the applied changes\n             * do not modify the selection, so the refresh is never triggered and the UI does not update\n             * properly until the next selectionChange event.\n             *\n             * @param {CKEDITOR.editor} editor The editor instance\n             * @param {CKEDITOR.dom.elementPath} elementPath The path of the selected image\n             */\n            refreshCommands: function(editor, elementPath) {\n                ALIGN_VALUES.forEach(function(value) {\n                    var command = editor.getCommand('justify' + value);\n\n                    if (command) {\n                        command.refresh(editor, elementPath);\n                    }\n                });\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    /* istanbul ignore if */\n    if (CKEDITOR.plugins.get('ae_embed')) {\n        return;\n    }\n\n    var REGEX_HTTP = /^https?/;\n\n    var REGEX_DEFAULT_LINK = /<a href=/;\n\n    var PROVIDERS = ['youtube', 'twitter'];\n\n    CKEDITOR.DEFAULT_AE_EMBED_URL_TPL = 'http://alloy.iframe.ly/api/oembed?url={url}&callback={callback}';\n    CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL = '<div data-ae-embed-url=\"{url}\"></div>';\n    CKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL = '<a href=\"{url}\">{url}</a>';\n    /**\n     * CKEditor plugin which adds the infrastructure to embed urls as media objects using an oembed\n     * service. By default, and for demoing purposes only, the oembed service is hosted in iframe.ly\n     * at //alloy.iframe.ly/api/oembed?url={url}&callback={callback}. Note this should be changed to\n     * a self-hosted or paid service in production environments. Access to the alloy.iframe.ly endpoint\n     * may be restricted per domain due to significant traffic.\n     *\n     * This plugin adds an `embedUrl` command that can be used to easily embed a URL and transform it\n     * to an embedded content.\n     *\n     * @class CKEDITOR.plugins.ae_embed\n     */\n    CKEDITOR.plugins.add(\n        'ae_embed', {\n            requires: 'widget',\n            init: function(editor) {\n                var AE_EMBED_URL_TPL = new CKEDITOR.template(editor.config.embedUrlTemplate || CKEDITOR.DEFAULT_AE_EMBED_URL_TPL);\n                var AE_EMBED_WIDGET_TPL = new CKEDITOR.template(editor.config.embedWidgetTpl || CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL);\n                var AE_EMBED_DEFAULT_LINK_TPL = new CKEDITOR.template(editor.config.embedLinkDefaultTpl || CKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL);\n\n                // Default function to upcast DOM elements to embed widgets.\n                // It matches CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL\n                var defaultEmbedWidgetUpcastFn = function(element, data) {\n                    if (element.name === 'div' && element.attributes['data-ae-embed-url']) {\n                        data.url = element.attributes['data-ae-embed-url'];\n\n                        return true;\n                    }\n                };\n\n                // Create a embedUrl command that can be invoked to easily embed media URLs\n                editor.addCommand('embedUrl', {\n                    exec: function(editor, data) {\n                        editor.insertHtml(\n                            AE_EMBED_WIDGET_TPL.output({\n                                url: data.url\n                            })\n                        );\n                    }\n                });\n\n                // Create a widget to properly handle embed operations\n                editor.widgets.add('ae_embed', {\n\n\n                    mask: true,\n                    requiredContent: 'div[data-ae-embed-url]',\n\n                    /**\n                     * Listener to be executed every time the widget's data changes. It takes care of\n                     * requesting the embed object to the configured oembed service and render it in\n                     * the editor\n                     *\n                     * @method data\n                     * @param {event} event Data change event\n                     */\n                    data: function(event) {\n                        var widget = this;\n\n                        var url = event.data.url;\n\n                        if (url) {\n                            CKEDITOR.tools.jsonp(AE_EMBED_URL_TPL, {\n                                url: encodeURIComponent(url)\n                            }, function(response) {\n                                if (response.html) {\n                                    if (REGEX_DEFAULT_LINK.test(response.html)) {\n                                        widget.createATag(url);\n                                    } else {\n                                        widget.element.setHtml(response.html);\n                                    }\n                                } else {\n                                    widget.createATag(url);\n                                }\n                            }, function(msg) {\n                                widget.createATag(url);\n                            });\n                        }\n                    },\n\n                    createATag: function(url) {\n                        this.editor.execCommand('undo');\n\n                        var currentSelection = this.editor.getSelection().getSelectedElement();\n\n                        var aTagHtml = AE_EMBED_DEFAULT_LINK_TPL.output({\n                            url: url\n                        });\n\n                        this.editor.insertHtml(aTagHtml);\n                        this.editor.fire('actionPerformed', this);\n                    },\n\n                    /**\n                     * Function used to upcast an element to ae_embed widgets.\n                     *\n                     * @method upcast\n                     * @param {CKEDITOR.htmlParser.element} element The element to be checked\n                     * @param {Object} data The object that will be passed to the widget\n                     */\n                    upcast: function(element, data) {\n                        var embedWidgetUpcastFn = editor.config.embedWidgetUpcastFn || defaultEmbedWidgetUpcastFn;\n\n                        return embedWidgetUpcastFn(element, data);\n                    }\n                });\n\n                // Add a listener to handle paste events and turn links into embed objects\n                editor.once('contentDom', function() {\n                    editor.on('paste', function(event) {\n                        var link = event.data.dataValue;\n\n                        if (REGEX_HTTP.test(link)) {\n                            event.stop();\n\n                            editor.execCommand('embedUrl', {\n                                url: event.data.dataValue\n                            });\n                        }\n                    });\n                });\n\n                // Add a listener to handle selection change events and properly detect editor\n                // interactions on the widgets without messing with widget native selection\n                editor.on('selectionChange', function(event) {\n                    var selection = editor.getSelection();\n\n                    if (selection){\n                        var element = selection.getSelectedElement();\n\n                        if (element) {\n                            var widgetElement = element.findOne('[data-widget=\"ae_embed\"]');\n\n                            if (widgetElement) {\n                                var region = element.getClientRect();\n\n                                var scrollPosition = new CKEDITOR.dom.window(window).getScrollPosition();\n                                region.left -= scrollPosition.x;\n                                region.top += scrollPosition.y;\n\n                                region.direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n\n                                editor.fire('editorInteraction', {\n                                    nativeEvent: {},\n                                    selectionData: {\n                                        element: widgetElement,\n                                        region: region\n                                    }\n                                });\n                            }\n                        }\n                    }\n                });\n\n                // Add a filter to skip filtering widget elements\n                editor.filter.addElementCallback(function(element) {\n                    if ('data-ae-embed-url' in element.attributes) {\n                        return CKEDITOR.FILTER_SKIP_TREE;\n                    }\n                });\n            }\n        }\n    );\n}());","/**\n * CKEditor plugin: Image2\n * - Show gripper to resize images on IE\n */\n(function () {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_dragresize_ie')) {\n        return;\n    }\n\n    var alignmentsObj = {\n        center: 1,\n        left: 0,\n        right: 2\n    };\n\n    /*\n     * Set cursor css depend on imageScaleResize config\n     **/\n\n    var cursor = {\n        both: 'nwse-resize',\n        height: 'ns-resize',\n        scale: 'nwse-resize',\n        width: 'ew-resize',\n    };\n\n    var regexPercent = /^\\s*(\\d+\\%)\\s*$/i;\n\n    var template = '<img alt=\"\" src=\"\" />';\n\n    CKEDITOR.plugins.add('ae_dragresize_ie', {\n        hidpi: true,\n\n        icons: 'image',\n\n        init: function (editor) {\n            var image = widgetDef(editor);\n\n            // Register the widget.\n            editor.widgets.add('image', image);\n        },\n\n        onLoad: function () {\n            CKEDITOR.addCss(\n                '.cke_image_resizer_nwse-resize{' +\n                'cursor: nwse-resize;' +\n                '}' +\n                '.cke_image_resizer_ns-resize{' +\n                'cursor: ns-resize;' +\n                '}' +\n                '.cke_image_resizer_nwse-resize{' +\n                'cursor: nwse-resize;' +\n                '}' +\n                '.cke_image_resizer_ew-resize{' +\n                'cursor: ew-resize;' +\n                '}' +\n                '.cke_image_nocaption{' +\n                // This is to remove unwanted space so resize\n                // wrapper is displayed property.\n                'line-height:0' +\n                '}' +\n                '.cke_image_resizer{' +\n                'display:none;' +\n                'position:absolute;' +\n                'width:10px;' +\n                'height:10px;' +\n                'bottom:-5px;' +\n                'right:-5px;' +\n                'background:#000;' +\n                'outline:1px solid #fff;' +\n                // Prevent drag handler from being misplaced (#11207).\n                'line-height:0;' +\n                'cursor:nwse-resize;' +\n                '}' +\n                '.cke_image_resizer_wrapper{' +\n                'position:relative;' +\n                'display:inline-block;' +\n                'line-height:0;' +\n                '}' +\n                '.cke_widget_wrapper:hover .cke_image_resizer,' +\n                '.cke_image_resizer.cke_image_resizing{' +\n                'display:block' +\n                '}'\n            );\n        },\n\n        requires: 'widget'\n    });\n\n    // Wiget states (forms) depending on alignment and configuration.\n    //\n    // Non-captioned widget (inline styles)\n    // \t\t\n    // \t\tAlign Internal form                  Data                         \n    // \t\t\n    // \t\tnone  <wrapper>                      <img />                      \n    // \t\t       <img />                                                    \n    // \t\t      </wrapper>                                                  \n    // \t\t\n    // \t\tleft  <wrapper style=float:left>   <img style=float:left />   \n    // \t\t       <img />                                                    \n    // \t\t      </wrapper>                                                  \n    // \t\t\n    // \t\tcenter<wrapper>                      <p style=text-align:center>\n    // \t\t       <p style=text-align:center>   <img />                    \n    // \t\t         <img />                     </p>                         \n    // \t\t       </p>                                                       \n    // \t\t      </wrapper>                                                  \n    // \t\t\n    // \t\tright <wrapper style=float:right>  <img style=float:right />  \n    // \t\t       <img />                                                    \n    // \t\t      </wrapper>                                                  \n    // \t\t\n    //\n    // Non-captioned widget (config.image2_alignClasses defined)\n    // \t\t\n    // \t\tAlign Internal form                  Data                         \n    // \t\t\n    // \t\tnone  <wrapper>                      <img />                      \n    // \t\t       <img />                                                    \n    // \t\t      </wrapper>                                                  \n    // \t\t\n    // \t\tleft  <wrapper class=left>         <img class=left />         \n    // \t\t       <img />                                                    \n    // \t\t      </wrapper>                                                  \n    // \t\t\n    // \t\tcenter<wrapper>                      <p class=center>           \n    // \t\t       <p class=center>             <img />                     \n    // \t\t         <img />                     </p>                         \n    // \t\t       </p>                                                       \n    // \t\t      </wrapper>                                                  \n    // \t\t\n    // \t\tright <wrapper class=right>        <img class=right />        \n    // \t\t       <img />                                                    \n    // \t\t      </wrapper>                                                  \n    // \t\t\n    //\n    // Captioned widget (inline styles)\n    // \t\t\n    // \t\tAlign Internal form                           Data                                    \n    // \t\t\n    // \t\tnone  <wrapper>                               <figure />                              \n    // \t\t       <figure />                                                                     \n    // \t\t      </wrapper>                                                                      \n    // \t\t\n    // \t\tleft  <wrapper style=float:left>            <figure style=float:left />           \n    // \t\t       <figure />                                                                     \n    // \t\t      </wrapper>                                                                      \n    // \t\t\n    // \t\tcenter<wrapper style=text-align:center>     <div style=text-align:center>         \n    // \t\t       <figure style=display:inline-block /> <figure style=display:inline-block />\n    // \t\t      </wrapper>                              </p>                                    \n    // \t\t\n    // \t\tright <wrapper style=float:right>           <figure style=float:right />          \n    // \t\t       <figure />                                                                     \n    // \t\t      </wrapper>                                                                      \n    // \t\t\n    //\n    // Captioned widget (config.image2_alignClasses defined)\n    // \t\t\n    // \t\tAlign Internal form                           Data                                    \n    // \t\t\n    // \t\tnone  <wrapper>                               <figure />                              \n    // \t\t       <figure />                                                                     \n    // \t\t      </wrapper>                                                                      \n    // \t\t\n    // \t\tleft  <wrapper class=left>                  <figure class=left />                 \n    // \t\t       <figure />                                                                     \n    // \t\t      </wrapper>                                                                      \n    // \t\t\n    // \t\tcenter<wrapper class=center>                <div class=center>                    \n    // \t\t       <figure />                              <figure />                             \n    // \t\t      </wrapper>                              </p>                                    \n    // \t\t\n    // \t\tright <wrapper class=right>                 <figure class=right />                \n    // \t\t       <figure />                                                                     \n    // \t\t      </wrapper>                                                                      \n    // \t\t\n    //\n    // @param {CKEDITOR.editor}\n    // @returns {Object}\n    function widgetDef(editor) {\n        editor.config.imageScaleResize = editor.config.imageScaleResize || 'both';\n\n        editor.on('imageAdd', function (imageData) {\n            editor.widgets.initOn(imageData.data.el, 'image');\n        });\n\n        var alignClasses = editor.config.image2_alignClasses;\n\n        var captionedClass = editor.config.image2_captionedClass;\n\n        return {\n            init: function () {\n                var helpers = CKEDITOR.plugins.image2;\n\n                var image = this.parts.image;\n\n                var data = {\n                    alt: image.getAttribute('alt') || '',\n                    hasCaption: !!this.parts.caption,\n                    height: image.getAttribute('height') || '',\n                    // Lock ratio is on by default (#10833).\n                    lock: this.ready ? helpers.checkHasNaturalRatio(image) : true,\n                    src: image.getAttribute('src'),\n                    width: image.getAttribute('width') || ''\n                };\n\n                // If we used 'a' in widget#parts definition, it could happen that\n                // selected element is a child of widget.parts#caption. Since there's no clever\n                // way to solve it with CSS selectors, it's done like that. (#11783).\n                var link = image.getAscendant('a');\n\n                if (link && this.wrapper.contains(link)) {\n                    this.parts.link = link;\n                }\n\n                // Depending on configuration, read style/class from element and\n                // then remove it. Removed style/class will be set on wrapper in #data listener.\n                // Note: Center alignment is detected during upcast, so only left/right cases\n                // are checked below.\n                if (!data.align) {\n                    var alignElement = data.hasCaption ? this.element : image;\n\n                    // Read the initial left/right alignment from the class set on element.\n                    if (alignClasses) {\n                        if (alignElement.hasClass(alignClasses[0])) {\n                            data.align = 'left';\n                        } else if (alignElement.hasClass(alignClasses[2])) {\n                            data.align = 'right';\n                        }\n\n                        if (data.align) {\n                            alignElement.removeClass(alignClasses[alignmentsObj[data.align]]);\n                        } else {\n                            data.align = 'none';\n                        }\n                    }\n                    // Read initial float style from figure/image and then remove it.\n                    else {\n                        data.align = alignElement.getStyle('float') || 'none';\n                        alignElement.removeStyle('float');\n                    }\n                }\n\n                // Get rid of extra vertical space when there's no caption.\n                // It will improve the look of the resizer.\n                this.wrapper[(data.hasCaption ? 'remove' : 'add') + 'Class']('cke_image_nocaption');\n\n                this.setData(data);\n\n                if (editor.config.image2_disableResizer !== true) {\n                    setupResizer(this);\n                }\n            },\n\n            // Overrides default method to handle internal mutability of Image2.\n            // @see CKEDITOR.plugins.widget#addClass\n            addClass: function (className) {\n                getStyleableElement(this).addClass(className);\n            },\n\n            allowedContent: getWidgetAllowedContent(editor),\n\n            // This widget converts style-driven dimensions to attributes.\n            contentTransformations: [\n                ['img[width]: sizeToAttribute']\n            ],\n\n            data: function () {\n                var features = this.features;\n\n                // Image can't be captioned when figcaption is disallowed (#11004).\n                if (this.data.hasCaption && !editor.filter.checkFeature(features.caption)) {\n                    this.data.hasCaption = false;\n                }\n\n                // Image can't be aligned when floating is disallowed (#11004).\n                if (this.data.align != 'none' && !editor.filter.checkFeature(features.align)) {\n                    this.data.align = 'none';\n                }\n\n                // Update widget.parts.link since it will not auto-update unless widget\n                // is destroyed and re-inited.\n                if (!this.data.link) {\n                    if (this.parts.link) {\n                        delete this.parts.link;\n                    }\n                } else {\n                    if (!this.parts.link) {\n                        this.parts.link = this.parts.image.getParent();\n                    }\n                }\n\n                this.parts.image.setAttributes({\n                    alt: this.data.alt,\n\n                    contenteditable: this.parts.image.getAttribute('contenteditable') ? this.parts.image.getAttribute('contenteditable') : true,\n\n                    // This internal is required by the editor.\n                    'data-cke-saved-src': this.data.src,\n\n                    src: this.data.src\n                });\n\n                // If shifting non-captioned -> captioned, remove classes\n                // related to styles from <img/>.\n                if (this.oldData && !this.oldData.hasCaption && this.data.hasCaption) {\n                    for (var c in this.data.classes) {\n                        this.parts.image.removeClass(c);\n                    }\n                }\n\n                // Set dimensions of the image according to gathered data.\n                // Do it only when the attributes are allowed (#11004).\n                if (editor.filter.checkFeature(features.dimension)) {\n                    setDimensions(this);\n                }\n\n                // Cache current data.\n                this.oldData = CKEDITOR.tools.extend({}, this.data);\n            },\n\n            downcast: downcastWidgetElement(editor),\n\n            draggable: false,\n\n            // This widget has an editable caption.\n            editables: {\n                caption: {\n                    selector: 'figcaption',\n                    allowedContent: 'br em strong sub sup u s; a[!href,target]'\n                }\n            },\n\n            features: getWidgetFeatures(editor),\n\n            // Overrides default method to handle internal mutability of Image2.\n            // @see CKEDITOR.plugins.widget#getClasses\n            getClasses: (function () {\n                var classRegex = new RegExp('^(' + [].concat(captionedClass, alignClasses).join('|') + ')$');\n\n                return function () {\n                    var classes = this.repository.parseElementClasses(getStyleableElement(this).getAttribute('class'));\n\n                    // Neither config.image2_captionedClass nor config.image2_alignClasses\n                    // do not belong to style classes.\n                    for (var c in classes) {\n                        if (classRegex.test(c)) {\n                            delete classes[c];\n                        }\n                    }\n\n                    return classes;\n                };\n            })(),\n\n            getLabel: function () {\n                var label = (this.data.alt || '') + ' ' + this.pathName;\n\n                return label;\n            },\n\n            // Overrides default method to handle internal mutability of Image2.\n            // @see CKEDITOR.plugins.widget#hasClass\n            hasClass: function (className) {\n                return getStyleableElement(this).hasClass(className);\n            },\n\n            parts: {\n                caption: 'figcaption',\n                image: 'img'\n            },\n\n            // Overrides default method to handle internal mutability of Image2.\n            // @see CKEDITOR.plugins.widget#removeClass\n            removeClass: function (className) {\n                getStyleableElement(this).removeClass(className);\n            },\n\n            requiredContent: 'img[src,alt]',\n\n            styleableElements: 'img figure',\n\n            // Template of the widget: plain image.\n            template: template,\n\n            upcast: upcastWidgetElement(editor)\n        };\n    }\n\n    /**\n     * A set of Enhanced Image (image2) plugin helpers.\n     *\n     * @class\n     * @singleton\n     */\n    CKEDITOR.plugins.image2 = {\n        /**\n         * Checks whether the current image ratio matches the natural one\n         * by comparing dimensions.\n         *\n         * @param {CKEDITOR.dom.element} image\n         * @returns {Boolean}\n         */\n        checkHasNaturalRatio: function (image) {\n            var $ = image.$,\n                natural = this.getNatural(image);\n\n            // The reason for two alternative comparisons is that the rounding can come from\n            // both dimensions, e.g. there are two cases:\n            // \t1. height is computed as a rounded relation of the real height and the value of width,\n            //\t2. width is computed as a rounded relation of the real width and the value of heigh.\n            return Math.round($.clientWidth / natural.width * natural.height) == $.clientHeight ||\n                Math.round($.clientHeight / natural.height * natural.width) == $.clientWidth;\n        },\n\n        /**\n         * Returns natural dimensions of the image. For modern browsers\n         * it uses natural(Width|Height). For old ones (IE8) it creates\n         * a new image and reads the dimensions.\n         *\n         * @param {CKEDITOR.dom.element} image\n         * @returns {Object}\n         */\n        getNatural: function (image) {\n            var dimensions;\n\n            if (image.$.naturalWidth) {\n                dimensions = {\n                    height: image.$.naturalHeigh,\n                    width: image.$.naturalWidth\n                };\n            } else {\n                var img = new Image();\n\n                img.src = image.getAttribute('src');\n\n                dimensions = {\n                    height: img.heigh,\n                    width: img.width\n                };\n            }\n\n            return dimensions;\n        },\n    };\n\n    // Returns a function that creates widgets from all <img> and\n    // <figure class=\"{config.image2_captionedClass}\"> elements.\n    //\n    // @param {CKEDITOR.editor} editor\n    // @returns {Function}\n    function upcastWidgetElement(editor) {\n        var isCenterWrapper = centerWrapperChecker(editor);\n\n        var captionedClass = editor.config.image2_captionedClass;\n\n        // @param {CKEDITOR.htmlParser.element} el\n        // @param {Object} data\n        return function (el, data) {\n            var dimensions = {\n                height: 1,\n                width: 1\n            };\n\n            var name = el.name;\n\n            var image;\n\n            // #11110 Don't initialize on pasted fake objects.\n            if (el.attributes['data-cke-realelement']) {\n                return;\n            }\n\n            // If a center wrapper is found, there are 3 possible cases:\n            //\n            // 1. <div style=\"text-align:center\"><figure>...</figure></div>.\n            //    In this case centering is done with a class set on widget.wrapper.\n            //    Simply replace centering wrapper with figure (it's no longer necessary).\n            //\n            // 2. <p style=\"text-align:center\"><img/></p>.\n            //    Nothing to do here: <p> remains for styling purposes.\n            //\n            // 3. <div style=\"text-align:center\"><img/></div>.\n            //    Nothing to do here (2.) but that case is only possible in enterMode different\n            //    than ENTER_P.\n            if (isCenterWrapper(el)) {\n                if (name == 'div') {\n                    var figure = el.getFirst('figure');\n\n                    // Case #1.\n                    if (figure) {\n                        el.replaceWith(figure);\n                        el = figure;\n                    }\n                }\n                // Cases #2 and #3 (handled transparently)\n\n                // If there's a centering wrapper, save it in data.\n                data.align = 'center';\n\n                // Image can be wrapped in link <a><img/></a>.\n                image = el.getFirst('img') || el.getFirst('a').getFirst('img');\n            }\n\n            // No center wrapper has been found.\n            else if (name == 'figure' && el.hasClass(captionedClass)) {\n                image = el.getFirst('img') || el.getFirst('a').getFirst('img');\n\n                // Upcast linked image like <a><img/></a>.\n            } else if (isLinkedOrStandaloneImage(el)) {\n                image = el.name == 'a' ? el.children[0] : el;\n            }\n\n            if (!image) {\n                return;\n            }\n\n            // If there's an image, then cool, we got a widget.\n            // Now just remove dimension attributes expressed with %.\n            for (var d in dimensions) {\n                var dimension = image.attributes[d];\n\n                if (dimension && dimension.match(regexPercent)) {\n                    delete image.attributes[d];\n                }\n            }\n\n            return el;\n        };\n    }\n\n    // Returns a function which transforms the widget to the external format\n    // according to the current configuration.\n    //\n    // @param {CKEDITOR.editor}\n    function downcastWidgetElement(editor) {\n        var alignClasses = editor.config.image2_alignClasses;\n\n        // @param {CKEDITOR.htmlParser.element} el\n        return function (el) {\n            // In case of <a><img/></a>, <img/> is the element to hold\n            // inline styles or classes (image2_alignClasses).\n            var attrsHolder = el.name == 'a' ? el.getFirst() : el;\n\n            var attrs = attrsHolder.attributes;\n\n            var align = this.data.align;\n\n            // De-wrap the image from resize handle wrapper.\n            // Only block widgets have one.\n            if (!this.inline) {\n                var resizeWrapper = el.getFirst('span');\n\n                if (resizeWrapper) {\n                    resizeWrapper.replaceWith(resizeWrapper.getFirst({\n                        a: 1,\n                        img: 1\n                    }));\n                }\n            }\n\n            if (align && align != 'none') {\n                var styles = CKEDITOR.tools.parseCssText(attrs.style || '');\n\n                // When the widget is captioned (<figure>) and internally centering is done\n                // with widget's wrapper style/class, in the external data representation,\n                // <figure> must be wrapped with an element holding an style/class:\n                //\n                // \t<div style=\"text-align:center\">\n                // \t\t<figure class=\"image\" style=\"display:inline-block\">...</figure>\n                // \t</div>\n                // or\n                // \t<div class=\"some-center-class\">\n                // \t\t<figure class=\"image\">...</figure>\n                // \t</div>\n                //\n                if (align == 'center' && el.name == 'figure') {\n                    el = el.wrapWith(new CKEDITOR.htmlParser.element('div',\n                        alignClasses ? {\n                            'class': alignClasses[1]\n                        } : {\n                            style: 'text-align:center'\n                        }));\n                }\n\n                // If left/right, add float style to the downcasted element.\n                else if (align in {\n                        left: 1,\n                        right: 1\n                    }) {\n                    if (alignClasses) {\n                        attrsHolder.addClass(alignClasses[alignmentsObj[align]]);\n                    } else {\n                        styles['float'] = align;\n                    }\n                }\n\n                // Update element styles.\n                if (!alignClasses && !CKEDITOR.tools.isEmpty(styles)) {\n                    attrs.style = CKEDITOR.tools.writeCssText(styles);\n                }\n            }\n\n            return el;\n        };\n    }\n\n    // Returns a function that checks if an element is a centering wrapper.\n    //\n    // @param {CKEDITOR.editor} editor\n    // @returns {Function}\n    function centerWrapperChecker(editor) {\n        var captionedClass = editor.config.image2_captionedClass;\n\n        var alignClasses = editor.config.image2_alignClasses;\n\n        var validChildren = {\n            a: 1,\n            figure: 1,\n            img: 1\n        };\n\n        return function (el) {\n            // Wrapper must be either <div> or <p>.\n            if (!(el.name in {\n                    div: 1,\n                    p: 1\n                })) {\n                return false;\n            }\n\n            var children = el.children;\n\n            // Centering wrapper can have only one child.\n            if (children.length !== 1) {\n                return false;\n            }\n\n            var child = children[0];\n\n            // Only <figure> or <img /> can be first (only) child of centering wrapper,\n            // regardless of its type.\n            if (!(child.name in validChildren)) {\n                return false;\n            }\n\n            // If centering wrapper is <p>, only <img /> can be the child.\n            //   <p style=\"text-align:center\"><img /></p>\n            if (el.name == 'p') {\n                if (!isLinkedOrStandaloneImage(child)) {\n                    return false;\n                }\n            }\n            // Centering <div> can hold <img/> or <figure>, depending on enterMode.\n            else {\n                // If a <figure> is the first (only) child, it must have a class.\n                //   <div style=\"text-align:center\"><figure>...</figure><div>\n                if (child.name == 'figure') {\n                    if (!child.hasClass(captionedClass)) {\n                        return false;\n                    }\n                } else {\n                    // Centering <div> can hold <img/> or <a><img/></a> only when enterMode\n                    // is ENTER_(BR|DIV).\n                    //   <div style=\"text-align:center\"><img /></div>\n                    //   <div style=\"text-align:center\"><a><img /></a></div>\n                    if (editor.enterMode == CKEDITOR.ENTER_P) {\n                        return false;\n                    }\n\n                    // Regardless of enterMode, a child which is not <figure> must be\n                    // either <img/> or <a><img/></a>.\n                    if (!isLinkedOrStandaloneImage(child)) {\n                        return false;\n                    }\n                }\n            }\n\n            // Centering wrapper got to be... centering. If image2_alignClasses are defined,\n            // check for centering class. Otherwise, check the style.\n            if (alignClasses ? el.hasClass(alignClasses[1]) :\n                CKEDITOR.tools.parseCssText(el.attributes.style || '', true)['text-align'] == 'center') {\n                return true;\n            }\n\n            return false;\n        };\n    }\n\n    // Checks whether element is <img/> or <a><img/></a>.\n    //\n    // @param {CKEDITOR.htmlParser.element}\n    function isLinkedOrStandaloneImage(el) {\n        if (el.name == 'img') {\n            return true;\n        } else if (el.name == 'a') {\n            return el.children.length == 1 && el.getFirst('img');\n        }\n\n        return false;\n    }\n\n    // Sets width and height of the widget image according to current widget data.\n    //\n    // @param {CKEDITOR.plugins.widget} widget\n    function setDimensions(widget) {\n        var data = widget.data;\n\n        var dimensions = {\n            height: data.height,\n            width: data.width\n        };\n\n        var image = widget.parts.image;\n\n        for (var d in dimensions) {\n            if (dimensions[d]) {\n                image.setAttribute(d, dimensions[d]);\n            } else {\n                image.removeAttribute(d);\n            }\n        }\n    }\n\n    // Defines all features related to drag-driven image resizing.\n    //\n    // @param {CKEDITOR.plugins.widget} widget\n    function setupResizer(widget) {\n        var editor = widget.editor;\n\n        var editable = editor.editable();\n\n        var doc = editor.document;\n\n        // Store the resizer in a widget for testing (#11004).\n        var resizer = widget.resizer = doc.createElement('span');\n\n        resizer.addClass('cke_image_resizer');\n        resizer.addClass('cke_image_resizer_' + cursor[editor.config.imageScaleResize]);\n        resizer.append(new CKEDITOR.dom.text('\\u200b', doc));\n\n        // Inline widgets don't need a resizer wrapper as an image spans the entire widget.\n        if (!widget.inline) {\n            var imageOrLink = widget.parts.link || widget.parts.image;\n\n            var oldResizeWrapper = imageOrLink.getParent();\n\n            var resizeWrapper = doc.createElement('span');\n\n            resizeWrapper.addClass('cke_image_resizer_wrapper');\n            resizeWrapper.append(imageOrLink);\n            resizeWrapper.append(resizer);\n            widget.element.append(resizeWrapper, true);\n\n            // Remove the old wrapper which could came from e.g. pasted HTML\n            // and which could be corrupted (e.g. resizer span has been lost).\n            if (oldResizeWrapper.is('span')) {\n                oldResizeWrapper.remove();\n            }\n        } else {\n            widget.wrapper.append(resizer);\n        }\n\n        // Calculate values of size variables and mouse offsets.\n        resizer.on('mousedown', function (evt) {\n            var image = widget.parts.image;\n\n            // \"factor\" can be either 1 or -1. I.e.: For right-aligned images, we need to\n            // subtract the difference to get proper width, etc. Without \"factor\",\n            // resizer starts working the opposite way.\n            var factor = widget.data.align == 'right' ? -1 : 1;\n\n            // The x-coordinate of the mouse relative to the screen\n            // when button gets pressed.\n            var startX = evt.data.$.screenX;\n\n            var startY = evt.data.$.screenY;\n\n            // The initial dimensions and aspect ratio of the image.\n            var startWidth = image.$.clientWidth;\n\n            var startHeight = image.$.clientHeight;\n\n            var listeners = [];\n\n            // A class applied to editable during resizing.\n            var cursorClass = 'cke_image_s' + (!~factor ? 'w' : 'e');\n\n            var nativeEvt, newWidth, newHeight, updateData;\n\n            var moveDiffX, moveDiffY, moveRatio;\n\n            // Save the undo snapshot first: before resizing.\n            editor.fire('saveSnapshot');\n\n            // Mousemove listeners are removed on mouseup.\n            attachToDocuments('mousemove', onMouseMove, listeners);\n\n            // Clean up the mousemove listener. Update widget data if valid.\n            attachToDocuments('mouseup', onMouseUp, listeners);\n\n            // The entire editable will have the special cursor while resizing goes on.\n            editable.addClass(cursorClass);\n\n            // This is to always keep the resizer element visible while resizing.\n            resizer.addClass('cke_image_resizing');\n\n            // Attaches an event to a global document if inline editor.\n            // Additionally, if classic (`iframe`-based) editor, also attaches the same event to `iframe`'s document.\n            function attachToDocuments(name, callback, collection) {\n                var globalDoc = CKEDITOR.document;\n\n                var listeners = [];\n\n                if (!doc.equals(globalDoc)) {\n                    listeners.push(globalDoc.on(name, callback));\n                }\n\n                listeners.push(doc.on(name, callback));\n\n                if (collection) {\n                    for (var i = listeners.length; i--;) {\n                        collection.push(listeners.pop());\n                    }\n                }\n            }\n\n            // This is how variables refer to the geometry.\n            // Note: x corresponds to moveOffset, this is the position of mouse\n            // Note: o corresponds to [startX, startY].\n            //\n            // \t+--------------+--------------+\n            // \t|              |              |\n            // \t|      I       |      II      |\n            // \t|              |              |\n            // \t+------------- o -------------+ _ _ _\n            // \t|              |              |      ^\n\n            // \t|      VI      |     III      |      | moveDiffY\n            // \t|              |         x _ _ _ _ _ v\n            // \t+--------------+---------|----+\n            // \t               |         |\n            // \t                <------->\n            // \t                moveDiffX\n            function onMouseMove(evt) {\n                var imageScaleResize = editor.config.imageScaleResize;\n\n                nativeEvt = evt.data.$;\n\n                // This is how far the mouse is from the point the button was pressed.\n                moveDiffX = nativeEvt.screenX - startX;\n                moveDiffY = startY - nativeEvt.screenY;\n\n                // This is the aspect ratio of the move difference.\n                moveRatio = Math.abs(moveDiffX / moveDiffY);\n\n                if (imageScaleResize === 'width' || imageScaleResize === 'both' || imageScaleResize === 'scale') {\n                    newWidth = startWidth + factor * moveDiffX;\n                }\n\n                if (imageScaleResize === 'height' || imageScaleResize === 'both') {\n                    newHeight = startHeight - moveDiffY;\n                }\n\n                if (imageScaleResize === 'scale') {\n                    newHeight = 'auto';\n                }\n\n                newWidth = newWidth || startWidth;\n                newHeight = newHeight || startHeight;\n\n                // Don't update attributes if less than 10.\n                // This is to prevent images to visually disappear.\n                if (newWidth >= 15 && (newHeight >= 15 || newHeight === 'auto')) {\n                    image.setAttributes({\n                        width: newWidth,\n                        height: newHeight\n                    });\n                    updateData = true;\n                } else {\n                    updateData = false;\n                }\n            }\n\n            function onMouseUp() {\n                var l;\n\n                while ((l = listeners.pop())) {\n                    l.removeListener();\n                }\n\n                // Restore default cursor by removing special class.\n                editable.removeClass(cursorClass);\n\n                // This is to bring back the regular behaviour of the resizer.\n                resizer.removeClass('cke_image_resizing');\n\n                if (updateData) {\n                    widget.setData({\n                        height: newHeight,\n                        width: newWidth\n                    });\n\n                    // Save another undo snapshot: after resizing.\n                    editor.fire('saveSnapshot');\n                }\n\n                // Don't update data twice or more.\n                updateData = false;\n            }\n        });\n\n        // Change the position of the widget resizer when data changes.\n        widget.on('data', function () {\n            resizer[widget.data.align == 'right' ? 'addClass' : 'removeClass']('cke_image_resizer_left');\n        });\n\n        widget.parts.image.on('click', function () {\n\n            editor._.editable.editor.getSelection().selectElement(this);\n\n            var selectionData = editor._.editable.editor.getSelectionData();\n            if (selectionData) {\n                editor.fire('editorInteraction', {\n                    nativeEvent: event,\n                    selectionData: selectionData\n                });\n            }\n        });\n\n    }\n\n    // Returns a set of widget allowedContent rules, depending\n    // on configurations like config#image2_alignClasses or\n    // config#image2_captionedClass.\n    //\n    // @param {CKEDITOR.editor}\n    // @returns {Object}\n    function getWidgetAllowedContent(editor) {\n        var rules = {\n            figcaption: true,\n            figure: {\n                classes: '!' + editor.config.image2_captionedClass\n            },\n            img: {\n                attributes: '!src,alt,width,height'\n            }\n        };\n\n        return rules;\n    }\n\n    // Returns a set of widget feature rules, depending\n    // on editor configuration. Note that the following may not cover\n    // all the possible cases since requiredContent supports a single\n    // tag only.\n    //\n    // @param {CKEDITOR.editor}\n    // @returns {Object}\n    function getWidgetFeatures(editor) {\n        var alignClasses = editor.config.image2_alignClasses;\n\n        var features = {\n            align: {\n                requiredContent: 'img' +\n                    (alignClasses ? '(' + alignClasses[0] + ')' : '{float}')\n            },\n            caption: {\n                requiredContent: 'figcaption'\n            },\n            dimension: {\n                requiredContent: 'img[width,height]'\n            }\n        };\n\n        return features;\n    }\n\n    // Returns element which is styled, considering current\n    // state of the widget.\n    //\n    // @see CKEDITOR.plugins.widget#applyStyle\n    // @param {CKEDITOR.plugins.widget} widget\n    // @returns {CKEDITOR.dom.element}\n    function getStyleableElement(widget) {\n        return widget.data.hasCaption ? widget.element : widget.parts.image;\n    }\n})();\n\nCKEDITOR.config.image2_captionedClass = 'image';","/**\n * CKEditor plugin: Dragable image resizing\n * https://github.com/sstur/ck-dragresize\n * - Shows semi-transparent overlay while resizing\n * - Enforces Aspect Ratio (unless holding shift)\n * - Snap to size of other images in editor\n * - Escape while dragging cancels resize\n */\n(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_dragresize')) {\n        return;\n    }\n\n    var IMAGE_HANDLES = {\n        both: ['tl', 'tm', 'tr', 'lm', 'rm', 'bl', 'bm', 'br'],\n        height: ['tl', 'tm', 'tr', 'bl', 'bm', 'br'],\n        scale: ['tl', 'tr', 'bl', 'br'],\n        width: ['tl', 'tr', 'lm', 'rm', 'bl', 'br'],\n    };\n\n    var POSITION_ELEMENT_FN = {\n        bl: function(handle, left, top, box) {\n            positionElement(handle, -3 + left, box.height - 4 + top);\n        },\n        bm: function(handle, left, top, box) {\n            positionElement(handle, Math.round(box.width / 2) - 3 + left, box.height - 4 + top);\n        },\n        br: function(handle, left, top, box) {\n            positionElement(handle, box.width - 4 + left, box.height - 4 + top);\n        },\n        lm: function(handle, left, top, box) {\n            positionElement(handle, -3 + left, Math.round(box.height / 2) - 3 + top);\n        },\n        tl: function(handle, left, top, box) {\n            positionElement(handle, left - 3, top - 3);\n        },\n        tm: function(handle, left, top, box) {\n            positionElement(handle, Math.round(box.width / 2) - 3 + left, -3 + top);\n        },\n        tr: function(handle, left, top, box) {\n            positionElement(handle, box.width - 4 + left, -3 + top);\n        },\n        rm: function(handle, left, top, box) {\n            positionElement(handle, box.width - 4 + left, Math.round(box.height / 2) - 3 + top);\n        }\n    };\n\n    var IMAGE_SNAP_TO_SIZE = 7;\n\n    var isFirefox = ('MozAppearance' in document.documentElement.style);\n\n    var isWebKit = ('WebkitAppearance' in document.documentElement.style);\n\n    var enablePlugin = isWebKit || isFirefox;\n\n    if (enablePlugin) {\n        // CSS is added in a compressed form\n        CKEDITOR.addCss('img::selection{color:rgba(0,0,0,0)}img.ckimgrsz{outline:1px dashed #000}#ckimgrsz{position:absolute;width:0;height:0;cursor:default;z-index:10001}#ckimgrsz span{display:none;position:absolute;top:0;left:0;width:0;height:0;background-size:100% 100%;opacity:.65;outline:1px dashed #000}#ckimgrsz i{position:absolute;display:block;width:5px;height:5px;background:#fff;border:1px solid #000}#ckimgrsz i.active,#ckimgrsz i:hover{background:#000}#ckimgrsz i.br,#ckimgrsz i.tl{cursor:nwse-resize}#ckimgrsz i.bm,#ckimgrsz i.tm{cursor:ns-resize}#ckimgrsz i.bl,#ckimgrsz i.tr{cursor:nesw-resize}#ckimgrsz i.lm,#ckimgrsz i.rm{cursor:ew-resize}body.dragging-br,body.dragging-br *,body.dragging-tl,body.dragging-tl *{cursor:nwse-resize!important}body.dragging-bm,body.dragging-bm *,body.dragging-tm,body.dragging-tm *{cursor:ns-resize!important}body.dragging-bl,body.dragging-bl *,body.dragging-tr,body.dragging-tr *{cursor:nesw-resize!important}body.dragging-lm,body.dragging-lm *,body.dragging-rm,body.dragging-rm *{cursor:ew-resize!important}');\n    }\n\n    /**\n     * Initializes the plugin\n     */\n    CKEDITOR.plugins.add('ae_dragresize', {\n        onLoad: function() {\n            if (!enablePlugin) {\n                return;\n            }\n        },\n        init: function(editor) {\n            if (!enablePlugin) {\n                return;\n            }\n\n            editor.once('contentDom', function(evt) {\n                init(editor);\n            });\n        }\n    });\n\n    function init(editor) {\n        var window = editor.window.$,\n            document = editor.document.$;\n\n        if (isFirefox) {\n            // Disable the native image resizing\n            document.execCommand('enableObjectResizing', false, false);\n        }\n\n        var snapToSize = (typeof IMAGE_SNAP_TO_SIZE === 'undefined') ? null : IMAGE_SNAP_TO_SIZE;\n\n        editor.config.imageScaleResize = editor.config.imageScaleResize || 'both';\n\n        var resizer = new Resizer(editor, {\n            imageScaleResize: editor.config.imageScaleResize,\n            snapToSize: snapToSize\n        });\n\n        var mouseDownListener = function(e) {\n            if (resizer.isHandle(e.target)) {\n                resizer.initDrag(e);\n            }\n        };\n\n        document.addEventListener('mousedown', mouseDownListener, false);\n\n        function selectionChange() {\n            var selection = editor.getSelection();\n\n            if (!selection) return;\n            // If an element is selected and that element is an IMG\n            if (selection.getType() !== CKEDITOR.SELECTION_NONE && selection.getStartElement().is('img')) {\n                // And we're not right or middle clicking on the image\n                if (!window.event || !window.event.button || window.event.button === 0) {\n                    resizer.show(selection.getStartElement().$);\n                }\n            } else {\n                resizer.hide();\n            }\n        }\n\n        editor.on('selectionChange', selectionChange);\n\n        editor.on('getData', function(e) {\n            var html = e.data.dataValue || '';\n            html = html.replace(/<div id=\"ckimgrsz\"([\\s\\S]*?)<\\/div>/i, '');\n            html = html.replace(/\\b(ckimgrsz)\\b/g, '');\n            e.data.dataValue = html;\n        });\n\n        editor.on('beforeUndoImage', function() {\n            // Remove the handles before undo images are saved\n            resizer.hide();\n        });\n\n        editor.on('afterUndoImage', function() {\n            // Restore the handles after undo images are saved\n            selectionChange();\n        });\n\n        editor.on('blur', function() {\n            // Remove the handles when editor loses focus\n            resizer.hide();\n        });\n\n        editor.on('beforeModeUnload', function self() {\n            editor.removeListener('beforeModeUnload', self);\n            resizer.hide();\n        });\n\n        editor.on('destroy', function() {\n            var resizeElement = document.getElementById('ckimgrsz');\n\n            if (resizeElement) {\n                resizeElement.remove();\n            }\n\n            if (isFirefox) {\n                document.execCommand('enableObjectResizing', false, true);\n            }\n\n            document.removeEventListener('mousedown', mouseDownListener);\n        });\n\n        // Update the selection when the browser window is resized\n        var resizeTimeout;\n        editor.window.on('resize', function() {\n            // Cancel any resize waiting to happen\n            clearTimeout(resizeTimeout);\n            // Delay resize to \"debounce\"\n            resizeTimeout = setTimeout(selectionChange, 50);\n        });\n    }\n\n    function Resizer(editor, cfg) {\n        this.editor = editor;\n        this.window = editor.window.$;\n        this.document = editor.document.$;\n        this.cfg = cfg || {};\n        this.init();\n    }\n\n    Resizer.prototype = {\n        init: function() {\n            var instance = this;\n\n            var container = this.container = this.document.createElement('div');\n\n            container.id = 'ckimgrsz';\n            this.preview = this.document.createElement('span');\n            container.appendChild(this.preview);\n\n            var handles = this.handles = {};\n\n            IMAGE_HANDLES[this.cfg.imageScaleResize].forEach(function (handleName, index) {\n                handles[handleName] = instance.handles[handleName] = instance.createHandle(handleName);\n            });\n\n            for (var n in handles) {\n                container.appendChild(handles[n]);\n            }\n        },\n        createHandle: function(name) {\n            var el = this.document.createElement('i');\n            el.classList.add(name);\n            return el;\n        },\n        isHandle: function(el) {\n            var handles = this.handles;\n            for (var n in handles) {\n                if (handles[n] === el) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        show: function(el) {\n            this.el = el;\n            if (this.cfg.snapToSize) {\n                this.otherImages = toArray(this.document.getElementsByTagName('img'));\n                this.otherImages.splice(this.otherImages.indexOf(el), 1);\n            }\n            var box = this.box = getBoundingBox(this.window, el);\n            positionElement(this.container, box.left, box.top);\n            this.document.body.appendChild(this.container);\n            this.el.classList.add('ckimgrsz');\n            this.showHandles();\n        },\n        hide: function() {\n            // Remove class from all img.ckimgrsz\n            var elements = this.document.getElementsByClassName('ckimgrsz');\n            for (var i = 0; i < elements.length; ++i) {\n                elements[i].classList.remove('ckimgrsz');\n            }\n            this.hideHandles();\n            if (this.container.parentNode) {\n                this.container.parentNode.removeChild(this.container);\n            }\n        },\n        initDrag: function(e) {\n            if (e.button !== 0) {\n                //right-click or middle-click\n                return;\n            }\n            var resizer = this;\n            var drag = new DragEvent(this.window, this.document);\n            drag.onStart = function() {\n                resizer.showPreview();\n                resizer.isDragging = true;\n                resizer.editor.getSelection().lock();\n            };\n            drag.onDrag = function() {\n                resizer.calculateSize(this);\n                resizer.updatePreview();\n                var box = resizer.previewBox;\n                resizer.updateHandles(box, box.left, box.top);\n            };\n            drag.onRelease = function() {\n                resizer.isDragging = false;\n                resizer.hidePreview();\n                resizer.hide();\n                resizer.editor.getSelection().unlock();\n                // Save an undo snapshot before the image is permanently changed\n                resizer.editor.fire('saveSnapshot');\n            };\n            drag.onComplete = function() {\n                resizer.resizeComplete();\n                // Save another snapshot after the image is changed\n                resizer.editor.fire('saveSnapshot');\n            };\n            drag.start(e);\n        },\n        updateHandles: function(box, left, top) {\n            left = left || 0;\n            top = top || 0;\n            var handles = this.handles;\n\n            for (var handle in handles) {\n                POSITION_ELEMENT_FN[handle](handles[handle], left, top, box);\n            }\n        },\n        showHandles: function() {\n            var handles = this.handles;\n            this.updateHandles(this.box);\n            for (var n in handles) {\n                handles[n].style.display = 'block';\n            }\n        },\n        hideHandles: function() {\n            var handles = this.handles;\n            for (var n in handles) {\n                handles[n].style.display = 'none';\n            }\n        },\n        showPreview: function() {\n            this.preview.style.backgroundImage = 'url(\"' + this.el.src + '\")';\n            this.calculateSize();\n            this.updatePreview();\n            this.preview.style.display = 'block';\n        },\n        updatePreview: function() {\n            var box = this.previewBox;\n            positionElement(this.preview, box.left, box.top);\n            this.preview.style.width = this.previewBox.width + 'px';\n            this.preview.style.height = this.previewBox.height + 'px';\n        },\n        hidePreview: function() {\n            var box = getBoundingBox(this.window, this.preview);\n            this.result = {\n                width: box.width,\n                height: box.height\n            };\n            this.preview.style.display = 'none';\n        },\n        calculateSize: function(data) {\n            var box = this.previewBox = {\n                top: 0,\n                left: 0,\n                width: this.box.width,\n                height: this.box.height\n            };\n\n            if (!data) return;\n\n            var attr = data.target.className;\n\n            if (~attr.indexOf('r')) {\n                box.width = Math.max(32, this.box.width + data.delta.x);\n            }\n            if (~attr.indexOf('b')) {\n                box.height = Math.max(32, this.box.height + data.delta.y);\n            }\n            if (~attr.indexOf('l')) {\n                box.width = Math.max(32, this.box.width - data.delta.x);\n            }\n            if (~attr.indexOf('t')) {\n                box.height = Math.max(32, this.box.height - data.delta.y);\n            }\n            //if dragging corner, enforce aspect ratio (unless shift key is being held)\n            if (attr.indexOf('m') < 0 && !data.keys.shift) {\n                var ratio = this.box.width / this.box.height;\n                if (box.width / box.height > ratio) {\n                    box.height = Math.round(box.width / ratio);\n                } else {\n                    box.width = Math.round(box.height * ratio);\n                }\n            }\n\n            var snapToSize = this.cfg.snapToSize;\n\n            if (snapToSize) {\n                var others = this.otherImages;\n                for (var i = 0; i < others.length; i++) {\n                    var other = getBoundingBox(this.window, others[i]);\n                    if (Math.abs(box.width - other.width) <= snapToSize && Math.abs(box.height - other.height) <= snapToSize) {\n                        box.width = other.width;\n                        box.height = other.height;\n                        break;\n                    }\n                }\n            }\n\n            //recalculate left or top position\n            if (~attr.indexOf('l')) {\n                box.left = this.box.width - box.width;\n            }\n            if (~attr.indexOf('t')) {\n                box.top = this.box.height - box.height;\n            }\n        },\n        resizeComplete: function() {\n            resizeElement.call(this, this.el, this.result.width, this.result.height);\n        }\n    };\n\n    function DragEvent(window, document) {\n        this.window = window;\n        this.document = document;\n        this.events = {\n            mousemove: bind(this.mousemove, this),\n            keydown: bind(this.keydown, this),\n            mouseup: bind(this.mouseup, this)\n        };\n    }\n\n    DragEvent.prototype = {\n        start: function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            this.target = e.target;\n            this.attr = e.target.className;\n            this.startPos = {\n                x: e.clientX,\n                y: e.clientY\n            };\n            this.update(e);\n            var events = this.events;\n            this.document.addEventListener('mousemove', events.mousemove, false);\n            this.document.addEventListener('keydown', events.keydown, false);\n            this.document.addEventListener('mouseup', events.mouseup, false);\n            this.document.body.classList.add('dragging-' + this.attr);\n            this.onStart && this.onStart();\n        },\n        update: function(e) {\n            this.currentPos = {\n                x: e.clientX,\n                y: e.clientY\n            };\n            this.delta = {\n                x: e.clientX - this.startPos.x,\n                y: e.clientY - this.startPos.y\n            };\n            this.keys = {\n                shift: e.shiftKey,\n                ctrl: e.ctrlKey,\n                alt: e.altKey\n            };\n        },\n        mousemove: function(e) {\n            this.update(e);\n            this.onDrag && this.onDrag();\n            if (e.which === 0) {\n                //mouse button released outside window; mouseup wasn't fired (Chrome)\n                this.mouseup(e);\n            }\n        },\n        keydown: function(e) {\n            //escape key cancels dragging\n            if (e.keyCode === 27) {\n                this.release();\n            }\n        },\n        mouseup: function(e) {\n            this.update(e);\n            this.release();\n            this.onComplete && this.onComplete();\n        },\n        release: function() {\n            this.document.body.classList.remove('dragging-' + this.attr);\n            var events = this.events;\n            this.document.removeEventListener('mousemove', events.mousemove, false);\n            this.document.removeEventListener('keydown', events.keydown, false);\n            this.document.removeEventListener('mouseup', events.mouseup, false);\n            this.onRelease && this.onRelease();\n        }\n    };\n\n    //helper functions\n    function toArray(obj) {\n        var len = obj.length,\n            arr = new Array(len);\n        for (var i = 0; i < len; i++) {\n            arr[i] = obj[i];\n        }\n        return arr;\n    }\n\n    function bind(fn, ctx) {\n        if (fn.bind) {\n            return fn.bind(ctx);\n        }\n        return function() {\n            fn.apply(ctx, arguments);\n        };\n    }\n\n    function positionElement(el, left, top) {\n        el.style.left = String(left) + 'px';\n        el.style.top = String(top) + 'px';\n    }\n\n    function resizeElement(el, width, height) {\n        var imageScaleResize = this.editor.config.imageScaleResize;\n        if (imageScaleResize === 'both') {\n            el.style.width = String(width) + 'px';\n            el.style.height = String(height) + 'px';\n        }\n        else if (imageScaleResize === 'width' || imageScaleResize === 'scale') {\n            el.style.height = 'auto';\n            el.style.width = String(width) + 'px';\n        }\n        else if (imageScaleResize === 'height') {\n            el.style.height = String(height) + 'px';\n            el.style.width = 'auto';\n        }\n    }\n\n    function getBoundingBox(window, el) {\n        var rect = el.getBoundingClientRect();\n        return {\n            left: rect.left + window.pageXOffset,\n            top: rect.top + window.pageYOffset,\n            width: rect.width,\n            height: rect.height\n        };\n    }\n}());\n","(function() {\n\t'use strict';\n\n    if (CKEDITOR.plugins.get('ae_autolist')) {\n        return;\n    }\n\n    var KEY_BACK = 8;\n\n    var KEY_SPACE = 32;\n\n    var DEFAULT_CONFIG = [\n        {\n            regex: /^\\*$/,\n            type: 'bulletedlist'\n        },\n        {\n            regex: /^1\\.$/,\n            type: 'numberedlist'\n        }\n    ];\n\n\t/**\n     * CKEditor plugin which automatically generates ordered/unordered list when user types text which looks like a list.\n     *\n     * @class CKEDITOR.plugins.ae_autolist\n     * @constructor\n     */\n    CKEDITOR.plugins.add(\n        'ae_autolist', {\n\n            /**\n             * Initialization of the plugin, part of CKeditor plugin lifecycle.\n             * The function registers the `keydown` event on the content editing area.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    editable.attachListener(editable, 'keydown', this._onKeyDown, this, {\n                        editor: editor\n                    });\n\n                }.bind(this));\n            },\n\n            /**\n             * Checks for pressing the `Backspace` key in order to undo the list creation.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method _checkForBackspaceAndUndo\n             * @param {Event} event Event object\n             * @protected\n             */\n            _checkForBackspaceAndUndo: function(event) {\n                var editor = event.listenerData.editor;\n\n                var nativeEvent = event.data.$;\n\n                var editable = editor.editable();\n\n                editable.removeListener('keydown', this._checkForBackspaceAndUndo);\n\n                if (nativeEvent.keyCode === KEY_BACK) {\n                    editor.execCommand('undo');\n                    editor.insertHtml(event.listenerData.bullet + '&nbsp;');\n                    event.data.preventDefault();\n                }\n            },\n\n            /**\n             * Checks current line to find match with MATCHES object to create OL or UL.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method _checkLine\n             * @param {editor} Editor object\n             * @protected\n             * @return {Object|null} Returns an object which contains the detected list config if any\n             */\n            _getListConfig: function(editor) {\n                var configRegex = editor.config.autolist || DEFAULT_CONFIG;\n\n                var range = editor.getSelection().getRanges()[0];\n\n                var textContainer = range.endContainer.getText();\n\n                var bullet = textContainer.substring(0, range.startOffset);\n\n                var text = textContainer.substring(range.startOffset, textContainer.length);\n\n                var index = 0;\n\n                var regexLen = configRegex.length;\n\n                var autolistCfg = null;\n\n                while (!autolistCfg && regexLen > index) {\n                    var regexItem = configRegex[index];\n\n                    if (regexItem.regex.test(bullet)) {\n                        autolistCfg = {\n                            bullet: bullet,\n                            editor: editor,\n                            text: text,\n                            type: regexItem.type\n                        };\n\n                        break;\n                    }\n\n                    index++;\n                }\n\n                return autolistCfg;\n            },\n\n\t\t\t/**\n             * Create list with different types: Bulleted or Numbered list\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method _createList\n             * @param {Object} listConfig Object that contains bullet, text and type for creating the list\n             * @protected\n\t\t\t */\n            _createList: function(listConfig) {\n                var editor = listConfig.editor;\n\n                var range = editor.getSelection().getRanges()[0];\n\n                range.endContainer.setText(listConfig.text);\n                editor.execCommand(listConfig.type);\n\n                var editable = editor.editable();\n\n                // Subscribe to keydown in order to check if the next key press is `Backspace`.\n                // If so, the creation of the list will be discarded.\n                editable.attachListener(editable, 'keydown', this._checkForBackspaceAndUndo, this, {\n                    editor: editor,\n                    bullet: listConfig.bullet\n                }, 1);\n            },\n\n\t\t\t/**\n             * Listens to the `Space` key events to check if the last word\n             * introduced by the user should be replaced by a list (OL or UL)\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method _onKeyDown\n             * @param {Event} event Event object\n             * @protected\n             */\n            _onKeyDown: function(event) {\n                var nativeEvent = event.data.$;\n\n                if (nativeEvent.keyCode === KEY_SPACE) {\n                    var listConfig = this._getListConfig(event.listenerData.editor);\n\n                    if (listConfig) {\n                        event.data.preventDefault();\n                        this._createList(listConfig);\n                    }\n                }\n            }\n        }\n\t);\n}());","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_autolink')) {\n        return;\n    }\n\n    // Disables the auto URL detection feature in IE, their lacks functionality:\n    // They convert the links only on space. We do on space, comma, semicolon and Enter.\n    if (/MSIE ([^;]*)|Trident.*; rv:([0-9.]+)/.test(navigator.userAgent)) {\n        document.execCommand('AutoUrlDetect', false, false);\n    }\n\n    var KEY_BACK = 8;\n\n    var KEY_COMMA = 188;\n\n    var KEY_ENTER = 13;\n\n    var KEY_SEMICOLON = 186;\n\n    var KEY_SPACE = 32;\n\n    var DELIMITERS = [KEY_COMMA, KEY_ENTER, KEY_SEMICOLON, KEY_SPACE];\n\n    var REGEX_LAST_WORD = /[^\\s]+/mg;\n\n    var REGEX_URL = /(https?\\:\\/\\/|www\\.)(-\\.)?([^(\\s/?\\.#-)]+\\.?)+(\\b\\/[^\\s]*)?$/i;\n\n    /**\n     * CKEditor plugin which automatically generates links when user types text which looks like URL.\n     *\n     * @class CKEDITOR.plugins.ae_autolink\n     * @constructor\n     */\n    CKEDITOR.plugins.add(\n        'ae_autolink', {\n\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers the `keyup` event on the editing area.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    editable.attachListener(editable, 'keyup', this._onKeyUp, this, {\n                        editor: editor\n                    });\n                }.bind(this));\n            },\n\n            /**\n             * Retrieves the last word introduced by the user. Reads from the current\n             * caret position backwards until it finds the first white space.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _getLastWord\n             * @protected\n             * @return {String} The last word introduced by user\n             */\n            _getLastWord: function(editor) {\n                var range = editor.getSelection().getRanges()[0];\n\n                var offset = range.startOffset;\n\n                var previousText = '';\n\n                // The user pressed Enter, so we have to look on the previous node\n                if (this._currentKeyCode === KEY_ENTER) {\n                    var previousNode = range.startContainer.getPrevious();\n\n                    var lastChild;\n\n                    if (previousNode) {\n                        // If previous node is a SPACE, (it does not have 'getLast' method),\n                        // ignore it and find the previous text node\n                        while (!previousNode.getLast) {\n                            previousNode = previousNode.getPrevious();\n                        }\n\n                        lastChild = previousNode.getLast();\n\n                        // Depending on the browser, the last child node may be a <BR>\n                        // (which does not have 'getText' method),\n                        // so ignore it and find the previous text node\n                        while (lastChild && !lastChild.getText()) {\n                            lastChild = lastChild.getPrevious();\n                        }\n                    }\n\n                    // Check if the lastChild is already a link\n                    if (!(lastChild && lastChild.$.href)) {\n                        this._startContainer = lastChild;\n                        previousText = lastChild ? lastChild.getText() : '';\n                        this._offset = previousText.length;\n                    }\n                } else {\n                    this._startContainer = range.startContainer;\n\n                    // Last character is the delimiter, ignore it\n                    previousText = this._startContainer.getText().substring(0, offset - 1);\n\n                    this._offset = offset - 1;\n                }\n\n                var lastWord = '';\n\n                var match = previousText.match(REGEX_LAST_WORD);\n\n                if (match) {\n                    lastWord = match.pop();\n                }\n\n                return lastWord;\n            },\n\n            /**\n             * Checks if the given link is a valid URL.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method isValidURL\n             * @param {String} link The link we want to know if it is a valid URL\n             * @protected\n             * @return {Boolean} Returns true if the link is a valid URL, false otherwise\n             */\n            _isValidURL: function(link) {\n                return REGEX_URL.test(link);\n            },\n\n            /**\n             * Listens to the `keydown` event and if the keycode is `Backspace`, removes the previously\n             * created link.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _onKeyDown\n             * @param {EventFacade} event EventFacade object\n             * @protected\n             */\n            _onKeyDown: function(event) {\n                var nativeEvent = event.data.$;\n\n                var editor = event.listenerData.editor;\n\n                var editable = editor.editable();\n\n                editable.removeListener('keydown', this._onKeyDown);\n\n                if (nativeEvent.keyCode === KEY_BACK) {\n                    event.cancel();\n                    event.data.preventDefault();\n\n                    this._removeLink(editor);\n                }\n\n                this._ckLink = null;\n            },\n\n            /**\n             * Listens to the `Enter` and `Space` key events in order to check if the last word\n             * introduced by the user should be replaced by a link element.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _onKeyUp\n             * @param {EventFacade} event EventFacade object\n             * @protected\n             */\n            _onKeyUp: function(event) {\n                var nativeEvent = event.data.$;\n\n                this._currentKeyCode = nativeEvent.keyCode;\n\n                if (DELIMITERS.indexOf(this._currentKeyCode) !== -1) {\n                    var editor = event.listenerData.editor;\n\n                    var lastWord = this._getLastWord(editor);\n\n                    if (this._isValidURL(lastWord)) {\n                        this._replaceContentByLink(editor, lastWord);\n                    }\n                }\n            },\n\n            /**\n             * Replaces content by a link element.\n             *\n             * @fires CKEDITOR.plugins.ae_autolink#autolinkAdd\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _replaceContentByLink\n             * @param {String} content The text that has to be replaced by an link element\n             * @protected\n             */\n            _replaceContentByLink: function(editor, content) {\n                var range = editor.createRange();\n                var node = CKEDITOR.dom.element.get(this._startContainer);\n                var offset = this._offset;\n\n                // Select the content, so CKEDITOR.Link can properly replace it\n                range.setStart(node, offset - content.length);\n                range.setEnd(node, offset);\n                range.select();\n\n                var ckLink = new CKEDITOR.Link(editor);\n                ckLink.create(content);\n                this._ckLink = ckLink;\n\n                var linkNode = ckLink.getFromSelection();\n                editor.fire('autolinkAdd', linkNode);\n\n                this._subscribeToKeyEvent(editor);\n\n                // Now range is on the link and it is selected. We have to\n                // return focus to the caret position.\n                range = editor.getSelection().getRanges()[0];\n\n                // If user pressed `Enter`, get the next editable node at position 0,\n                // otherwise set the cursor at the next character of the link (the white space)\n                if (this._currentKeyCode === KEY_ENTER) {\n                    var nextEditableNode = range.getNextEditableNode();\n\n                    range.setStart(nextEditableNode, 0);\n                    range.setEnd(nextEditableNode, 0);\n                } else {\n                    var nextNode = range.getNextNode();\n\n                    range.setStart(nextNode, 1);\n                    range.setEnd(nextNode, 1);\n                }\n\n                range.select();\n            },\n\n            /**\n             * Fired when a URL is detected in text and converted to a link.\n             *\n             * @event CKEDITOR.plugins.ae_autolink#autolinkAdd\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @param {CKEDITOR.dom.element} el Node of the created link.\n             */\n\n            /**\n             * Removes the created link element, and replaces it by its text.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _removeLink\n             * @protected\n             */\n            _removeLink: function(editor) {\n                var range = editor.getSelection().getRanges()[0];\n                var caretOffset = range.startOffset;\n\n                // Select the link, so CKEDITOR.Link can properly remove it\n                var linkNode = this._startContainer.getNext() || this._startContainer;\n\n                var newRange = editor.createRange();\n                newRange.setStart(linkNode, 0);\n                newRange.setEndAfter(linkNode);\n                newRange.select();\n\n                this._ckLink.remove();\n\n                // Return focus to the caret position\n                range.setEnd(range.startContainer, caretOffset);\n                range.setStart(range.startContainer, caretOffset);\n\n                range.select();\n            },\n\n            /**\n             * Subscribe to a key event of the editable aria.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _subscribeToKeyEvent\n             * @protected\n             */\n            _subscribeToKeyEvent: function(editor) {\n                var editable = editor.editable();\n\n                // Change the priority of keydown listener - 1 means the highest priority.\n                // In Chrome on pressing `Enter` the listener is not being invoked.\n                // See http://dev.ckeditor.com/ticket/11861 for more information.\n                editable.attachListener(editable, 'keydown', this._onKeyDown, this, {\n                    editor: editor\n                }, 1);\n            }\n        }\n    );\n}());\n","(function() {\n    'use strict';\n\n    var isIE = CKEDITOR.env.ie;\n\n    if (CKEDITOR.plugins.get('ae_addimages')) {\n        return;\n    }\n\n    /**\n     * CKEditor plugin which allows Drag&Drop of images directly into the editable area. The image will be encoded\n     * as Data URI. An event `beforeImageAdd` will be fired with the list of dropped images. If any of the listeners\n     * returns `false` or cancels the event, the images won't be added to the content. Otherwise,\n     * an event `imageAdd` will be fired with the inserted element into the editable area.\n     *\n     * @class CKEDITOR.plugins.ae_addimages\n     */\n\n    /**\n     * Fired before adding images to the editor.\n     *\n     * @event CKEDITOR.plugins.ae_addimages#beforeImageAdd\n     * @instance\n     * @memberof CKEDITOR.plugins.ae_addimages\n     * @param {Array} imageFiles Array of image files\n     */\n\n    /**\n     * Fired when an image is being added to the editor successfully.\n     *\n     * @event CKEDITOR.plugins.ae_addimages#imageAdd\n     * @instance\n     * @memberof CKEDITOR.plugins.ae_addimages\n     * @param {CKEDITOR.dom.element} el The created image with src as Data URI\n     * @param {File} file The image file\n     */\n\n    CKEDITOR.plugins.add(\n        'ae_addimages', {\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers a 'dragenter', 'dragover', 'drop' and `paste` events on the editing area.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    editable.attachListener(editable, 'dragenter', this._onDragEnter, this, {\n                        editor: editor\n                    });\n\n                    editable.attachListener(editable, 'dragover', this._onDragOver, this, {\n                        editor: editor\n                    });\n\n                    editable.attachListener(editable, 'drop', this._onDragDrop, this, {\n                        editor: editor\n                    });\n\n                    editable.attachListener(editable, 'paste', this._onPaste, this, {\n                        editor: editor\n                    });\n                }.bind(this));\n            },\n\n            /**\n             * Accepts an array of dropped files to the editor. Then, it filters the images and sends them for further\n             * processing to {{#crossLink \"CKEDITOR.plugins.ae_addimages/_processFile:method\"}}{{/crossLink}}\n             *\n             * @fires CKEDITOR.plugins.ae_addimages#beforeImageAdd\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _handleFiles\n             * @param {Array} files Array of dropped files. Only the images from this list will be processed.\n             * @param {Object} editor The current editor instance\n             * @protected\n             */\n            _handleFiles: function(files, editor) {\n                var file;\n                var i;\n\n                var imageFiles = [];\n\n                for (i = 0; i < files.length; i++) {\n                    file = files[i];\n\n                    if (file.type.indexOf('image') === 0) {\n                        imageFiles.push(file);\n                    }\n                }\n\n                var result = editor.fire('beforeImageAdd', {\n                    imageFiles: imageFiles\n                });\n\n                if (!!result) {\n                    for (i = 0; i < imageFiles.length; i++) {\n                        file = imageFiles[i];\n\n                        this._processFile(file, editor);\n                    }\n                }\n\n                return false;\n            },\n\n            /**\n             * Handles drag drop event. The function will create a selection from the current\n             * point and will send a list of files to be processed to\n             * {{#crossLink \"CKEDITOR.plugins.ae_addimages/_handleFiles:method\"}}{{/crossLink}} method.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _onDragDrop\n             * @param {CKEDITOR.dom.event} event dragdrop event, as received natively from CKEditor\n             * @protected\n             */\n            _onDragDrop: function(event) {\n                var nativeEvent = event.data.$;\n\n                new CKEDITOR.dom.event(nativeEvent).preventDefault();\n\n                var editor = event.listenerData.editor;\n\n                event.listenerData.editor.createSelectionFromPoint(nativeEvent.clientX, nativeEvent.clientY);\n\n                this._handleFiles(nativeEvent.dataTransfer.files, editor);\n            },\n\n            /**\n             * Handles drag enter event. In case of IE, this function will prevent the event.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _onDragEnter\n             * @param {DOM event} event dragenter event, as received natively from CKEditor\n             * @protected\n             */\n            _onDragEnter: function(event) {\n                if (isIE) {\n                    this._preventEvent(event);\n                }\n            },\n\n            /**\n             * Handles drag over event. In case of IE, this function will prevent the event.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _onDragOver\n             * @param {DOM event} event dragover event, as received natively from CKEditor\n             * @protected\n             */\n            _onDragOver: function(event) {\n                if (isIE) {\n                    this._preventEvent(event);\n                }\n            },\n\n            /**\n             * Checks if the pasted data is image and passes it to\n             * {{#crossLink \"CKEDITOR.plugins.ae_addimages/_processFile:method\"}}{{/crossLink}} for processing.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _onPaste\n             * @param {CKEDITOR.dom.event} event A `paste` event, as received natively from CKEditor\n             * @protected\n             */\n            _onPaste: function(event) {\n                if (event.data && event.data.$ && event.data.$.clipboardData && event.data.$.clipboardData.items && event.data.$.clipboardData.items.length > 0) {\n                    var pastedData = event.data.$.clipboardData.items[0];\n\n                    if (pastedData.type.indexOf('image') === 0) {\n                        var imageFile = pastedData.getAsFile();\n\n                        this._processFile(imageFile, event.listenerData.editor);\n                    }\n                }\n            },\n\n            /**\n             * Prevents a native event.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _preventEvent\n             * @param {DOM event} event The event to be prevented.\n             * @protected\n             */\n            _preventEvent: function(event) {\n                event = new CKEDITOR.dom.event(event.data.$);\n\n                event.preventDefault();\n                event.stopPropagation();\n            },\n\n            /**\n             * Processes an image file. The function creates an img element and sets as source\n             * a Data URI, then fires an 'imageAdd' event via CKEditor's event system.\n             *\n             * @fires CKEDITOR.plugins.ae_addimages#imageAdd\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _preventEvent\n             * @param {DOM event} event The event to be prevented.\n             * @protected\n             */\n            _processFile: function(file, editor) {\n                var reader = new FileReader();\n\n                reader.addEventListener('loadend', function() {\n                    var bin = reader.result;\n\n                    var el = CKEDITOR.dom.element.createFromHtml('<img src=\"' + bin + '\">');\n\n                    editor.insertElement(el);\n\n                    var imageData = {\n                        el: el,\n                        file: file\n                    };\n\n                    editor.fire('imageAdd', imageData);\n                });\n\n                reader.readAsDataURL(file);\n            }\n        }\n    );\n}());","import addimages from './addimages';\nimport autolink from './autolink';\nimport autolist from './autolist';\nimport dragresize from './dragresize';\nimport dragresizeie from './dragresize_ie';\nimport embed from './embed';\nimport imagealignment from './imagealignment';\nimport pasteimages from './pasteimages';\nimport placeholder from './placeholder';\nimport selectionkeystrokes from './selectionkeystrokes';\nimport tableresize from './tableresize';\nimport tabletools from './tabletools';\n\nexport {\n    addimages,\n    autolink,\n    autolist,\n    dragresize,\n    dragresizeie,\n    embed,\n    imagealignment,\n    pasteimages,\n    placeholder,\n    selectionkeystrokes,\n    tableresize,\n    tabletools\n};","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_uicore')) {\n        return;\n    }\n\n    /**\n     * UICore class which will handle user interactions with the editor. These interactions\n     * might be triggered via mouse, keyboard or touch devices. The class fill fire an event via\n     * CKEditor's event system - \"editorInteraction\". The UI may listen to this event and\n     * execute some actions - for example to show/hide toolbars.\n     *\n     * By default if user presses the Esc key, 'editorInteraction' event won't be fired. However, this behaviour can be changed\n     * by setting {{#crossLink \"CKEDITOR.plugins.ae_uicore/allowEsc:attribute\"}}{{/crossLink}} config property in editor's configuration to true.\n     *\n     * @class ae_uicore\n     */\n\n    /**\n     * Fired when user interacts somehow with the browser. This may be clicking with the mouse, pressing keyboard button,\n     * or touching screen. This even will be not fired after each interaction. It will be debounced. By default the timeout\n     * is 50ms. This value can be overwritten via {{#crossLink \"CKEDITOR.plugins.ae_uicore/timeout:attribute\"}}{{/crossLink}}\n     * property of editor's configuration, like: editor.config.uicore.timeout = 100\n     *\n     * @memberof ae_uicore\n     * @event ae_uicore#editorInteraction\n     * @param {Object} data An object which contains the following properties:\n     * - nativeEvent - The event as received from CKEditor.\n     * - selectionData - The data, returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n     */\n\n    /**\n     * Fired by UI elements like Toolbars or Buttons when their state changes. The listener updates the live region with the provided data.\n     *\n     * @memberof ae_uicore\n     * @event ae_uicore#ariaUpdate\n     * @param {Object} data An object which contains the following properties:\n     * - message - The provided message from the UI element.\n     */\n\n    /**\n     * If set to true, the editor will still fire {{#crossLink \"CKEDITOR.plugins.ae_uicore/editorInteraction:event\"}}{{/crossLink}} event,\n     * if user presses Esc key.\n     *\n     * @memberof ae_uicore\n     * @attribute allowEsc\n     * @default false\n     * @type Boolean\n     */\n\n    /**\n     * Specifies the default timeout after which the {{#crossLink \"CKEDITOR.plugins.ae_uicore/editorInteraction:event\"}}{{/crossLink}} event\n     * will be fired.\n     *\n     * @memberof ae_uicore\n     * @attribute timeout\n     * @default 50 (ms)\n     * @type Number\n     */\n\n    CKEDITOR.plugins.add(\n        'ae_uicore', {\n            /**\n             * Initializer lifecycle implementation for the UICore plugin.\n             *\n             * @memberof ae_uicore\n             * @method init\n             * @param {Object} editor The current CKEditor instance.\n             * @protected\n             */\n            init: function(editor) {\n                var ariaState = [];\n\n                var ariaElement = this._createAriaElement(editor.id);\n\n                var uiTasksTimeout = editor.config.uicore ? editor.config.uicore.timeout : 50;\n\n                var handleUI = CKEDITOR.tools.debounce(\n                    function(event) {\n                        ariaState = [];\n\n                        if (event.name !== 'keyup' || event.data.$.keyCode !== 27 || editor.config.allowEsc) {\n                            var selectionData = editor.getSelectionData();\n\n                            if (selectionData) {\n                                editor.fire('editorInteraction', {\n                                    nativeEvent: event.data.$,\n                                    selectionData: selectionData\n                                });\n                            }\n                        }\n                    },\n                    uiTasksTimeout\n                );\n\n                var handleAria = CKEDITOR.tools.debounce(\n                    function(event) {\n                        ariaElement.innerHTML = ariaState.join('. ');\n                    },\n                    uiTasksTimeout\n                );\n\n                var handleMouseLeave = CKEDITOR.tools.debounce(\n                    function(event) {\n                        var aeUINodes = document.querySelectorAll('.ae-ui');\n\n                        var found;\n\n                        for (var i = 0; i < aeUINodes.length; i++) {\n                            if (aeUINodes[i].contains(event.data.$.relatedTarget)) {\n                                found = true;\n                                break;\n                            }\n                        }\n\n                        if (!found) {\n                            handleUI(event);\n                        }\n                    },\n                    uiTasksTimeout\n                );\n\n                editor.on('ariaUpdate', function(event) {\n                    // handleAria is debounced function, so if it is being called multiple times, it will\n                    // be canceled until some time passes.\n                    // For that reason here we explicitly append the current message to the list of messages\n                    // and call handleAria. Since it is debounced, when some timeout passes,\n                    // all the messages will be applied to the live region and not only the last one.\n\n                    ariaState.push(event.data.message);\n\n                    handleAria();\n                });\n\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    var focusHandler = editable.attachListener(editable, 'focus', function (event) {\n                        focusHandler.removeListener();\n\n                        editable.attachListener(editable, 'keyup', handleUI);\n                        editable.attachListener(editable, 'mouseup', handleUI);\n                        editable.attachListener(editable, 'mouseleave', handleMouseLeave);\n\n                        handleUI(event);\n                    });\n                });\n\n                editor.on('destroy', function(event) {\n                    ariaElement.parentNode.removeChild(ariaElement);\n\n                    handleUI.detach();\n                });\n            },\n\n            /**\n             * Creates and applies an HTML element to the body of the document which will contain ARIA messages.\n             *\n             * @memberof ae_uicore\n             * @method _createAriaElement\n             * @param {String} id The provided id of the element. It will be used as prefix for the final element Id.\n             * @protected\n             * @return {HTMLElement} The created and applied to DOM element.\n             */\n            _createAriaElement: function(id) {\n                var statusElement = document.createElement('div');\n\n                statusElement.className = 'ae-sr-only';\n\n                statusElement.setAttribute('aria-live', 'polite');\n                statusElement.setAttribute('role', 'status');\n                statusElement.setAttribute('id', id + 'LiveRegion');\n\n                document.body.appendChild(statusElement);\n\n                return statusElement;\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    /**\n     * CKEDITOR.tools class utility which adds additional methods to those of CKEditor.\n     *\n     * @class CKEDITOR.tools\n     */\n\n    /**\n     * Sends a request using the JSONP technique.\n     *\n     * @memberof CKEDITOR.tools\n     * @method jsonp\n     * @param {CKEDITOR.template} urlTemplate The template of the URL to be requested. All properties passed in `urlParams` can be used, plus a `{callback}`, which represent a JSONP callback, must be defined.\n     * @param {Function} callback A function to be called in case of success.\n     * @param {Function} errorCallback A function to be called in case of failure.\n     * @param {Object} urlParams Parameters to be passed to the `urlTemplate`.\n     * @return {Object} An object with the following properties:\n     *  - id: the transaction ID\n     *  - a `cancel()` method\n     * @static\n     */\n    CKEDITOR.tools.jsonp = function(urlTemplate, urlParams, callback, errorCallback) {\n        var callbackKey = CKEDITOR.tools.getNextNumber();\n\n        urlParams = urlParams || {};\n        urlParams.callback = 'CKEDITOR._.jsonpCallbacks[' + callbackKey + ']';\n\n        if (!CKEDITOR._.jsonpCallbacks) {\n            CKEDITOR._.jsonpCallbacks = {};\n        }\n\n        CKEDITOR._.jsonpCallbacks[callbackKey] = function(response) {\n            setTimeout(function() {\n                cleanUp();\n\n                callback(response);\n            });\n        };\n\n        var scriptElement = new CKEDITOR.dom.element('script');\n        scriptElement.setAttribute('src', urlTemplate.output(urlParams));\n        scriptElement.on('error', function() {\n            cleanUp();\n\n            if (errorCallback) {\n                errorCallback();\n            }\n        });\n\n        function cleanUp() {\n            if (scriptElement) {\n                scriptElement.remove();\n                delete CKEDITOR._.jsonpCallbacks[callbackKey];\n                scriptElement = null;\n            }\n        }\n\n        CKEDITOR.document.getBody().append(scriptElement);\n\n        return {\n            cancel: cleanUp,\n            id: callbackKey\n        };\n    };\n\n    /**\n     * Returns a new object containing all of the properties of all the supplied\n     * objects. The properties from later objects will overwrite those in earlier\n     * objects.\n     *\n     * Passing in a single object will create a shallow copy of it.\n     *\n     * @memberof CKEDITOR.tools\n     * @method merge\n     * @param {Object} objects* One or more objects to merge.\n     * @return {Object} A new merged object.\n     * @static\n     */\n    CKEDITOR.tools.merge = CKEDITOR.tools.merge || function() {\n        var result = {};\n\n        for (var i = 0; i < arguments.length; ++i) {\n            var obj = arguments[i];\n\n            for (var key in obj) {\n                if (Object.prototype.hasOwnProperty.call(obj, key)) {\n                    result[key] = obj[key];\n                }\n            }\n        }\n\n        return result;\n    };\n\n    /**\n     * Simulates event on a DOM element.\n     *\n     * @memberof CKEDITOR.tools\n     * @method simulate\n     * @param {DOMElement} element The element on which the event shoud be simualted.\n     * @param {String} event The name of the event which have to be simulated.\n     * @static\n     */\n    CKEDITOR.tools.simulate = function(element, event) {\n        var eventInstance = document.createEvent('Events');\n        eventInstance.initEvent(event, true, false);\n        element.dispatchEvent(eventInstance);\n    };\n}());","(function() {\n    'use strict';\n\n    var IE_NON_DIRECTLY_EDITABLE_ELEMENT = {\n        'table': 1,\n        'col': 1,\n        'colgroup': 1,\n        'tbody': 1,\n        'td': 1,\n        'tfoot': 1,\n        'th': 1,\n        'thead': 1,\n        'tr': 1\n    };\n\n    /**\n     * Table class utility. Provides methods for create, delete and update tables.\n     *\n     * @class CKEDITOR.Table\n     * @constructor\n     * @param {Object} editor The CKEditor instance.\n     */\n\n    function Table(editor) {\n        this._editor = editor;\n    }\n\n    Table.HEADING_BOTH = 'Both';\n    Table.HEADING_COL = 'Column';\n    Table.HEADING_NONE = 'None';\n    Table.HEADING_ROW = 'Row';\n\n    Table.prototype = {\n        constructor: Table,\n\n        /**\n         * Creates a table.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method create\n         * @param {Object} config Table configuration object\n         * @return {Object} The created table\n         */\n        create: function(config) {\n            var editor = this._editor;\n            var table = this._createElement('table');\n\n            config = config ||{};\n\n            // Generate the rows and cols.\n            var tbody = table.append(this._createElement('tbody'));\n            var rows = config.rows || 1;\n            var cols = config.cols || 1;\n\n            for (var i = 0; i < rows; i++) {\n                var row = tbody.append(this._createElement('tr'));\n                for (var j = 0; j < cols; j++) {\n                    var cell = row.append(this._createElement('td'));\n\n                    cell.appendBogus();\n                }\n            }\n\n            this.setAttributes(table, config.attrs);\n            this.setHeading(table, config.heading);\n\n            // Insert the table element if we're creating one.\n            editor.insertElement(table);\n\n            var firstCell = new CKEDITOR.dom.element(table.$.rows[0].cells[0]);\n            var range = editor.createRange();\n            range.moveToPosition(firstCell, CKEDITOR.POSITION_AFTER_START);\n            range.select();\n\n            return table;\n        },\n\n        /**\n         * Retrieves a table from the current selection.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method getFromSelection\n         * @return {CKEDITOR.dom.element} The retrieved table or null if not found.\n         */\n        getFromSelection: function() {\n            var table;\n            var selection = this._editor.getSelection();\n            var selected = selection.getSelectedElement();\n\n            if (selected && selected.is('table')) {\n                table = selected;\n            } else {\n                var ranges = selection.getRanges();\n\n                if (ranges.length > 0) {\n                    // Webkit could report the following range on cell selection (#4948):\n                    // <table><tr><td>[&nbsp;</td></tr></table>]\n\n                    /* istanbul ignore else */\n                    if (CKEDITOR.env.webkit) {\n                        ranges[0].shrink(CKEDITOR.NODE_ELEMENT);\n                    }\n\n                    table = this._editor.elementPath(ranges[0].getCommonAncestor(true)).contains('table', 1);\n                }\n            }\n\n            return table;\n        },\n\n        /**\n         * Checks if a given table can be considered as editable. This method\n         * workarounds a limitation of IE where for some elements (like table),\n         * `isContentEditable` returns always false. This is because IE does not support\n         * `contenteditable` on such elements. However, despite such elements\n         * cannot be set as content editable directly, a content editable SPAN,\n         * or DIV element can be placed inside the individual table cells.\n         * See https://msdn.microsoft.com/en-us/library/ms537837%28v=VS.85%29.aspx\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method isEditable\n         * @param {CKEDITOR.dom.element} el The table element to test if editable\n         * @return {Boolean}\n         */\n        isEditable: function (el) {\n            if (!CKEDITOR.env.ie || !el.is(IE_NON_DIRECTLY_EDITABLE_ELEMENT)) {\n                return !el.isReadOnly();\n            }\n\n            if (el.hasAttribute('contenteditable')) {\n                return (el.getAttribute('contenteditable') !== 'false');\n            }\n\n            return this.isEditable(el.getParent());\n        },\n\n        /**\n         * Returns which heading style is set for the given table.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method getHeading\n         * @param {CKEDITOR.dom.element} table The table to gather the heading from. If null, it will be retrieved from the current selection.\n         * @return {String} The heading of the table. Expected values are `CKEDITOR.Table.NONE`, `CKEDITOR.Table.ROW`, `CKEDITOR.Table.COL` and `CKEDITOR.Table.BOTH`.\n         */\n        getHeading: function(table) {\n            table = table || this.getFromSelection();\n\n            if (!table) {\n                return null;\n            }\n\n            var rowHeadingSettings = table.$.tHead !== null;\n\n            var colHeadingSettings = true;\n\n            // Check if all of the first cells in every row are TH\n            for (var row = 0; row < table.$.rows.length; row++) {\n                // If just one cell isn't a TH then it isn't a header column\n                var cell = table.$.rows[row].cells[0];\n\n                if (cell && cell.nodeName.toLowerCase() !== 'th') {\n                    colHeadingSettings = false;\n                    break;\n                }\n            }\n\n            var headingSettings = Table.HEADING_NONE;\n\n            if (rowHeadingSettings) {\n                headingSettings = Table.HEADING_ROW;\n            }\n\n            if (colHeadingSettings) {\n                headingSettings = (headingSettings === Table.HEADING_ROW ? Table.HEADING_BOTH : Table.HEADING_COL);\n            }\n\n            return headingSettings;\n        },\n\n        /**\n         * Removes a table from the editor.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method remove\n         * @param {CKEDITOR.dom.element} table The table element which table style should be removed.\n         */\n        remove: function(table) {\n            var editor = this._editor;\n\n            if (table) {\n                table.remove();\n            } else {\n                table = editor.elementPath().contains('table', 1);\n\n                if (table) {\n                    // If the table's parent has only one child remove it as well (unless it's a table cell, or the editable element) (#5416, #6289, #12110)\n                    var parent = table.getParent();\n                    var editable = editor.editable();\n\n                    if (parent.getChildCount() === 1 && !parent.is('td', 'th') && !parent.equals(editable)) {\n                        table = parent;\n                    }\n\n                    var range = editor.createRange();\n                    range.moveToPosition(table, CKEDITOR.POSITION_BEFORE_START);\n                    table.remove();\n                    range.select();\n                }\n            }\n        },\n\n        /**\n         * Assigns provided attributes to a table.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method setAttributes\n         * @param {Object} table The table to which the attributes should be assigned\n         * @param {Object} attrs The attributes which have to be assigned to the table\n         */\n        setAttributes: function(table, attrs) {\n            if (attrs) {\n                Object.keys(attrs).forEach(function(attr) {\n                    table.setAttribute(attr, attrs[attr]);\n                });\n            }\n        },\n\n        /**\n         * Sets the appropriate table heading style to a table.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method setHeading\n         * @param {CKEDITOR.dom.element} table The table element to which the heading should be set. If null, it will be retrieved from the current selection.\n         * @param {String} heading The table heading to be set. Accepted values are: `CKEDITOR.Table.NONE`, `CKEDITOR.Table.ROW`, `CKEDITOR.Table.COL` and `CKEDITOR.Table.BOTH`.\n         */\n        setHeading: function(table, heading) {\n            table = table || this.getFromSelection();\n\n            var i, newCell;\n            var tableHead;\n            var tableBody = table.getElementsByTag('tbody').getItem(0);\n\n            var tableHeading = this.getHeading(table);\n            var hadColHeading = (tableHeading === Table.HEADING_COL || tableHeading === Table.HEADING_BOTH);\n\n            var needColHeading = heading === Table.HEADING_COL || heading === Table.HEADING_BOTH;\n            var needRowHeading = heading === Table.HEADING_ROW || heading === Table.HEADING_BOTH;\n\n            // If we need row heading and don't have a <thead> element yet, move the\n            // first row of the table to the head and convert the nodes to <th> ones.\n            if (!table.$.tHead && needRowHeading) {\n                var tableFirstRow = tableBody.getElementsByTag('tr').getItem(0);\n                var tableFirstRowChildCount = tableFirstRow.getChildCount();\n\n                // Change TD to TH:\n                for (i = 0; i < tableFirstRowChildCount; i++) {\n                    var cell = tableFirstRow.getChild(i);\n\n                    // Skip bookmark nodes. (#6155)\n                    if (cell.type === CKEDITOR.NODE_ELEMENT && !cell.data('cke-bookmark')) {\n                        cell.renameNode('th');\n                        cell.setAttribute('scope', 'col');\n                    }\n                }\n\n                tableHead = this._createElement(table.$.createTHead());\n                tableHead.append(tableFirstRow.remove());\n            }\n\n            // If we don't need row heading and we have a <thead> element, move the\n            // row out of there and into the <tbody> element.\n            if (table.$.tHead !== null && !needRowHeading) {\n                // Move the row out of the THead and put it in the TBody:\n                tableHead = this._createElement(table.$.tHead);\n\n                var previousFirstRow = tableBody.getFirst();\n\n                while (tableHead.getChildCount() > 0) {\n                    var newFirstRow = tableHead.getFirst();\n                    var newFirstRowChildCount = newFirstRow.getChildCount();\n\n                    for (i = 0; i < newFirstRowChildCount; i++) {\n                        newCell = newFirstRow.getChild(i);\n\n                        if (newCell.type === CKEDITOR.NODE_ELEMENT) {\n                            newCell.renameNode('td');\n                            newCell.removeAttribute('scope');\n                        }\n                    }\n\n                    newFirstRow.insertBefore(previousFirstRow);\n                }\n\n                tableHead.remove();\n            }\n\n            tableHeading = this.getHeading(table);\n            var hasColHeading = (tableHeading === Table.HEADING_COL || tableHeading === Table.HEADING_BOTH);\n\n            // If we need column heading and the table doesn't have it, convert every first cell in\n            // every row into a `<th scope=\"row\">` element.\n            if (!hasColHeading && needColHeading) {\n                for (i = 0; i < table.$.rows.length; i++) {\n                    if (table.$.rows[i].cells[0].nodeName.toLowerCase() !== 'th') {\n                        newCell = new CKEDITOR.dom.element(table.$.rows[i].cells[0]);\n                        newCell.renameNode('th');\n                        newCell.setAttribute('scope', 'row');\n                    }\n                }\n            }\n\n            // If we don't need column heading but the table has it, convert every first cell in every\n            // row back into a `<td>` element.\n            if (hadColHeading && !needColHeading) {\n                for (i = 0; i < table.$.rows.length; i++) {\n                    var row = new CKEDITOR.dom.element(table.$.rows[i]);\n\n                    if (row.getParent().getName() === 'tbody') {\n                        newCell = new CKEDITOR.dom.element(row.$.cells[0]);\n                        newCell.renameNode('td');\n                        newCell.removeAttribute('scope');\n                    }\n                }\n            }\n        },\n\n        /**\n         * Creates a new CKEDITOR.dom.element using the passed tag name.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @protected\n         * @method _createElement\n         * @param {String} name The tag name from which an element should be created\n         * @return {CKEDITOR.dom.element} Instance of CKEDITOR DOM element class\n         */\n        _createElement: function(name) {\n            return new CKEDITOR.dom.element(name, this._editor.document);\n        }\n    };\n\n    CKEDITOR.on('instanceReady', function(event) {\n        var headingCommands = [Table.HEADING_NONE, Table.HEADING_ROW, Table.HEADING_COL, Table.HEADING_BOTH];\n\n        var tableUtils = new Table(event.editor);\n\n        headingCommands.forEach(function(heading) {\n            event.editor.addCommand('tableHeading' + heading, {\n                exec: function(editor) {\n                    tableUtils.setHeading(null, heading);\n                }\n            });\n        });\n    });\n\n    CKEDITOR.Table = CKEDITOR.Table || Table;\n}());\n","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_selectionregion')) {\n        return;\n    }\n\n    CKEDITOR.SELECTION_TOP_TO_BOTTOM = 0;\n    CKEDITOR.SELECTION_BOTTOM_TO_TOP = 1;\n    CKEDITOR.SELECTION_LEFT_TO_RIGHT = 2;\n    CKEDITOR.SELECTION_RIGHT_TO_LEFT = 3;\n\n    /**\n     * SelectionRegion utility class which provides metadata about the selection. The metadata may be the start and end\n     * rectangles, caret region, etc. **This class is not intended to be used standalone. Its functions will\n     * be merged into each editor instance, so the developer may use them directly via the editor, without making\n     * an instance of this class**.\n     *\n     * @class SelectionRegion\n     * @constructor\n     */\n    function SelectionRegion() {}\n\n    SelectionRegion.prototype = {\n        constructor: SelectionRegion,\n\n        /**\n         * Creates selection from two points in page coordinates.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method createSelectionFromPoint\n         * @param {Number} x X point in page coordinates.\n         * @param {Number} y Y point in page coordinates.\n         */\n        createSelectionFromPoint: function(x, y) {\n            this.createSelectionFromRange(x, y, x, y);\n        },\n\n        /**\n         * Creates selection from range. A range consists from two points in page coordinates.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method createSelectionFromRange\n         * @param {Number} startX X coordinate of the first point.\n         * @param {Number} startY Y coordinate of the first point.\n         * @param {Number} endX X coordinate of the second point.\n         * @param {Number} endY Y coordinate of the second point.\n         */\n        createSelectionFromRange: function(startX, startY, endX, endY) {\n            var end;\n            var endContainer;\n            var endOffset;\n            var range;\n            var start;\n            var startContainer;\n            var startOffset;\n\n            if (typeof document.caretPositionFromPoint === 'function') {\n                start = document.caretPositionFromPoint(startX, startY);\n                end = document.caretPositionFromPoint(endX, endY);\n\n                startContainer = start.offsetNode;\n                endContainer = end.offsetNode;\n\n                startOffset = start.offset;\n                endOffset = end.offset;\n\n                range = this.createRange();\n            } else if (typeof document.caretRangeFromPoint === 'function') {\n                start = document.caretRangeFromPoint(startX, startY);\n                end = document.caretRangeFromPoint(endX, endY);\n\n                startContainer = start.startContainer;\n                endContainer = end.startContainer;\n\n                startOffset = start.startOffset;\n                endOffset = end.startOffset;\n\n                range = this.createRange();\n            }\n\n            if (range && document.getSelection) {\n                range.setStart(new CKEDITOR.dom.node(startContainer), startOffset);\n                range.setEnd(new CKEDITOR.dom.node(endContainer), endOffset);\n\n                this.getSelection().selectRanges([range]);\n            } else if (typeof document.body.createTextRange === 'function') {\n                var selection = this.getSelection();\n\n                selection.unlock();\n\n                range = document.body.createTextRange();\n                range.moveToPoint(startX, startY);\n\n                var endRange = range.duplicate();\n                endRange.moveToPoint(endX, endY);\n\n                range.setEndPoint('EndToEnd', endRange);\n                range.select();\n\n                this.getSelection().lock();\n            }\n        },\n\n        /**\n         * Returns the region of the current position of the caret. The points are in page coordinates.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getCaretRegion\n         * @return {Object} Returns object with the following properties:\n         * - bottom\n         * - left\n         * - right\n         * - top\n         */\n        getCaretRegion: function() {\n            var selection = this.getSelection();\n\n            var region = {\n                bottom: 0,\n                left: 0,\n                right: 0,\n                top: 0\n            };\n\n            var bookmarks = selection.createBookmarks();\n\n            if (!bookmarks.length) {\n                return region;\n            }\n\n            var bookmarkNodeEl = bookmarks[0].startNode.$;\n\n            bookmarkNodeEl.style.display = 'inline-block';\n\n            region = new CKEDITOR.dom.element(bookmarkNodeEl).getClientRect();\n\n            bookmarkNodeEl.parentNode.removeChild(bookmarkNodeEl);\n\n            var scrollPos = new CKEDITOR.dom.window(window).getScrollPosition();\n\n            region.bottom = scrollPos.y + region.bottom;\n            region.left = scrollPos.x + region.left;\n            region.right = scrollPos.x + region.right;\n            region.top = scrollPos.y + region.top;\n\n            return region;\n        },\n\n        /**\n         * Returns data for the current selection.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getSelectionData\n         * @return {Object|null} Returns an object with the following data:\n         * - element - The currently selected element, if any\n         * - text - The selected text\n         * - region - The data, returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionRegion:method\"}}{{/crossLink}}\n         */\n        getSelectionData: function() {\n            var selection = this.getSelection();\n\n            if (!selection.getNative()) {\n                return null;\n            }\n\n            var result = {\n                element: selection.getSelectedElement(),\n                text: selection.getSelectedText()\n            };\n\n            result.region = this.getSelectionRegion(selection);\n\n            return result;\n        },\n\n        /**\n         * Returns the region of the current selection.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getSelectionRegion\n         * @return {Object} Returns object which is being returned from\n         * {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getClientRectsRegion:method\"}}{{/crossLink}} with three more properties:\n         * - direction - the direction of the selection. Can be one of these:\n         *   1. CKEDITOR.SELECTION_TOP_TO_BOTTOM\n         *   2. CKEDITOR.SELECTION_BOTTOM_TO_TOP\n         * - height - The height of the selection region\n         * - width - The width of the selection region\n         */\n        getSelectionRegion: function() {\n            var region = this.getClientRectsRegion();\n\n            region.direction = this.getSelectionDirection();\n\n            region.height = region.bottom - region.top;\n            region.width = region.right - region.left;\n\n            return region;\n        },\n\n        /**\n         * Returns true if the current selection is empty, false otherwise.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method isSelectionEmpty\n         * @return {Boolean} Returns true if the current selection is empty, false otherwise.\n         */\n        isSelectionEmpty: function() {\n            var ranges;\n\n            var selection = this.getSelection();\n\n            return (selection.getType() === CKEDITOR.SELECTION_NONE) ||\n                ((ranges = selection.getRanges()) && ranges.length === 1 && ranges[0].collapsed);\n        },\n\n        /**\n         * Returns object with data about the [client rectangles](https://developer.mozilla.org/en-US/docs/Web/API/Element.getClientRects) of the selection,\n         * normalized across browses. All offsets below are in page coordinates.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getClientRectsRegion\n         * @return {Object} Returns object with the following data:\n         * - bottom - bottom offset of all client rectangles\n         * - left - left offset of all client rectangles\n         * - right - right offset of all client rectangles\n         * - top - top offset of all client rectangles\n         * - startRect - An Object, which contains the following information:\n         *     + bottom - bottom offset\n         *     + height - the height of the rectangle\n         *     + left - left offset of the selection\n         *     + right - right offset of the selection\n         *     + top - top offset of the selection\n         *     + width - the width of the rectangle\n         * - endRect - An Object, which contains the following information:\n         *     + bottom - bottom offset\n         *     + height - the height of the rectangle\n         *     + left - left offset of the selection\n         *     + right - right offset of the selection\n         *     + top - top offset of the selection\n         *     + width - the width of the rectangle\n         *\n         * If there is no native selection, the objects will be filled with 0.\n         */\n        getClientRectsRegion: function() {\n            var selection = this.getSelection();\n            var nativeSelection = selection.getNative();\n\n            var defaultRect = {\n                bottom: 0,\n                height: 0,\n                left: 0,\n                right: 0,\n                top: 0,\n                width: 0\n            };\n\n            var region = {\n                bottom: 0,\n                endRect: defaultRect,\n                left: 0,\n                right: 0,\n                top: 0,\n                startRect: defaultRect\n            };\n\n            if (!nativeSelection) {\n                return region;\n            }\n\n            var bottom = 0;\n            var clientRects;\n            var left = Infinity;\n            var rangeCount;\n            var right = -Infinity;\n            var top = Infinity;\n\n            if (nativeSelection.createRange) {\n                clientRects = nativeSelection.createRange().getClientRects();\n            } else {\n                rangeCount = nativeSelection.rangeCount;\n                clientRects = (nativeSelection.rangeCount > 0) ? nativeSelection.getRangeAt(0).getClientRects() : [];\n            }\n\n            if (clientRects.length === 0) {\n                region = this.getCaretRegion();\n            } else {\n                for (var i = 0, length = clientRects.length; i < length; i++) {\n                    var item = clientRects[i];\n\n                    if (item.left < left) {\n                        left = item.left;\n                    }\n\n                    if (item.right > right) {\n                        right = item.right;\n                    }\n\n                    if (item.top < top) {\n                        top = item.top;\n                    }\n\n                    if (item.bottom > bottom) {\n                        bottom = item.bottom;\n                    }\n                }\n\n                var scrollPos = new CKEDITOR.dom.window(window).getScrollPosition();\n\n                region.bottom = scrollPos.y + bottom;\n                region.left = scrollPos.x + left;\n                region.right = scrollPos.x + right;\n                region.top = scrollPos.y + top;\n\n                if (clientRects.length) {\n                    var endRect = clientRects[clientRects.length - 1];\n                    var startRect = clientRects[0];\n\n                    region.endRect = {\n                        bottom: scrollPos.y + endRect.bottom,\n                        height: endRect.height,\n                        left: scrollPos.x + endRect.left,\n                        right: scrollPos.x + endRect.right,\n                        top: scrollPos.y + endRect.top,\n                        width: endRect.width\n                    };\n\n                    region.startRect = {\n                        bottom: scrollPos.y + startRect.bottom,\n                        height: startRect.height,\n                        left: scrollPos.x + startRect.left,\n                        right: scrollPos.x + startRect.right,\n                        top: scrollPos.y + startRect.top,\n                        width: startRect.width\n                    };\n                }\n            }\n\n            return region;\n        },\n\n        /**\n         * Retrieves the direction of the selection. The direction is from top to bottom or from bottom to top.\n         * For IE < 9 it is not possible, so the direction for these browsers will be always CKEDITOR.SELECTION_TOP_TO_BOTTOM.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getSelectionDirection\n         * @return {Number} Returns a number which represents selection direction. It might be one of these:\n         * - CKEDITOR.SELECTION_TOP_TO_BOTTOM;\n         * - CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n         */\n        getSelectionDirection: function() {\n            var direction = CKEDITOR.SELECTION_TOP_TO_BOTTOM;\n            var selection = this.getSelection();\n            var nativeSelection = selection.getNative();\n\n            if (!nativeSelection) {\n                return direction;\n            }\n\n            var anchorNode;\n\n            if ((anchorNode = nativeSelection.anchorNode) && anchorNode.compareDocumentPosition) {\n                var position = anchorNode.compareDocumentPosition(nativeSelection.focusNode);\n\n                if (!position && nativeSelection.anchorOffset > nativeSelection.focusOffset || position === Node.DOCUMENT_POSITION_PRECEDING) {\n                    direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n                }\n            }\n\n            return direction;\n        }\n    };\n\n    CKEDITOR.plugins.add(\n        'ae_selectionregion', {\n            init: function(editor) {\n                var attr,\n                    hasOwnProperty;\n\n                hasOwnProperty = Object.prototype.hasOwnProperty;\n\n                for (attr in SelectionRegion.prototype) {\n                    if (hasOwnProperty.call(SelectionRegion.prototype, attr) && typeof editor[attr] === 'undefined') {\n                        editor[attr] = SelectionRegion.prototype[attr];\n                    }\n                }\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    // Wraps each of the plugin lifecycle methods in a closure that will\n    // set up the editor.__processingPlugin__ variable so it can be globally\n    // accessed exposing the plugin being processed and the lifecycle phase\n    // in which it is happening\n    //\n    // @param {Object} plugin The plugin to wrap lifecycle methods\n    var wrapPluginLifecycle = function(plugin) {\n        var methods = ['beforeInit', 'init', 'afterInit'];\n\n        methods.forEach(function(methodName) {\n            if (plugin[methodName]) {\n                plugin[methodName] = CKEDITOR.tools.override(plugin[methodName], function(originalPluginMethod) {\n                    var payload = {\n                        phase: methodName,\n                        plugin: plugin\n                    };\n\n                    return function(editor) {\n                        editor.__processingPlugin__ = payload;\n\n                        originalPluginMethod.call(this, editor);\n\n                        editor.__processingPlugin__ = null;\n                    };\n                });\n            }\n        });\n    };\n\n    // Filters the requires object to remove unwanted dependencies. At this point\n    // only 'toolbar' has been identified, but more can appear. An unwanted plugin\n    // dependency is one that prevents a necessary plugin from being removed\n    //\n    // @param {string|Array<string>} requires The requires object\n    // @return {string} The filtered requires object\n    var filterUnwantedDependencies = function(requires) {\n        if (typeof requires === 'string') {\n            requires = requires.split(',');\n        }\n\n        return requires.filter(function(require) {\n            return require !== 'toolbar';\n        });\n    };\n\n    /**\n     * CKEDITOR.plugins class utility which adds additional methods to those of CKEditor.\n     *\n     * @class CKEDITOR.plugins\n     */\n\n    /**\n     * Overrides CKEDITOR.plugins.load method so we can extend the lifecycle methods of\n     * the loaded plugins to add some metainformation about the plugin being processed\n     *\n\t * @param {String/Array} names The name of the resource to load. It may be a\n\t * string with a single resource name, or an array with several names.\n\t * @param {Function} callback A function to be called when all resources\n\t * are loaded. The callback will receive an array containing all loaded names.\n\t * @param {Object} [scope] The scope object to be used for the callback call.\n     * @memberof CKEDITOR.plugins\n     * @method load\n     * @static\n     */\n    CKEDITOR.plugins.load = CKEDITOR.tools.override(CKEDITOR.plugins.load, function(pluginsLoad){\n        // Wrap original load function so we can transform the plugin input parameter\n        // before passing it down to the original callback\n        return function(names, callback, scope) {\n            pluginsLoad.call(this, names, function(plugins) {\n                if (callback) {\n                    Object.keys(plugins).forEach(function(pluginName) {\n                        var plugin = plugins[pluginName];\n\n                        if (plugin.requires) {\n                            plugin.requires = filterUnwantedDependencies(plugin.requires);\n                        }\n\n                        wrapPluginLifecycle(plugin);\n                    });\n\n                    callback.call(scope, plugins);\n                }\n            });\n        };\n    });\n}());","(function() {\n    'use strict';\n\n    var REGEX_BOOKMARK_SCHEME = /^#.*/i;\n    var REGEX_EMAIL_SCHEME = /^[a-z0-9\\u0430-\\u044F\\._-]+@/i;\n    var REGEX_URI_SCHEME = /^(?:[a-z][a-z0-9+\\-.]*)\\:|^\\//i;\n\n    /**\n     * Link class utility. Provides methods for create, delete and update links.\n     *\n     * @class CKEDITOR.Link\n     * @constructor\n     * @param {Object} editor The CKEditor instance.\n     */\n    function Link(editor, config) {\n        this._editor = editor;\n        this.appendProtocol = config && config.appendProtocol === false ? false : true;\n    }\n\n    Link.prototype = {\n        constructor: Link,\n\n        /**\n         * Advances the editor selection to the next available position after a\n         * given link or the one in the current selection.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method advanceSelection\n         * @param {CKEDITOR.dom.element} link The link element which link style should be removed.\n         */\n        advanceSelection: function(link) {\n            link = link || this.getFromSelection();\n\n            var range = this._editor.getSelection().getRanges()[0];\n\n            if (link) {\n                range.moveToElementEditEnd(link);\n\n                var nextNode = range.getNextEditableNode();\n\n                if (nextNode && !this._editor.element.equals(nextNode.getCommonAncestor(link))) {\n                    var whitespace = /\\s/.exec(nextNode.getText());\n\n                    var offset = whitespace ? whitespace.index + 1 : 0;\n\n                    range.setStart(nextNode, offset);\n                    range.setEnd(nextNode, offset);\n                }\n            }\n\n            this._editor.getSelection().selectRanges([range]);\n        },\n\n        /**\n         * Create a link with given URI as href.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method create\n         * @param {Object} attrs A config object with link attributes. These might be arbitrary DOM attributes.\n         * @param {Object} modifySelection A config object with an advance attribute to indicate if the selection should be moved after the link creation.\n         * @param {String} URI The URI of the link.\n         */\n        create: function(URI, attrs, modifySelection) {\n            var selection = this._editor.getSelection();\n\n            var range = selection.getRanges()[0];\n\n            if (range.collapsed) {\n                var text = new CKEDITOR.dom.text(URI, this._editor.document);\n                range.insertNode(text);\n                range.selectNodeContents(text);\n            }\n\n            URI = this._getCompleteURI(URI);\n\n            var linkAttrs = CKEDITOR.tools.merge({\n                'data-cke-saved-href': URI,\n                href: URI\n            }, attrs);\n\n            var style = new CKEDITOR.style({\n                attributes: linkAttrs,\n                element: 'a'\n            });\n\n            style.type = CKEDITOR.STYLE_INLINE;\n            style.applyToRange(range, this._editor);\n\n            if (modifySelection && modifySelection.advance) {\n                this.advanceSelection();\n            } else {\n                range.select();\n            }\n        },\n\n        /**\n         * Retrieves a link from the current selection.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method getFromSelection\n         * @return {CKEDITOR.dom.element} The retrieved link or null if not found.\n         */\n        getFromSelection: function() {\n            var selection = this._editor.getSelection();\n\n            var selectedElement = selection.getSelectedElement();\n\n            if (selectedElement && selectedElement.is('a')) {\n                return selectedElement;\n            }\n\n            var range = selection.getRanges()[0];\n\n            if (range) {\n                range.shrink(CKEDITOR.SHRINK_TEXT);\n\n                return this._editor.elementPath(range.getCommonAncestor()).contains('a', 1);\n            }\n\n            return null;\n        },\n\n        /**\n         * Removes a link from the editor.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method remove\n         * @param {CKEDITOR.dom.element} link The link element which link style should be removed.\n         * @param {Object} modifySelection A config object with an advance attribute to indicate if the selection should be moved after the link creation.\n         */\n        remove: function(link, modifySelection) {\n            var editor = this._editor;\n\n            if (link) {\n                if (modifySelection && modifySelection.advance) {\n                    this.advanceSelection();\n                }\n\n                link.remove(editor);\n            } else {\n                var style = new CKEDITOR.style({\n                    alwaysRemoveElement: 1,\n                    element: 'a',\n                    type: CKEDITOR.STYLE_INLINE\n                });\n\n                // 'removeStyle()' removes the style from the editor's current selection.\n                //  We need to force the selection to be the whole link element\n                //  to remove it properly.\n\n                var selection = editor.getSelection();\n                selection.selectElement(selection.getStartElement());\n\n                editor.removeStyle(style);\n            }\n        },\n\n        /**\n         * Updates the href of an already existing link.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method update\n         * @param {CKEDITOR.dom.element} link The link element which href should be removed.\n         * @param {Object|String} attrs The attributes to update or remove. Attributes with null values will be removed.\n         * @param {Object} modifySelection A config object with an advance attribute to indicate if the selection should be moved after the link creation.\n         */\n        update: function(attrs, link, modifySelection) {\n            var instance =  this;\n\n            link = link || this.getFromSelection();\n\n            if (typeof attrs === 'string') {\n                var uri = instance._getCompleteURI(attrs);\n\n                link.setAttributes({\n                    'data-cke-saved-href': uri,\n                    href: uri\n                });\n            } else if (typeof attrs === 'object') {\n                var removeAttrs = [];\n\n                var setAttrs = {};\n\n                Object.keys(attrs).forEach(function(key) {\n                    if (attrs[key] === null) {\n                        if (key === 'href') {\n                            removeAttrs.push('data-cke-saved-href');\n                        }\n\n                        removeAttrs.push(key);\n                    } else {\n                        if (key === 'href') {\n                            var uri = instance._getCompleteURI(attrs[key]);\n\n                            setAttrs['data-cke-saved-href'] = uri;\n                            setAttrs[key] = uri;\n                        } else {\n                            setAttrs[key] = attrs[key];\n                        }\n                    }\n                });\n\n                link.removeAttributes(removeAttrs);\n                link.setAttributes(setAttrs);\n            }\n\n            if (modifySelection && modifySelection.advance) {\n                this.advanceSelection(link);\n            }\n        },\n\n        /**\n         * Checks if the URI begins with a '#' symbol to determine if it's an on page bookmark.\n         * If it doesn't, it then checks if the URI has an '@' symbol. If it does and the URI\n         * looks like an email and doesn't have 'mailto:', 'mailto:' is added to the URI.\n         * If it doesn't and the URI doesn't have a scheme, the default 'http' scheme with\n         * hierarchical path '//' is added to the URI.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method _getCompleteURI\n         * @param {String} URI The URI of the link.\n         * @protected\n         * @return {String} The URI updated with the protocol.\n         */\n        _getCompleteURI: function(URI) {\n            if (REGEX_BOOKMARK_SCHEME.test(URI)) {\n                return URI;\n            } else if (REGEX_EMAIL_SCHEME.test(URI)) {\n                URI = 'mailto:' + URI;\n            } else if (!REGEX_URI_SCHEME.test(URI)) {\n                URI = this.appendProtocol ? 'http://' + URI : URI;\n            }\n\n            return URI;\n        }\n    };\n\n    CKEDITOR.Link = CKEDITOR.Link || Link;\n}());","(function() {\n    'use strict';\n\n    /**\n     * Debounce util function. If a function execution is expensive, it might be debounced. This means\n     * that it will be executed after some amount of time after its last call. For example, if we attach a\n     * a function on scroll event, it might be called hundreds times per second. In this case it may be\n     * debounced with, let's say 100ms. The real execution of this function will happen 100ms after last\n     * scroll event.\n     *\n     * @memberof CKEDITOR.tools\n     * @method debounce\n     * @param {Array} args An array of arguments which the callback will receive.\n     * @param {Function} callback The callback which has to be called after given timeout.\n     * @param {Number} timeout Timeout in milliseconds after which the callback will be called.\n     * @param {Object} context The context in which the callback will be called. This argument is optional.\n     * @static\n     */\n    CKEDITOR.tools.debounce = CKEDITOR.tools.debounce || function(callback, timeout, context, args) {\n        var debounceHandle;\n\n        var callFn = function() {\n            var callContext = context || this;\n\n            clearTimeout(debounceHandle);\n\n            var result = [];\n\n            for (var len = arguments.length, startIndex = 0; startIndex < len; ++startIndex) {\n                result.push(arguments[startIndex]);\n            }\n\n            var callArgs = result.concat(args || []);\n\n            debounceHandle = setTimeout(function() {\n                callback.apply(callContext, callArgs);\n            }, timeout);\n        };\n\n        callFn.detach = function() {\n            clearTimeout(debounceHandle);\n        };\n\n        return callFn;\n    };\n}());","import debounce from './debounce';\nimport link from './link';\nimport plugins from './plugins';\nimport selectionRegion from './selection-region';\nimport table from './table';\nimport tools from './tools';\nimport uicore from './uicore';\n\nexport {\n    debounce,\n    link,\n    plugins,\n    selectionRegion,\n    table,\n    tools,\n    uicore\n};","import '../core';\nimport '../plugins';\n\nimport '../components/uibridge/uibridge.js';\n\nimport extend from '../oop/oop';\nimport Lang from '../oop/lang';\nimport Base from '../oop/base';\nimport Selections from '../selections/Selections';\nimport UI from '../components/main.jsx';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\n/**\n * AlloyEditor main class. Creates instance of the editor and provides the user configuration\n * to the UI.\n *\n * @class Core\n * @constructor\n */\nfunction Core(config) {\n    Core.superclass.constructor.call(this, config);\n}\n\nextend(Core, Base, {\n    /**\n     * Initializer lifecycle implementation for the AlloyEditor class. Creates a CKEditor\n     * instance, passing it the provided configuration attributes.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method initializer\n     * @param config {Object} Configuration object literal for the editor.\n     */\n    initializer: function(config) {\n        var node = this.get('srcNode');\n\n        if (this.get('enableContentEditable')) {\n            node.setAttribute('contenteditable', 'true');\n        }\n\n        var editor = CKEDITOR.inline(node);\n\n        editor.config.allowedContent = this.get('allowedContent');\n\n        editor.config.toolbars = this.get('toolbars');\n\n        editor.config.removePlugins = this.get('removePlugins');\n        editor.config.extraPlugins = this.get('extraPlugins');\n        editor.config.placeholderClass = this.get('placeholderClass');\n\n        editor.config.pasteFromWordRemoveStyles = false;\n        editor.config.pasteFromWordRemoveFontStyles = false;\n\n        editor.config.selectionKeystrokes = this.get('selectionKeystrokes');\n\n        Lang.mix(editor.config, config);\n\n        if (CKEDITOR.env.ie && !CKEDITOR.env.edge) {\n            editor.config.extraPlugins = editor.config.extraPlugins.replace('ae_dragresize', 'ae_dragresize_ie');\n            editor.config.removePlugins = editor.config.removePlugins.replace('ae_dragresize', 'ae_dragresize_ie');\n        }\n\n        editor.once('contentDom', function() {\n\n            this._addReadOnlyLinkClickListener(editor);\n\n            var editable = editor.editable();\n\n            editable.addClass('ae-editable');\n\n        }.bind(this));\n\n        this._editor = editor;\n\n        AlloyEditor.loadLanguageResources(this._renderUI.bind(this));\n    },\n\n    /**\n     * Destructor lifecycle implementation for the AlloyEdtor class. Destroys the CKEditor\n     * instance and destroys all created toolbars.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method destructor\n     */\n    destructor: function() {\n        this._destroyed = true;\n\n        if (this._editorUIElement) {\n            ReactDOM.unmountComponentAtNode(this._editorUIElement);\n            this._editorUIElement.parentNode.removeChild(this._editorUIElement);\n        }\n\n        var nativeEditor = this.get('nativeEditor');\n\n        if (nativeEditor) {\n            var editable = nativeEditor.editable();\n\n            if (editable) {\n                editable.removeClass('ae-editable');\n\n                if (this.get('enableContentEditable')) {\n                    this.get('srcNode').setAttribute('contenteditable', 'false');\n                }\n            }\n\n            this._clearSelections();\n\n            nativeEditor.destroy();\n        }\n    },\n\n\n    /**\n     * Clear selections from window object\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _clearSelections\n     */\n    _clearSelections: function() {\n        var nativeEditor = this.get('nativeEditor');\n        var isMSSelection = typeof window.getSelection != 'function';\n\n        if (isMSSelection) {\n            nativeEditor.document.$.selection.empty();\n        } else {\n            nativeEditor.document.getWindow().$.getSelection().removeAllRanges();\n        }\n    },\n\n    /**\n     * Method to set default link behavior\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _addReadOnlyLinkClickListener\n     * @param {Object} editor\n     */\n    _addReadOnlyLinkClickListener: function(editor) {\n        editor.editable().on('click', this._defaultReadOnlyClickFn, this, {\n            editor: editor\n        });\n    },\n\n    /**\n     * Called on `click` event when the editor is in read only mode. Navigates to link's URL or opens\n     * the link in a new window.\n     *\n     * @memberof Core\n     * @instance\n     * @event readOnlyClick\n     * @protected\n     * @method _defaultReadOnlyClickFn\n     * @param {Object} event The fired `click` event payload\n     */\n    _defaultReadOnlyClickFn: function(event) {\n        var mouseEvent = event.data.$;\n        var hasCtrlKey = mouseEvent.ctrlKey || mouseEvent.metaKey;\n        var shouldOpen = this._editor.config.readOnly || hasCtrlKey;\n\n        mouseEvent.preventDefault();\n\n        if (!shouldOpen) {\n            return;\n        }\n\n        if (event.listenerData.editor.editable().editor.fire('readOnlyClick', event.data) !== false) {\n            var ckElement = new CKEDITOR.dom.elementPath(event.data.getTarget(), this);\n            var link = ckElement.lastElement;\n\n            if (link) {\n                var href = link.$.attributes.href ? link.$.attributes.href.value : null;\n                var target = hasCtrlKey ? '_blank' : link.$.attributes.target ? link.$.attributes.target.value : null;\n                this._redirectLink(href, target);\n            }\n        }\n    },\n\n    /**\n     * Retrieves the native CKEditor instance. Having this, the developer may use the API of CKEditor OOTB.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _getNativeEditor\n     * @return {Object} The current instance of CKEditor.\n     */\n    _getNativeEditor: function() {\n        return this._editor;\n    },\n\n    /**\n     * Redirects the browser to a given link\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _redirectLink\n     * @param {string} href The href to take the browser to\n     * @param {string=} target Specifies where to display the link\n     */\n    _redirectLink: function(href, target) {\n        if (target && href) {\n            window.open(href, target);\n        }\n        else if (href) {\n            window.location.href = href;\n        }\n    },\n\n    /**\n     * Renders the specified from the user toolbars.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _renderUI\n     */\n    _renderUI: function() {\n        if (!this._destroyed) {\n            var editorUIElement = document.createElement('div');\n            editorUIElement.className = 'ae-ui';\n\n            var uiNode = this.get('uiNode') || document.body;\n\n            uiNode.appendChild(editorUIElement);\n\n            this._mainUI = ReactDOM.render(<UI\n                editor={this}\n                eventsDelay={this.get('eventsDelay')}\n                toolbars={this.get('toolbars')} />, editorUIElement);\n\n            this._editorUIElement = editorUIElement;\n\n            this.get('nativeEditor').fire('uiReady');\n        }\n    },\n\n    /**\n     * The function returns an HTML element from the passed value. If the passed value is a string, it should be\n     * the Id of the element which have to be retrieved from the DOM.\n     * If an HTML Element is passed, the element itself will be returned.\n     *\n     * @memberof Core\n     * @instance\n     * @method _toElement\n     * @protected\n     * @param {!(String|HTMLElement)} value String, which have to correspond to an HTML element from the DOM,\n     * or the HTML element itself. If Id is passed, the HTML element will be retrieved from the DOM.\n     * @return {HTMLElement} An HTML element.\n     */\n    _toElement: function(value) {\n        if (Lang.isString(value)) {\n            value = document.getElementById(value);\n        }\n\n        return value;\n    },\n\n    /**\n     * Validates the allowed content attribute. Look\n     * [here](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-allowedContent) for more information about the\n     * supported values.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _validateAllowedContent\n     * @param {Any} The value to be checked\n     * @return {Boolean} True if the current value is valid configuration, false otherwise\n     */\n    _validateAllowedContent: function(value) {\n        return Lang.isString(value) || Lang.isObject(value) || Lang.isBoolean(value);\n    },\n\n    /**\n     * Validates the value of toolbars attribute\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _validateToolbars\n     * @param {Any} The value to be checked\n     * @return {Boolean} True if the current value is valid toolbars configuration, false otherwise\n     */\n    _validateToolbars: function(value) {\n        return Lang.isObject(value) || Lang.isNull(value);\n    }\n}, {\n    ATTRS: {\n        /**\n         * Configures the allowed content for the current instance of AlloyEditor.\n         * Look on the [official CKEditor API](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-allowedContent)\n         * for more information about the valid values.\n         *\n         * @memberof Core\n         * @instance\n         * @property allowedContent\n         * @default true\n         * @writeOnce\n         * @type {Boolean, String, Object}\n         */\n        allowedContent: {\n            validator: '_validateAllowedContent',\n            value: true,\n            writeOnce: true\n        },\n\n        /**\n         * Specifies whether AlloyEditor set the contenteditable attribute\n         * to \"true\" on its srcNode.\n         *\n         * @memberof Core\n         * @instance\n         * @property enableContentEditable\n         * @type Boolean\n         * @default true\n         * @writeOnce\n         */\n        enableContentEditable: {\n            validator: Lang.isBoolean,\n            value: true,\n            writeOnce: true\n        },\n\n        /**\n         * The delay (timeout), in ms, after which events such like key or mouse events will be processed.\n         *\n         * @memberof Core\n         * @instance\n         * @property eventsDelay\n         * @type {Number}\n         */\n        eventsDelay: {\n            validator: Lang.isNumber,\n            value: 100\n        },\n\n        /**\n         * Specifies the extra plugins which have to be loaded to the current CKEditor instance in order to\n         * make AlloyEditor to work properly.\n         *\n         * @memberof Core\n         * @instance\n         * @property extraPlugins\n         * @default 'uicore,selectionregion,dragresize,addimages,placeholder,tabletools,tableresize,autolink'\n         * @writeOnce\n         * @type {String}\n         */\n        extraPlugins: {\n            validator: Lang.isString,\n            value: 'ae_uicore,ae_selectionregion,ae_selectionkeystrokes,ae_imagealignment,ae_addimages,ae_placeholder,' +\n                'ae_tabletools,ae_tableresize,ae_autolink,ae_embed,ae_autolist,ae_dragresize,' +\n                'ae_uibridge',\n                //'ae_uibridge,ae_richcombobridge,ae_panelmenubuttonbridge,ae_menubridge,ae_menubuttonbridge,ae_buttonbridge',\n            writeOnce: true\n        },\n\n        /**\n         * Retrieves the native CKEditor instance. Having this, the developer may use the full API of CKEditor.\n         *\n         * @memberof Core\n         * @instance\n         * @property nativeEditor\n         * @readOnly\n         * @type {Object}\n         */\n        nativeEditor: {\n            getter: '_getNativeEditor',\n            readOnly: true\n        },\n\n        /**\n         * Specifies the class, which should be added by Placeholder plugin\n         * {{#crossLink \"CKEDITOR.plugins.ae_placeholder}}{{/crossLink}}\n         * when editor is not focused.\n         *\n         * @memberof Core\n         * @instance\n         * @property placeholderClass\n         * @default 'ae-placeholder'\n         * @writeOnce\n         * @type {String}\n         */\n        placeholderClass: {\n            validator: Lang.isString,\n            value: 'ae-placeholder',\n            writeOnce: true\n        },\n\n        /**\n         * Specifies the plugins, which come by default with CKEditor, but which are not needed by AlloyEditor.\n         * These plugins add the default UI for CKeditor, which is no more needed. Please note that AlloyEdtor\n         * comes with its own highly optimized copy of CKEditor (just customized via their official download page).\n         * This version does not come with the unneeded plugins, so the value of this property won't be needed.\n         * However, if you decide to go with the OOTB version of CKEditor, you will have to remove some of the\n         * plugins if you decide to use AlloyEditor. Keep in mind that removing these plugins doesn't remove them\n         * entirely from CKEditor. It just removes them from its current instance, in which you will use different\n         * UI - those of AlloyEditor. You will be fully able to use both OOTB CKEditor and AlloyEditor on the same\n         * page!\n         *\n         * @memberof Core\n         * @instance\n         * @property removePlugins\n         * @default 'contextmenu,toolbar,elementspath,resize,liststyle,link'\n         * @writeOnce\n         * @type {String}\n         */\n        removePlugins: {\n            validator: Lang.isString,\n            value: 'contextmenu,toolbar,elementspath,resize,liststyle,link',\n            writeOnce: true\n        },\n\n        /**\n         * Array of manual selection triggers. They can be configured to manually show a specific selection toolbar\n         * by forcing the selection type. A selectionKeystroke item consists of a keys property with a [CKEditor keystroke\n         * definition](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-keystrokes) and a selection property with\n         * the selection name to trigger.\n         *\n         * @memberof Core\n         * @instance\n         * @property selectionKeystrokes\n         * @type {Array}\n         */\n        selectionKeystrokes: {\n            validator: Lang.isArray,\n            value: [{\n                keys: CKEDITOR.CTRL + 76 /*L*/,\n                selection: 'link'\n            }, {\n                keys: CKEDITOR.CTRL + CKEDITOR.SHIFT + 76 /*L*/,\n                selection: 'embed'\n            }]\n        },\n\n        /**\n         * The Node ID or HTMl node, which AlloyEditor should use as an editable area.\n         *\n         * @memberof Core\n         * @instance\n         * @property srcNode\n         * @type String | Node\n         * @writeOnce\n         */\n        srcNode: {\n            setter: '_toElement',\n            writeOnce: true\n        },\n\n        /**\n         * The toolbars configuration for this editor instance\n         *\n         * @memberof Core\n         * @instance\n         * @property {Object} toolbars\n         */\n        toolbars: {\n            validator: '_validateToolbars',\n            value: {\n                add: {\n                    buttons: ['image', 'embed', 'camera', 'hline', 'table'],\n                    tabIndex: 2\n                },\n                styles: {\n                    selections: Selections,\n                    tabIndex: 1\n                }\n            }\n        },\n\n        /**\n         * The Node ID or HTMl node, where AlloyEditor's UI should be rendered.\n         *\n         * @memberof Core\n         * @instance\n         * @property uiNode\n         * @type String | Node\n         * @writeOnce\n         */\n        uiNode: {\n            setter: '_toElement',\n            writeOnce: true\n        }\n    }\n});\n\nCKEDITOR.event.implementOn(Core);\n\nexport default Core;\n","import Core from './core.js';\nimport Lang from '../oop/lang.js';\n\nimport Buttons from '../components/buttons';\nimport Toolbars from '../components/toolbars';\n\nimport SelectionTest from '../selections/selection-test.js';\n\n// An object containing all currently registered plugins in AlloyEditor.\nvar BRIDGE_BUTTONS = {};\n\n/**\n * Creates an instance of AlloyEditor.\n *\n * @memberof AlloyEditor\n * @method editable\n * @static\n * @param {String|Node} node The Node ID or HTMl node, which AlloyEditor should use as an editable area.\n * @param {Object} config Configuration attributes for the current instance of AlloyEditor.\n * @return {Object} An instance of {{#crossLink \"Core\"}}{{/crossLink}}\n */\nconst editable = function(node, config) {\n    config = config || {};\n    config.srcNode = node;\n\n    AlloyEditor.implementEventTarget();\n\n    return new Core(config);\n};\n\n/**\n * The full URL for the AlloyEditor installation directory.\n * It is possible to manually provide the base path by setting a\n * global variable named `ALLOYEDITOR_BASEPATH`. This global variable\n * must be set **before** the editor script loading.\n *\n * @memberof AlloyEditor\n * @method getBasePath\n * @static\n * @return {String} The found base path\n */\nconst getBasePath = function() {\n    // Find out the editor directory path, based on its <script> tag.\n    var path = window.ALLOYEDITOR_BASEPATH || '';\n\n    if (!path) {\n        var scripts = document.getElementsByTagName('script');\n\n        for (var i = 0; i < scripts.length; i++) {\n            var match = scripts[ i ].src.match(AlloyEditor.regexBasePath);\n\n\n            if (match) {\n                path = match[1];\n                break;\n            }\n        }\n    }\n\n    // In IE (only) the script.src string is the raw value entered in the\n    // HTML source. Other browsers return the full resolved URL instead.\n    if (path.indexOf(':/') === -1 && path.slice(0, 2) !== '//' ) {\n        // Absolute path.\n        if (path.indexOf('/') === 0) {\n            path = location.href.match(/^.*?:\\/\\/[^\\/]*/)[0] + path;\n        }\n        // Relative path.\n        else {\n            path = location.href.match(/^[^\\?]*\\/(?:)/)[0] + path;\n        }\n    }\n\n    if (!path){\n        throw 'The AlloyEditor installation path could not be automatically detected. Please set the global variable \"ALLOYEDITOR_BASEPATH\" before creating editor instances.';\n    }\n\n    return path;\n};\n\n/**\n * Detects and load the corresponding language file if AlloyEditor language strings are not already present.\n * The function fires a {{#crossLink \"AlloyEditor/languageResourcesLoaded:event\"}}{{/crossLink}} event\n *\n * @memberof AlloyEditor\n * @method loadLanguageResources\n * @static\n * @param {Function} callback Optional callback to be called when AlloyEditor loads the language resource.\n */\nconst loadLanguageResources = function(callback) {\n    AlloyEditor.implementEventTarget();\n\n    if (Lang.isFunction(callback)) {\n        if (AlloyEditor.Strings) {\n            setTimeout(callback, 0);\n        } else {\n            AlloyEditor.once('languageResourcesLoaded', function() {\n                setTimeout(callback, 0);\n            });\n        }\n    }\n\n    if (!AlloyEditor._langResourceRequested) {\n        AlloyEditor._langResourceRequested = true;\n\n        var languages = ['af', 'ar', 'bg', 'bn', 'bs', 'ca', 'cs', 'cy', 'da', 'de', 'el', 'en-au', 'en-ca', 'en-gb', 'en', 'eo', 'es', 'et', 'eu', 'fa', 'fi', 'fo', 'fr-ca', 'fr', 'gl', 'gu', 'he', 'hi', 'hr', 'hu', 'id', 'is', 'it', 'ja', 'ka', 'km', 'ko', 'ku', 'lt', 'lv', 'mk', 'mn', 'ms', 'nb', 'nl', 'no', 'pl', 'pt-br', 'pt', 'ro', 'ru', 'si', 'sk', 'sl', 'sq', 'sr-latn', 'sr', 'sv', 'th', 'tr', 'tt', 'ug', 'uk', 'vi', 'zh-cn', 'zh'];\n\n        var userLanguage = navigator.language || navigator.userLanguage || 'en';\n\n        var parts = userLanguage.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/);\n        var lang = parts[1];\n        var locale = parts[2];\n\n        if (languages.indexOf(lang + '-' + locale) >= 0) {\n            lang = lang + '-' + locale;\n        } else if (languages.indexOf(lang) === -1) {\n            lang = 'en';\n        }\n\n        CKEDITOR.scriptLoader.load(AlloyEditor.getUrl('lang/alloy-editor/' + lang + '.js'), function(loaded) {\n            if (loaded) {\n                AlloyEditor.fire('languageResourcesLoaded');\n            }\n        }, this);\n    }\n};\n\n/**\n * Gets the full URL for AlloyEditor resources. By default, URLs\n * returned by this function contain a querystring parameter (\"t\")\n * set to the {@link CKEDITOR#timestamp} value.\n *\n * @memberof AlloyEditor\n * @method getUrl\n * @static\n * @param {String} resource The resource whose full URL we want to get.\n * It may be a full, absolute, or relative URL.\n * @return {String} The full URL.\n */\nconst getUrl = function(resource) {\n    var basePath = AlloyEditor.getBasePath();\n\n    // If this is not a full or absolute path.\n    if (resource.indexOf(':/') === -1 && resource.indexOf('/') !== 0) {\n        resource = basePath + resource;\n    }\n\n    // Add the timestamp, except for directories.\n    if (CKEDITOR.timestamp && resource.charAt( resource.length - 1 ) !== '/' && !(/[&?]t=/).test(resource)) {\n        resource += (resource.indexOf('?') >= 0 ? '&' : '?') + 't=' + CKEDITOR.timestamp;\n    }\n\n    return resource;\n};\n\n/**\n * Implements event firing and subscribing via CKEDITOR.event.\n *\n * @memberof AlloyEditor\n * @method implementEventTarget\n * @static\n */\nconst implementEventTarget = function() {\n    if (!AlloyEditor.fire && !AlloyEditor.on) {\n        CKEDITOR.event.implementOn(AlloyEditor);\n    }\n};\n\n/**\n * Regular expression which should match the script which have been used to load AlloyEditor.\n *\n * @memberof AlloyEditor\n * @property regexBasePath\n * @type {RegExp}\n * @static\n */\nconst regexBasePath = /(^|.*[\\\\\\/])(?:alloy-editor[^/]+|alloy-editor)\\.js(?:\\?.*|;.*)?$/i;\n\n/**\n * Fired when AlloyEditor detects the browser language and loads the corresponding language file. Once this event\n * is fired, AlloyEditor.Strings will be populated with data.\n *\n * @event languageResourcesLoaded\n */\n\n/**\n * Returns the required plugin names needed for a given plugin\n * if it is already registered or an empty array.\n *\n * @memberof AlloyEditor\n * @method getButtons\n * @param {Array} buttons An array of buttons or plugin names.\n * @return {Function} A function that can be invoked to resolve the requested button names.\n * @static\n */\nconst getButtons = function(buttons) {\n    return function() {\n        return buttons.reduce(function(acc, val) {\n            val = BRIDGE_BUTTONS[val] || [val];\n            return acc.concat(val);\n        }, []);\n    };\n};\n\n/**\n * Register a button and try to get its required plugins.\n *\n * @memberof AlloyEditor\n * @method registerBridgeButton\n * @param {String} buttonName The name of the button.\n * @param {String} pluginName The name of the plugin that registers the button.\n * @static\n */\nconst registerBridgeButton = function(buttonName, pluginName) {\n    if (!BRIDGE_BUTTONS[pluginName]) {\n        BRIDGE_BUTTONS[pluginName] = [];\n    }\n\n    BRIDGE_BUTTONS[pluginName].push(buttonName);\n};\n\nexport {\n    Buttons,\n    editable,\n    getBasePath,\n    getButtons,\n    getUrl,\n    implementEventTarget,\n    loadLanguageResources,\n    registerBridgeButton,\n    SelectionTest,\n    Toolbars\n};\n"],"sourceRoot":""}