!function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var t={},i={editable:function(e,t){return t=t||{},t.srcNode=e,i.implementEventTarget(),new i.Core(t)},getBasePath:function(){var e=window.ALLOYEDITOR_BASEPATH||"";if(!e)for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var o=t[n].src.match(i.regexBasePath);if(o){e=o[1];break}}if(e.indexOf(":/")===-1&&"//"!==e.slice(0,2)&&(e=0===e.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+e:location.href.match(/^[^\?]*\/(?:)/)[0]+e),!e)throw'The AlloyEditor installation path could not be automatically detected. Please set the global variable "ALLOYEDITOR_BASEPATH" before creating editor instances.';return e},loadLanguageResources:function(e){if(i.implementEventTarget(),i.Lang.isFunction(e)&&(i.Strings?setTimeout(e,0):i.once("languageResourcesLoaded",function(){setTimeout(e,0)})),!i._langResourceRequested){i._langResourceRequested=!0;var t=["af","ar","bg","bn","bs","ca","cs","cy","da","de","el","en-au","en-ca","en-gb","en","eo","es","et","eu","fa","fi","fo","fr-ca","fr","gl","gu","he","hi","hr","hu","id","is","it","ja","ka","km","ko","ku","lt","lv","mk","mn","ms","nb","nl","no","pl","pt-br","pt","ro","ru","si","sk","sl","sq","sr-latn","sr","sv","th","tr","tt","ug","uk","vi","zh-cn","zh"],n=navigator.language||navigator.userLanguage||"en",o=n.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),a=o[1],r=o[2];t.indexOf(a+"-"+r)>=0?a=a+"-"+r:t.indexOf(a)===-1&&(a="en"),CKEDITOR.scriptLoader.load(i.getUrl("lang/alloy-editor/"+a+".js"),function(e){e&&i.fire("languageResourcesLoaded")},this)}},getUrl:function(e){var t=i.getBasePath();return e.indexOf(":/")===-1&&0!==e.indexOf("/")&&(e=t+e),CKEDITOR.timestamp&&"/"!==e.charAt(e.length-1)&&!/[&?]t=/.test(e)&&(e+=(e.indexOf("?")>=0?"&":"?")+"t="+CKEDITOR.timestamp),e},implementEventTarget:function(){i.fire||i.on||CKEDITOR.event.implementOn(i)},regexBasePath:/(^|.*[\\\/])(?:alloy-editor[^\/]+|alloy-editor)\.js(?:\?.*|;.*)?$/i,Buttons:{},Toolbars:{},getButtons:function(e){return function(){return e.reduce(function(e,i){return i=t[i]||[i],e.concat(i)},[])}},registerBridgeButton:function(e,i){t[i]||(t[i]=[]),t[i].push(e)}};"undefined"!=typeof module&&"object"===e(module.exports)&&(module.exports=i),"undefined"!=typeof window?window.AlloyEditor=i:"undefined"!=typeof global?global.AlloyEditor=i:"undefined"!=typeof self?self.AlloyEditor=i:this.AlloyEditor=i}();var t=function(){return(0,eval)("this").React}();"undefined"==typeof t&&(t=AlloyEditor.React);var i=function(){return(0,eval)("this").ReactDOM}();"undefined"==typeof t&&(i=AlloyEditor.ReactDOM);var n=function(){return(0,eval)("this").PropTypes||t.PropTypes}(),o=function(){return(0,eval)("this").createReactClass||t.createClass}();if("undefined"!=typeof window){!function(){CKEDITOR.tools.debounce=CKEDITOR.tools.debounce||function(e,t,i,n){var o,a=function(){var a=i||this;clearTimeout(o);for(var r=[],s=arguments.length,l=0;l<s;++l)r.push(arguments[l]);var d=r.concat(n||[]);o=setTimeout(function(){e.apply(a,d)},t)};return a.detach=function(){clearTimeout(o)},a}}();var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function t(e,t){this._editor=e,this.appendProtocol=!t||t.appendProtocol!==!1}var i=/^#.*/i,n=/^[a-z0-9\u0430-\u044F\._-]+@/i,o=/^(?:[a-z][a-z0-9+\-.]*)\:|^\//i;t.prototype={constructor:t,advanceSelection:function(e){e=e||this.getFromSelection();var t=this._editor.getSelection().getRanges()[0];if(e){t.moveToElementEditEnd(e);var i=t.getNextEditableNode();if(i&&!this._editor.element.equals(i.getCommonAncestor(e))){var n=/\s/.exec(i.getText()),o=n?n.index+1:0;t.setStart(i,o),t.setEnd(i,o)}}this._editor.getSelection().selectRanges([t])},create:function(e,t,i){var n=this._editor.getSelection(),o=n.getRanges()[0];if(o.collapsed){var a=new CKEDITOR.dom.text(e,this._editor.document);o.insertNode(a),o.selectNodeContents(a)}e=this._getCompleteURI(e);var r=CKEDITOR.tools.merge({"data-cke-saved-href":e,href:e},t),s=new CKEDITOR.style({attributes:r,element:"a"});s.type=CKEDITOR.STYLE_INLINE,s.applyToRange(o,this._editor),i&&i.advance?this.advanceSelection():o.select()},getFromSelection:function(){var e=this._editor.getSelection(),t=e.getSelectedElement();if(t&&t.is("a"))return t;if(t&&CKEDITOR.env.ie)for(var i=t.getChildren(),n=i.count(),o=0;o<n;o++){var a=i.getItem(o);if(a.is("a"))return a}var r=e.getRanges()[0];return r?(r.shrink(CKEDITOR.SHRINK_TEXT),this._editor.elementPath(r.getCommonAncestor()).contains("a",1)):null},remove:function(e,t){var i=this._editor;if(e)t&&t.advance&&this.advanceSelection(),e.remove(i);else{var n=new CKEDITOR.style({alwaysRemoveElement:1,element:"a",type:CKEDITOR.STYLE_INLINE}),o=i.getSelection();o.selectElement(o.getStartElement()),i.removeStyle(n)}},update:function(t,i,n){var o=this;if(i=i||this.getFromSelection(),"string"==typeof t){var a=o._getCompleteURI(t);i.setAttributes({"data-cke-saved-href":a,href:a})}else if("object"===("undefined"==typeof t?"undefined":e(t))){var r=[],s={};Object.keys(t).forEach(function(e){if(null===t[e])"href"===e&&r.push("data-cke-saved-href"),r.push(e);else if("href"===e){var i=o._getCompleteURI(t[e]);s["data-cke-saved-href"]=i,s[e]=i}else s[e]=t[e]}),i.removeAttributes(r),i.setAttributes(s)}n&&n.advance&&this.advanceSelection(i)},_getCompleteURI:function(e){return i.test(e)?e:(n.test(e)?e="mailto:"+e:o.test(e)||(e=this.appendProtocol?"http://"+e:e),e)}},CKEDITOR.Link=CKEDITOR.Link||t}(),function(){var e=function(e){var t=["beforeInit","init","afterInit"];t.forEach(function(t){e[t]&&(e[t]=CKEDITOR.tools.override(e[t],function(i){var n={phase:t,plugin:e};return function(e){e.__processingPlugin__=n,i.call(this,e),e.__processingPlugin__=null}}))})},t=function(e){return"string"==typeof e&&(e=e.split(",")),e.filter(function(e){return"toolbar"!==e})};CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,function(i){return function(n,o,a){i.call(this,n,function(i){o&&(Object.keys(i).forEach(function(n){var o=i[n];o.requires&&(o.requires=t(o.requires)),e(o)}),o.call(a,i))})}})}(),function(){function e(){}CKEDITOR.plugins.get("ae_selectionregion")||(CKEDITOR.SELECTION_TOP_TO_BOTTOM=0,CKEDITOR.SELECTION_BOTTOM_TO_TOP=1,CKEDITOR.SELECTION_LEFT_TO_RIGHT=2,CKEDITOR.SELECTION_RIGHT_TO_LEFT=3,e.prototype={constructor:e,createSelectionFromPoint:function(e,t){this.createSelectionFromRange(e,t,e,t)},createSelectionFromRange:function(e,t,i,n){var o,a,r,s,l,d,c;if("function"==typeof document.caretPositionFromPoint?(l=document.caretPositionFromPoint(e,t),o=document.caretPositionFromPoint(i,n),d=l.offsetNode,a=o.offsetNode,c=l.offset,r=o.offset,s=this.createRange()):"function"==typeof document.caretRangeFromPoint&&(l=document.caretRangeFromPoint(e,t),o=document.caretRangeFromPoint(i,n),d=l.startContainer,a=o.startContainer,c=l.startOffset,r=o.startOffset,s=this.createRange()),s&&document.getSelection)s.setStart(new CKEDITOR.dom.node(d),c),s.setEnd(new CKEDITOR.dom.node(a),r),this.getSelection().selectRanges([s]);else if("function"==typeof document.body.createTextRange){var u=this.getSelection();u.unlock(),s=document.body.createTextRange(),s.moveToPoint(e,t);var m=s.duplicate();m.moveToPoint(i,n),s.setEndPoint("EndToEnd",m),s.select(),this.getSelection().lock()}},getCaretRegion:function(){var e=this.getSelection(),t={bottom:0,left:0,right:0,top:0},i=e.createBookmarks();if(!i.length)return t;var n=i[0].startNode.$;n.style.display="inline-block",t=new CKEDITOR.dom.element(n).getClientRect(),n.parentNode.removeChild(n);var o=new CKEDITOR.dom.window(window).getScrollPosition();return t.bottom=o.y+t.bottom,t.left=o.x+t.left,t.right=o.x+t.right,t.top=o.y+t.top,t},getSelectionData:function(){var e=this.getSelection();if(!e.getNative())return null;var t={element:e.getSelectedElement(),text:e.getSelectedText()};return t.region=this.getSelectionRegion(e),t},getSelectionRegion:function(){var e=this.getClientRectsRegion();return e.direction=this.getSelectionDirection(),e.height=e.bottom-e.top,e.width=e.right-e.left,e},isSelectionEmpty:function(){var e,t=this.getSelection();return t.getType()===CKEDITOR.SELECTION_NONE||(e=t.getRanges())&&1===e.length&&e[0].collapsed},getClientRectsRegion:function(){var e=this.getSelection(),t=e.getNative(),i={bottom:0,height:0,left:0,right:0,top:0,width:0},n={bottom:0,endRect:i,left:0,right:0,top:0,startRect:i};if(!t)return n;var o,a,r=0,s=1/0,l=-(1/0),d=1/0;if(t.createRange?o=t.createRange().getClientRects():(a=t.rangeCount,o=t.rangeCount>0?t.getRangeAt(0).getClientRects():[]),0===o.length)n=this.getCaretRegion();else{for(var c=0,u=o.length;c<u;c++){var m=o[c];m.left<s&&(s=m.left),m.right>l&&(l=m.right),m.top<d&&(d=m.top),m.bottom>r&&(r=m.bottom)}var p=new CKEDITOR.dom.window(window).getScrollPosition();if(n.bottom=p.y+r,n.left=p.x+s,n.right=p.x+l,n.top=p.y+d,o.length){var g=o[o.length-1],h=o[0];n.endRect={bottom:p.y+g.bottom,height:g.height,left:p.x+g.left,right:p.x+g.right,top:p.y+g.top,width:g.width},n.startRect={bottom:p.y+h.bottom,height:h.height,left:p.x+h.left,right:p.x+h.right,top:p.y+h.top,width:h.width}}}return n},getSelectionDirection:function(){var e=CKEDITOR.SELECTION_TOP_TO_BOTTOM,t=this.getSelection(),i=t.getNative();if(!i)return e;var n;if((n=i.anchorNode)&&n.compareDocumentPosition){var o=n.compareDocumentPosition(i.focusNode);(!o&&i.anchorOffset>i.focusOffset||o===Node.DOCUMENT_POSITION_PRECEDING)&&(e=CKEDITOR.SELECTION_BOTTOM_TO_TOP)}return e}},CKEDITOR.plugins.add("ae_selectionregion",{init:function(t){var i,n;n=Object.prototype.hasOwnProperty;for(i in e.prototype)n.call(e.prototype,i)&&"undefined"==typeof t[i]&&(t[i]=e.prototype[i])}}))}(),function(){function e(e){this._editor=e}var t={table:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1};e.HEADING_BOTH="Both",e.HEADING_COL="Column",e.HEADING_NONE="None",e.HEADING_ROW="Row",e.prototype={constructor:e,create:function(e){var t=this._editor,i=this._createElement("table");e=e||{};for(var n=i.append(this._createElement("tbody")),o=e.rows||1,a=e.cols||1,r=0;r<o;r++)for(var s=n.append(this._createElement("tr")),l=0;l<a;l++){var d=s.append(this._createElement("td"));d.appendBogus()}this.setAttributes(i,e.attrs),this.setHeading(i,e.heading),t.insertElement(i);var c=new CKEDITOR.dom.element(i.$.rows[0].cells[0]),u=t.createRange();return u.moveToPosition(c,CKEDITOR.POSITION_AFTER_START),u.select(),i},getFromSelection:function(){var e,t=this._editor.getSelection(),i=t.getSelectedElement();if(i&&i.is("table"))e=i;else{var n=t.getRanges();n.length>0&&(CKEDITOR.env.webkit&&n[0].shrink(CKEDITOR.NODE_ELEMENT),e=this._editor.elementPath(n[0].getCommonAncestor(!0)).contains("table",1))}return e},isEditable:function(e){return CKEDITOR.env.ie&&e.is(t)?e.hasAttribute("contenteditable")?"false"!==e.getAttribute("contenteditable"):this.isEditable(e.getParent()):!e.isReadOnly()},getHeading:function(t){if(t=t||this.getFromSelection(),!t)return null;for(var i=null!==t.$.tHead,n=!0,o=0;o<t.$.rows.length;o++){var a=t.$.rows[o].cells[0];if(a&&"th"!==a.nodeName.toLowerCase()){n=!1;break}}var r=e.HEADING_NONE;return i&&(r=e.HEADING_ROW),n&&(r=r===e.HEADING_ROW?e.HEADING_BOTH:e.HEADING_COL),r},remove:function(e){var t=this._editor;if(e)e.remove();else if(e=t.elementPath().contains("table",1)){var i=e.getParent(),n=t.editable();1!==i.getChildCount()||i.is("td","th")||i.equals(n)||(e=i);var o=t.createRange();o.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START),e.remove(),o.select()}},setAttributes:function(e,t){t&&Object.keys(t).forEach(function(i){e.setAttribute(i,t[i])})},setHeading:function(t,i){t=t||this.getFromSelection();var n,o,a,r=t.getElementsByTag("tbody").getItem(0),s=this.getHeading(t),l=s===e.HEADING_COL||s===e.HEADING_BOTH,d=i===e.HEADING_COL||i===e.HEADING_BOTH,c=i===e.HEADING_ROW||i===e.HEADING_BOTH;if(!t.$.tHead&&c){var u=r.getElementsByTag("tr").getItem(0),m=u.getChildCount();for(n=0;n<m;n++){var p=u.getChild(n);p.type!==CKEDITOR.NODE_ELEMENT||p.data("cke-bookmark")||(p.renameNode("th"),p.setAttribute("scope","col"))}a=this._createElement(t.$.createTHead()),a.append(u.remove())}if(null!==t.$.tHead&&!c){a=this._createElement(t.$.tHead);for(var g=r.getFirst();a.getChildCount()>0;){var h=a.getFirst(),f=h.getChildCount();for(n=0;n<f;n++)o=h.getChild(n),o.type===CKEDITOR.NODE_ELEMENT&&(o.renameNode("td"),o.removeAttribute("scope"));h.insertBefore(g)}a.remove()}s=this.getHeading(t);var E=s===e.HEADING_COL||s===e.HEADING_BOTH;if(!E&&d)for(n=0;n<t.$.rows.length;n++)"th"!==t.$.rows[n].cells[0].nodeName.toLowerCase()&&(o=new CKEDITOR.dom.element(t.$.rows[n].cells[0]),o.renameNode("th"),o.setAttribute("scope","row"));if(l&&!d)for(n=0;n<t.$.rows.length;n++){var y=new CKEDITOR.dom.element(t.$.rows[n]);"tbody"===y.getParent().getName()&&(o=new CKEDITOR.dom.element(y.$.cells[0]),o.renameNode("td"),o.removeAttribute("scope"))}},_createElement:function(e){return new CKEDITOR.dom.element(e,this._editor.document)}},CKEDITOR.on("instanceReady",function(t){var i=[e.HEADING_NONE,e.HEADING_ROW,e.HEADING_COL,e.HEADING_BOTH],n=new e(t.editor);i.forEach(function(e){t.editor.addCommand("tableHeading"+e,{exec:function(t){n.setHeading(null,e)}})})}),CKEDITOR.Table=CKEDITOR.Table||e}(),function(){CKEDITOR.tools.jsonp=function(e,t,i,n){function o(){r&&(r.remove(),delete CKEDITOR._.jsonpCallbacks[a],r=null)}var a=CKEDITOR.tools.getNextNumber();t=t||{},t.callback="CKEDITOR._.jsonpCallbacks["+a+"]",CKEDITOR._.jsonpCallbacks||(CKEDITOR._.jsonpCallbacks={}),CKEDITOR._.jsonpCallbacks[a]=function(e){setTimeout(function(){o(),i(e)})};var r=new CKEDITOR.dom.element("script");return r.setAttribute("src",e.output(t)),r.on("error",function(){o(),n&&n()}),CKEDITOR.document.getBody().append(r),{cancel:o,id:a}},CKEDITOR.tools.merge=CKEDITOR.tools.merge||function(){for(var e={},t=0;t<arguments.length;++t){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},CKEDITOR.tools.simulate=function(e,t){var i=document.createEvent("Events");i.initEvent(t,!0,!1),e.dispatchEvent(i)}}(),function(){CKEDITOR.plugins.get("ae_uicore")||CKEDITOR.plugins.add("ae_uicore",{init:function(e){var t=[],i=this._createAriaElement(e.id),n=e.config.uicore?e.config.uicore.timeout:50,o=CKEDITOR.tools.debounce(function(i){if(t=[],"keyup"!==i.name||27!==i.data.$.keyCode||e.config.allowEsc){var n=e.getSelectionData();n&&e.fire("editorInteraction",{nativeEvent:i.data.$,selectionData:n})}},n),a=CKEDITOR.tools.debounce(function(e){i.innerHTML=t.join(". ")},n),r=CKEDITOR.tools.debounce(function(e){for(var t,i=document.querySelectorAll(".ae-ui"),n=0;n<i.length;n++)if(i[n].contains(e.data.$.relatedTarget)){t=!0;break}t||o(e)},n);e.on("ariaUpdate",function(e){t.push(e.data.message),a()}),e.once("contentDom",function(){var t=e.editable(),i=t.attachListener(t,"focus",function(e){i.removeListener(),t.attachListener(t,"keyup",o),t.attachListener(t,"mouseup",o),t.attachListener(t,"mouseleave",r),o(e)})}),e.on("destroy",function(e){i.parentNode.removeChild(i),o.detach()})},_createAriaElement:function(e){var t=document.createElement("div");return t.className="ae-sr-only",t.setAttribute("aria-live","polite"),t.setAttribute("role","status"),t.setAttribute("id",e+"LiveRegion"),document.body.appendChild(t),t}})}(),function(){var e=CKEDITOR.env.ie;CKEDITOR.plugins.get("ae_addimages")||CKEDITOR.plugins.add("ae_addimages",{init:function(e){e.once("contentDom",function(){var t=e.editable();t.attachListener(t,"dragenter",this._onDragEnter,this,{editor:e}),t.attachListener(t,"dragover",this._onDragOver,this,{editor:e}),t.attachListener(t,"drop",this._onDragDrop,this,{editor:e}),t.attachListener(t,"paste",this._onPaste,this,{editor:e})}.bind(this))},_handleFiles:function(e,t){var i,n,o=[];for(n=0;n<e.length;n++)i=e[n],0===i.type.indexOf("image")&&o.push(i);var a=t.fire("beforeImageAdd",{imageFiles:o});if(a)for(n=0;n<o.length;n++)i=o[n],this._processFile(i,t);return!1},_onDragDrop:function(e){var t=e.data.$,i=t.dataTransfer.files;if(i.length>0){new CKEDITOR.dom.event(t).preventDefault();var n=e.listenerData.editor;e.listenerData.editor.createSelectionFromPoint(t.clientX,t.clientY),this._handleFiles(i,n)}},_onDragEnter:function(t){e&&this._preventEvent(t)},_onDragOver:function(t){e&&this._preventEvent(t)},_onPaste:function(e){if(e.data&&e.data.$&&e.data.$.clipboardData&&e.data.$.clipboardData.items&&e.data.$.clipboardData.items.length>0){var t=e.data.$.clipboardData.items[0];if(0===t.type.indexOf("image")){var i=t.getAsFile();this._processFile(i,e.listenerData.editor)}}},_preventEvent:function(e){e=new CKEDITOR.dom.event(e.data.$),e.preventDefault(),e.stopPropagation()},_processFile:function(e,t){var i=new FileReader;i.addEventListener("loadend",function(){var n=i.result,o=CKEDITOR.dom.element.createFromHtml('<img src="'+n+'">');t.insertElement(o);var a={el:o,file:e};t.fire("imageAdd",a)}),i.readAsDataURL(e)}})}(),function(){if(!CKEDITOR.plugins.get("ae_autolink")){/MSIE ([^;]*)|Trident.*; rv:([0-9.]+)/.test(navigator.userAgent)&&document.execCommand("AutoUrlDetect",!1,!1);var e=8,t=188,i=13,n=186,o=32,a=[t,i,n,o],r=/[^\s]+/gim,s="((([A - Za - z]{ 3, 9}: (?: \\/\\/)?)(?:[-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9.-]+|(https?\\:\\/\\/|www.|[-;:&=.\\+\\$,\\w]+@)[A-Za-z0-9.-]+)((?:\\/[\\+~%\\/.\\w-_]*)?\\??(?:[-\\+=&;%@.\\w_]*)#?(?:[\\w]*))((.*):(\\d*)\\/?(.*))?)",l=/[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/i;CKEDITOR.plugins.add("ae_autolink",{init:function(e){e.once("contentDom",function(){var t=e.editable();t.attachListener(t,"keyup",this._onKeyUp,this,{editor:e})}.bind(this)),e.on("paste",function(e){if("paste"===e.data.method){if(e.data.dataValue.indexOf("<")>-1||e.data.dataValue.indexOf("&lt;")>-1)return void(e.data.dataValue.indexOf('<u><font color="')>-1&&(e.data.dataValue=e.data.dataValue.replace(/<u><font color=\"#(.*?)\">|<\/font><\/u>/g,"")));var t=this;e.data.dataValue=e.data.dataValue.replace(RegExp(s,"gim"),function(e){if(t._isValidURL(e))return t._isValidEmail(e)?'<a href="mailto:'+e+'">'+e+"</a>":'<a href="'+e+'">'+e+"</a>"})}}.bind(this))},_getLastWord:function(e){var t=e.getSelection().getRanges()[0],n=t.startOffset,o="";if(this._currentKeyCode===i){var a,s=t.startContainer.getPrevious();if(s){for(;!s.getLast;)s=s.getPrevious();for(a=s.getLast();a&&!a.getText();)a=a.getPrevious()}a&&a.$.href||(this._startContainer=a,o=a?a.getText():"",this._offset=o.length)}else this._startContainer=t.startContainer,o=this._startContainer.getText().substring(0,n-1),this._offset=n-1;var l="",d=o.match(r);return d&&(l=d.pop()),l},_isValidEmail:function(e){return l.test(e)},_isValidURL:function(e){return RegExp(s,"i").test(e)},_onKeyDown:function(t){var i=t.data.$,n=t.listenerData.editor,o=n.editable();o.removeListener("keydown",this._onKeyDown),i.keyCode===e&&(t.cancel(),t.data.preventDefault(),this._removeLink(n)),this._ckLink=null},_onKeyUp:function(e){var t=e.data.$;if(this._currentKeyCode=t.keyCode,a.indexOf(this._currentKeyCode)!==-1){var i=e.listenerData.editor,n=this._getLastWord(i);this._isValidURL(n)&&this._replaceContentByLink(i,n)}},_replaceContentByLink:function(e,t){var n=e.createRange(),o=CKEDITOR.dom.element.get(this._startContainer),a=this._offset;n.setStart(o,a-t.length),n.setEnd(o,a),n.select();var r=new CKEDITOR.Link(e);r.create(t),this._ckLink=r;var s=r.getFromSelection();if(e.fire("autolinkAdd",s),this._subscribeToKeyEvent(e),n=e.getSelection().getRanges()[0],this._currentKeyCode===i){var l=n.getNextEditableNode();n.setStart(l,0),n.setEnd(l,0)}else{var d=n.getNextNode();n.setStart(d,1),n.setEnd(d,1)}n.select()},_removeLink:function(e){var t=e.getSelection().getRanges()[0],i=t.startOffset,n=this._startContainer.getNext()||this._startContainer,o=e.createRange();o.setStart(n,0),o.setEndAfter(n),o.select(),this._ckLink.remove(),t.setEnd(t.startContainer,i),t.setStart(t.startContainer,i),t.select()},_subscribeToKeyEvent:function(e){var t=e.editable();t.attachListener(t,"keydown",this._onKeyDown,this,{editor:e},1)}})}}(),function(){if(!CKEDITOR.plugins.get("ae_autolist")){var e=8,t=32,i=[{regex:/^\*$/,type:"bulletedlist"},{regex:/^1\.$/,type:"numberedlist"}];CKEDITOR.plugins.add("ae_autolist",{init:function(e){e.once("contentDom",function(){var t=e.editable();t.attachListener(t,"keydown",this._onKeyDown,this,{editor:e})}.bind(this))},_checkForBackspaceAndUndo:function(t){var i=t.listenerData.editor,n=t.data.$,o=i.editable();o.removeListener("keydown",this._checkForBackspaceAndUndo),n.keyCode===e&&(i.execCommand("undo"),i.insertHtml(t.listenerData.bullet+"&nbsp;"),t.data.preventDefault())},_getListConfig:function(e){for(var t=e.config.autolist||i,n=e.getSelection().getRanges()[0],o=n.endContainer.getText(),a=o.substring(0,n.startOffset),r=o.substring(n.startOffset,o.length),s=0,l=t.length,d=null;!d&&l>s;){var c=t[s];if(c.regex.test(a)){d={bullet:a,editor:e,text:r,type:c.type};break}s++}return d},_createList:function(e){var t=e.editor,i=t.getSelection().getRanges()[0];i.endContainer.setText(e.text),t.execCommand(e.type);var n=t.editable();n.attachListener(n,"keydown",this._checkForBackspaceAndUndo,this,{editor:t,bullet:e.bullet},1)},_onKeyDown:function(e){var i=e.data.$;if(i.keyCode===t){var n=this._getListConfig(e.listenerData.editor);n&&(e.data.preventDefault(),this._createList(n))}}})}}(),function(){function e(e){function i(){var t=e.getSelection();t&&(t.getType()!==CKEDITOR.SELECTION_NONE&&t.getStartElement().is("img")?n.event&&n.event.button&&0!==n.event.button||r.show(t.getStartElement().$):r.hide())}var n=e.window.$,o=e.document.$;u&&o.execCommand("enableObjectResizing",!1,!1);var a="undefined"==typeof c?null:c;e.config.imageScaleResize=e.config.imageScaleResize||"both";var r=new t(e,{imageScaleResize:e.config.imageScaleResize,snapToSize:a}),s=function(e){r.isHandle(e.target)&&r.initDrag(e)};o.addEventListener("mousedown",s,!1),e.on("selectionChange",i),e.on("getData",function(e){var t=e.data.dataValue||"";t=t.replace(/<div id="ckimgrsz"([\s\S]*?)<\/div>/i,""),t=t.replace(/\b(ckimgrsz)\b/g,""),e.data.dataValue=t}),e.on("beforeUndoImage",function(){r.hide()}),e.on("afterUndoImage",function(){i()}),e.on("blur",function(){r.hide()}),e.on("beforeModeUnload",function t(){e.removeListener("beforeModeUnload",t),r.hide()}),e.on("destroy",function(){var e=o.getElementById("ckimgrsz");e&&e.remove(),u&&o.execCommand("enableObjectResizing",!1,!0),o.removeEventListener("mousedown",s)});var l;e.window.on("resize",function(){clearTimeout(l),l=setTimeout(i,50)})}function t(e,t){this.editor=e,this.window=e.window.$,this.document=e.document.$,this.cfg=t||{},this.init()}function i(e,t){this.window=e,this.document=t,this.events={mousemove:o(this.mousemove,this),keydown:o(this.keydown,this),mouseup:o(this.mouseup,this)}}function n(e){for(var t=e.length,i=new Array(t),n=0;n<t;n++)i[n]=e[n];return i}function o(e,t){return e.bind?e.bind(t):function(){e.apply(t,arguments)}}function a(e,t,i){e.style.left=String(t)+"px",e.style.top=String(i)+"px"}function r(e,t,i){var n=this.editor.config.imageScaleResize;"both"===n?(e.style.width=String(t)+"px",e.style.height=String(i)+"px"):"width"===n||"scale"===n?(e.style.height="auto",e.style.width=String(t)+"px"):"height"===n&&(e.style.height=String(i)+"px",e.style.width="auto")}function s(e,t){var i=t.getBoundingClientRect();return{left:i.left+e.pageXOffset,top:i.top+e.pageYOffset,width:i.width,height:i.height}}if(!CKEDITOR.plugins.get("ae_dragresize")){var l={both:["tl","tm","tr","lm","rm","bl","bm","br"],height:["tl","tm","tr","bl","bm","br"],scale:["tl","tr","bl","br"],width:["tl","tr","lm","rm","bl","br"]},d={bl:function(e,t,i,n){a(e,-3+t,n.height-4+i)},bm:function(e,t,i,n){a(e,Math.round(n.width/2)-3+t,n.height-4+i)},br:function(e,t,i,n){a(e,n.width-4+t,n.height-4+i)},lm:function(e,t,i,n){a(e,-3+t,Math.round(n.height/2)-3+i)},tl:function(e,t,i,n){a(e,t-3,i-3)},tm:function(e,t,i,n){a(e,Math.round(n.width/2)-3+t,-3+i)},tr:function(e,t,i,n){a(e,n.width-4+t,-3+i)},rm:function(e,t,i,n){a(e,n.width-4+t,Math.round(n.height/2)-3+i)}},c=7,u="MozAppearance"in document.documentElement.style,m="WebkitAppearance"in document.documentElement.style,p=m||u;p&&CKEDITOR.addCss("img::selection{color:rgba(0,0,0,0)}img.ckimgrsz{outline:1px dashed #000}#ckimgrsz{position:absolute;width:0;height:0;cursor:default;z-index:10001}#ckimgrsz span{display:none;position:absolute;top:0;left:0;width:0;height:0;background-size:100% 100%;opacity:.65;outline:1px dashed #000}#ckimgrsz i{position:absolute;display:block;width:5px;height:5px;background:#fff;border:1px solid #000}#ckimgrsz i.active,#ckimgrsz i:hover{background:#000}#ckimgrsz i.br,#ckimgrsz i.tl{cursor:nwse-resize}#ckimgrsz i.bm,#ckimgrsz i.tm{cursor:ns-resize}#ckimgrsz i.bl,#ckimgrsz i.tr{cursor:nesw-resize}#ckimgrsz i.lm,#ckimgrsz i.rm{cursor:ew-resize}body.dragging-br,body.dragging-br *,body.dragging-tl,body.dragging-tl *{cursor:nwse-resize!important}body.dragging-bm,body.dragging-bm *,body.dragging-tm,body.dragging-tm *{cursor:ns-resize!important}body.dragging-bl,body.dragging-bl *,body.dragging-tr,body.dragging-tr *{cursor:nesw-resize!important}body.dragging-lm,body.dragging-lm *,body.dragging-rm,body.dragging-rm *{cursor:ew-resize!important}"),CKEDITOR.plugins.add("ae_dragresize",{onLoad:function(){},init:function(t){p&&t.once("contentDom",function(i){e(t)})}}),t.prototype={init:function(){var e=this,t=this.container=this.document.createElement("div");t.id="ckimgrsz",this.preview=this.document.createElement("span"),t.appendChild(this.preview);var i=this.handles={};l[this.cfg.imageScaleResize].forEach(function(t,n){i[t]=e.handles[t]=e.createHandle(t)});for(var n in i)t.appendChild(i[n])},createHandle:function(e){var t=this.document.createElement("i");return t.classList.add(e),t},isHandle:function(e){var t=this.handles;for(var i in t)if(t[i]===e)return!0;return!1},show:function(e){var t=this.editor.config.uiNode,i=t?t.scrollTop:0;this.el=e,this.cfg.snapToSize&&(this.otherImages=n(this.document.getElementsByTagName("img")),this.otherImages.splice(this.otherImages.indexOf(e),1));var o=this.box=s(this.window,e);a(this.container,o.left,o.top+i),t=t||document.body,t.appendChild(this.container),this.el.classList.add("ckimgrsz"),this.showHandles()},hide:function(){for(var e=this.document.getElementsByClassName("ckimgrsz"),t=0;t<e.length;++t)e[t].classList.remove("ckimgrsz");this.hideHandles(),this.container.parentNode&&this.container.parentNode.removeChild(this.container)},initDrag:function(e){if(0===e.button){var t=this,n=new i(this.window,this.document);n.onStart=function(){t.showPreview(),t.isDragging=!0,t.editor.getSelection().lock()},n.onDrag=function(){t.calculateSize(this),t.updatePreview();var e=t.previewBox;t.updateHandles(e,e.left,e.top)},n.onRelease=function(){t.isDragging=!1,t.hidePreview(),t.hide(),t.editor.getSelection().unlock(),t.editor.fire("saveSnapshot")},n.onComplete=function(){t.resizeComplete(),t.editor.fire("saveSnapshot")},n.start(e)}},updateHandles:function(e,t,i){t=t||0,i=i||0;var n=this.handles;for(var o in n)d[o](n[o],t,i,e)},showHandles:function(){var e=this.handles;this.updateHandles(this.box);for(var t in e)e[t].style.display="block"},hideHandles:function(){var e=this.handles;for(var t in e)e[t].style.display="none"},showPreview:function(){this.preview.style.backgroundImage='url("'+this.el.src+'")',this.calculateSize(),this.updatePreview(),this.preview.style.display="block"},updatePreview:function(){var e=this.previewBox;a(this.preview,e.left,e.top),this.preview.style.width=this.previewBox.width+"px",this.preview.style.height=this.previewBox.height+"px"},hidePreview:function(){var e=s(this.window,this.preview);this.result={width:e.width,height:e.height},this.preview.style.display="none"},calculateSize:function(e){var t=this.previewBox={top:0,left:0,width:this.box.width,height:this.box.height};if(e){var i=e.target.className;if(~i.indexOf("r")&&(t.width=Math.max(32,this.box.width+e.delta.x)),~i.indexOf("b")&&(t.height=Math.max(32,this.box.height+e.delta.y)),~i.indexOf("l")&&(t.width=Math.max(32,this.box.width-e.delta.x)),~i.indexOf("t")&&(t.height=Math.max(32,this.box.height-e.delta.y)),i.indexOf("m")<0&&!e.keys.shift){var n=this.box.width/this.box.height;t.width/t.height>n?t.height=Math.round(t.width/n):t.width=Math.round(t.height*n)}var o=this.cfg.snapToSize;if(o)for(var a=this.otherImages,r=0;r<a.length;r++){var l=s(this.window,a[r]);if(Math.abs(t.width-l.width)<=o&&Math.abs(t.height-l.height)<=o){t.width=l.width,t.height=l.height;break}}~i.indexOf("l")&&(t.left=this.box.width-t.width),~i.indexOf("t")&&(t.top=this.box.height-t.height)}},resizeComplete:function(){r.call(this,this.el,this.result.width,this.result.height)}},i.prototype={start:function(e){e.preventDefault(),e.stopPropagation(),this.target=e.target,this.attr=e.target.className,this.startPos={x:e.clientX,y:e.clientY},this.update(e);var t=this.events;this.document.addEventListener("mousemove",t.mousemove,!1),this.document.addEventListener("keydown",t.keydown,!1),this.document.addEventListener("mouseup",t.mouseup,!1),this.document.body.classList.add("dragging-"+this.attr),this.onStart&&this.onStart()},update:function(e){this.currentPos={x:e.clientX,y:e.clientY},this.delta={x:e.clientX-this.startPos.x,y:e.clientY-this.startPos.y},this.keys={shift:e.shiftKey,ctrl:e.ctrlKey,alt:e.altKey}},mousemove:function(e){this.update(e),this.onDrag&&this.onDrag(),0===e.which&&this.mouseup(e)},keydown:function(e){27===e.keyCode&&this.release()},mouseup:function(e){this.update(e),this.release(),this.onComplete&&this.onComplete()},release:function(){this.document.body.classList.remove("dragging-"+this.attr);var e=this.events;this.document.removeEventListener("mousemove",e.mousemove,!1),this.document.removeEventListener("keydown",e.keydown,!1),this.document.removeEventListener("mouseup",e.mouseup,!1),this.onRelease&&this.onRelease()}}}}(),function(){function e(e){e.config.imageScaleResize=e.config.imageScaleResize||"both",e.on("imageAdd",function(t){e.widgets.initOn(t.data.el,"image")});var n=e.config.image2_alignClasses,o=e.config.image2_captionedClass;return{init:function(){var t=CKEDITOR.plugins.image2,i=this.parts.image,o={alt:i.getAttribute("alt")||"",hasCaption:!!this.parts.caption,height:i.getAttribute("height")||"",lock:!this.ready||t.checkHasNaturalRatio(i),src:i.getAttribute("src"),width:i.getAttribute("width")||""},a=i.getAscendant("a");if(a&&this.wrapper.contains(a)&&(this.parts.link=a),!o.align){var s=o.hasCaption?this.element:i;n?(s.hasClass(n[0])?o.align="left":s.hasClass(n[2])&&(o.align="right"),o.align?s.removeClass(n[c[o.align]]):o.align="none"):(o.align=s.getStyle("float")||"none",s.removeStyle("float"))}this.wrapper[(o.hasCaption?"remove":"add")+"Class"]("cke_image_nocaption"),this.setData(o),e.config.image2_disableResizer!==!0&&r(this)},addClass:function(e){d(this).addClass(e)},allowedContent:s(e),contentTransformations:[["img[width]: sizeToAttribute"]],data:function(){var t=this.features;if(this.data.hasCaption&&!e.filter.checkFeature(t.caption)&&(this.data.hasCaption=!1),"none"==this.data.align||e.filter.checkFeature(t.align)||(this.data.align="none"),this.data.link?this.parts.link||(this.parts.link=this.parts.image.getParent()):this.parts.link&&delete this.parts.link,this.parts.image.setAttributes({alt:this.data.alt,contenteditable:!this.parts.image.getAttribute("contenteditable")||this.parts.image.getAttribute("contenteditable"),"data-cke-saved-src":this.data.src,src:this.data.src}),this.oldData&&!this.oldData.hasCaption&&this.data.hasCaption)for(var i in this.data.classes)this.parts.image.removeClass(i);e.filter.checkFeature(t.dimension)&&a(this),this.oldData=CKEDITOR.tools.extend({},this.data)},downcast:i(e),draggable:!1,editables:{caption:{selector:"figcaption",allowedContent:"br em strong sub sup u s; a[!href,target]"}},features:l(e),getClasses:function(){
var e=new RegExp("^("+[].concat(o,n).join("|")+")$");return function(){var t=this.repository.parseElementClasses(d(this).getAttribute("class"));for(var i in t)e.test(i)&&delete t[i];return t}}(),getLabel:function(){var e=(this.data.alt||"")+" "+this.pathName;return e},hasClass:function(e){return d(this).hasClass(e)},parts:{caption:"figcaption",image:"img"},removeClass:function(e){d(this).removeClass(e)},requiredContent:"img[src,alt]",styleableElements:"img figure",template:p,upcast:t(e)}}function t(e){var t=n(e),i=e.config.image2_captionedClass;return function(e,n){var a,r={height:1,width:1},s=e.name;if(!e.attributes["data-cke-realelement"]){if(t(e)){if("div"==s){var l=e.getFirst("figure");l&&(e.replaceWith(l),e=l)}n.align="center",a=e.getFirst("img")||e.getFirst("a").getFirst("img")}else"figure"==s&&e.hasClass(i)?a=e.getFirst("img")||e.getFirst("a").getFirst("img"):o(e)&&(a="a"==e.name?e.children[0]:e);if(a){for(var d in r){var c=a.attributes[d];c&&c.match(m)&&delete a.attributes[d]}return e}}}}function i(e){var t=e.config.image2_alignClasses;return function(e){var i="a"==e.name?e.getFirst():e;delete i.attributes.contenteditable;var n=i.attributes,o=this.data.align;if(!this.inline){var a=e.getFirst("span");a&&a.replaceWith(a.getFirst({a:1,img:1}))}if(o&&"none"!=o){var r=CKEDITOR.tools.parseCssText(n.style||"");"center"==o&&"figure"==e.name?e=e.wrapWith(new CKEDITOR.htmlParser.element("div",t?{class:t[1]}:{style:"text-align:center"})):o in{left:1,right:1}&&(t?i.addClass(t[c[o]]):r.float=o),t||CKEDITOR.tools.isEmpty(r)||(n.style=CKEDITOR.tools.writeCssText(r))}return e}}function n(e){var t=e.config.image2_captionedClass,i=e.config.image2_alignClasses,n={a:1,figure:1,img:1};return function(a){if(!(a.name in{div:1,p:1}))return!1;var r=a.children;if(1!==r.length)return!1;var s=r[0];if(!(s.name in n))return!1;if("p"==a.name){if(!o(s))return!1}else if("figure"==s.name){if(!s.hasClass(t))return!1}else{if(e.enterMode==CKEDITOR.ENTER_P)return!1;if(!o(s))return!1}return!(i?!a.hasClass(i[1]):"center"!=CKEDITOR.tools.parseCssText(a.attributes.style||"",!0)["text-align"])}}function o(e){return"img"==e.name||"a"==e.name&&(1==e.children.length&&e.getFirst("img"))}function a(e){var t=e.data,i={height:t.height,width:t.width},n=e.parts.image;for(var o in i)i[o]?n.setAttribute(o,i[o]):n.removeAttribute(o)}function r(e){var t=e.editor,i=t.editable(),n=t.document,o=e.resizer=n.createElement("span");if(o.addClass("cke_image_resizer"),o.addClass("cke_image_resizer_"+u[t.config.imageScaleResize]),o.append(new CKEDITOR.dom.text("​",n)),e.inline)e.wrapper.append(o);else{var a=e.parts.link||e.parts.image,r=a.getParent(),s=n.createElement("span");s.addClass("cke_image_resizer_wrapper"),s.append(a),s.append(o),e.element.append(s,!0),r.is("span")&&r.remove()}o.on("mousedown",function(a){function r(e,t,i){var o=CKEDITOR.document,a=[];if(n.equals(o)||a.push(o.on(e,t)),a.push(n.on(e,t)),i)for(var r=a.length;r--;)i.push(a.pop())}function s(e){var i=t.config.imageScaleResize;d=e.data.$,p=d.screenX-y,g=v-d.screenY,h=Math.abs(p/g),"width"!==i&&"both"!==i&&"scale"!==i||(c=b+E*p),"height"!==i&&"both"!==i||(u=C-g),"scale"===i&&(u="auto"),c=c||b,u=u||C,c>=15&&(u>=15||"auto"===u)?(f.$.style.width=c+"px",f.$.style.height=u+"px",m=!0):m=!1}function l(){for(var n;n=_.pop();)n.removeListener();i.removeClass(T),o.removeClass("cke_image_resizing"),m&&(e.setData({height:u,width:c}),t.fire("saveSnapshot")),m=!1}var d,c,u,m,p,g,h,f=e.parts.image,E="right"==e.data.align?-1:1,y=a.data.$.screenX,v=a.data.$.screenY,b=f.$.clientWidth,C=f.$.clientHeight,_=[],T="cke_image_s"+(~E?"e":"w");t.fire("saveSnapshot"),r("mousemove",s,_),r("mouseup",l,_),i.addClass(T),o.addClass("cke_image_resizing")}),e.on("data",function(){o["right"==e.data.align?"addClass":"removeClass"]("cke_image_resizer_left")}),e.parts.image.on("click",function(){var e=t.getSelection();if(e){var i=e.getStartElement();if(i){var n=i.findOne("img");if(n){var o=i.getClientRect(),a=new CKEDITOR.dom.window(window).getScrollPosition();o.left-=a.x,o.top+=a.y,o.direction=CKEDITOR.SELECTION_BOTTOM_TO_TOP,t.fire("editorInteraction",{nativeEvent:event,selectionData:{element:n,region:o}})}}}})}function s(e){var t={figcaption:!0,figure:{classes:"!"+e.config.image2_captionedClass},img:{attributes:"!src,alt,width,height"}};return t}function l(e){var t=e.config.image2_alignClasses,i={align:{requiredContent:"img"+(t?"("+t[0]+")":"{float}")},caption:{requiredContent:"figcaption"},dimension:{requiredContent:"img[width,height]"}};return i}function d(e){return e.data.hasCaption?e.element:e.parts.image}if(!CKEDITOR.plugins.get("ae_dragresize_ie")){var c={center:1,left:0,right:2},u={both:"nwse-resize",height:"ns-resize",scale:"nwse-resize",width:"ew-resize"},m=/^\s*(\d+\%)\s*$/i,p='<img alt="" src="" />';CKEDITOR.plugins.add("ae_dragresize_ie",{hidpi:!0,icons:"image",init:function(t){var i=e(t);t.widgets.add("image",i)},onLoad:function(){CKEDITOR.addCss(".cke_image_resizer_nwse-resize{cursor: nwse-resize;}.cke_image_resizer_ns-resize{cursor: ns-resize;}.cke_image_resizer_nwse-resize{cursor: nwse-resize;}.cke_image_resizer_ew-resize{cursor: ew-resize;}.cke_image_nocaption{line-height:0}.cke_image_resizer{display:none;position:absolute;width:10px;height:10px;bottom:-5px;right:-5px;background:#000;outline:1px solid #fff;line-height:0;cursor:nwse-resize;}.cke_image_resizer_wrapper{position:relative;display:inline-block;line-height:0;}.cke_widget_wrapper:hover .cke_image_resizer,.cke_image_resizer.cke_image_resizing{display:block}")},requires:"widget"}),CKEDITOR.plugins.image2={checkHasNaturalRatio:function(e){var t=e.$,i=this.getNatural(e);return Math.round(t.clientWidth/i.width*i.height)==t.clientHeight||Math.round(t.clientHeight/i.height*i.width)==t.clientWidth},getNatural:function(e){var t;if(e.$.naturalWidth)t={height:e.$.naturalHeigh,width:e.$.naturalWidth};else{var i=new Image;i.src=e.getAttribute("src"),t={height:i.heigh,width:i.width}}return t}}}}(),CKEDITOR.config.image2_captionedClass="image",function(){function e(e){function o(){this.deflated||(e.widgets.focused==this.widget&&(this.focused=!0),e.widgets.destroy(this.widget),this.deflated=!0)}function a(){var i=e.editable(),n=e.document;if(this.deflated){if(this.widget=e.widgets.initOn(this.element,"image",this.widget.data),this.widget.inline&&!new CKEDITOR.dom.elementPath(this.widget.wrapper,i).block){var o=n.createElement(e.activeEnterMode==CKEDITOR.ENTER_P?"p":"div");o.replace(this.widget.wrapper),this.widget.wrapper.move(o)}this.focused&&(this.widget.focus(),delete this.focused),delete this.deflated}else t(this.widget,l)}var l=e.config.ae_dragresize_ie11_alignClasses,d=e.config.ae_dragresize_ie11_captionedClass;return{allowedContent:c(e),requiredContent:"img[src,alt]",features:u(e),styleableElements:"img figure",contentTransformations:[["img[width]: sizeToAttribute"]],editables:{caption:{selector:"figcaption",allowedContent:"br em strong sub sup u s; a[!href,target]"}},parts:{image:"img",caption:"figcaption"},template:p,data:function(){var t=this.features;if(this.data.hasCaption&&!e.filter.checkFeature(t.caption)&&(this.data.hasCaption=!1),"none"==this.data.align||e.filter.checkFeature(t.align)||(this.data.align="none"),this.shiftState({widget:this,element:this.element,oldData:this.oldData,newData:this.data,deflate:o,inflate:a}),this.data.link?this.parts.link||(this.parts.link=this.parts.image.getParent()):this.parts.link&&delete this.parts.link,this.parts.image.setAttributes({src:this.data.src,"data-cke-saved-src":this.data.src,alt:this.data.alt}),this.oldData&&!this.oldData.hasCaption&&this.data.hasCaption)for(var i in this.data.classes)this.parts.image.removeClass(i);e.filter.checkFeature(t.dimension)&&r(this),this.oldData=CKEDITOR.tools.extend({},this.data)},init:function(){var t=CKEDITOR.plugins.ae_dragresize_ie11,i=this.parts.image,n={hasCaption:!!this.parts.caption,src:i.getAttribute("src"),alt:i.getAttribute("alt")||"",width:i.getAttribute("width")||"",height:i.getAttribute("height")||"",lock:!this.ready||t.checkHasNaturalRatio(i)},o=i.getAscendant("a");if(o&&this.wrapper.contains(o)&&(this.parts.link=o),!n.align){var a=n.hasCaption?this.element:i;l?(a.hasClass(l[0])?n.align="left":a.hasClass(l[2])&&(n.align="right"),n.align?a.removeClass(l[h[n.align]]):n.align="none"):(n.align=a.getStyle("float")||"none",a.removeStyle("float"))}if(e.plugins.link&&this.parts.link){n.link=t.getLinkAttributesParser()(e,this.parts.link);var r=n.link.advanced;r&&r.advCSSClasses&&(r.advCSSClasses=CKEDITOR.tools.trim(r.advCSSClasses.replace(/cke_\S+/,"")))}this.wrapper[(n.hasCaption?"remove":"add")+"Class"]("cke_image_nocaption"),this.setData(n),e.filter.checkFeature(this.features.dimension)&&e.config.ae_dragresize_ie11_disableResizer!==!0&&s(this);var d=this.dragHandlerContainer.$.style;d.setAttribute("backgroundColor","rgba(255, 255, 255, 1"),d.setAttribute("opacity","1"),this.shiftState=t.stateShifter(this.editor),this.on("contextMenu",function(e){e.data.image=CKEDITOR.TRISTATE_OFF,(this.parts.link||this.wrapper.getAscendant("a"))&&(e.data.link=e.data.unlink=CKEDITOR.TRISTATE_OFF)})},addClass:function(e){m(this).addClass(e)},hasClass:function(e){return m(this).hasClass(e)},removeClass:function(e){m(this).removeClass(e)},getClasses:function(){var e=new RegExp("^("+[].concat(d,l).join("|")+")$");return function(){var t=this.repository.parseElementClasses(m(this).getAttribute("class"));for(var i in t)e.test(i)&&delete t[i];return t}}(),upcast:i(e),downcast:n(e),getLabel:function(){var e=(this.data.alt||"")+" "+this.pathName;return this.editor.lang.widget.label.replace(/%1/,e)}}}function t(e,t){var i=e.wrapper,n=e.data.align,o=e.data.hasCaption;if(t){for(var a=3;a--;)i.removeClass(t[a]);"center"==n?o&&i.addClass(t[1]):"none"!=n&&i.addClass(t[h[n]])}else{"center"==n?(o?i.setStyle("text-align","center"):i.removeStyle("text-align"),i.removeStyle("float")):("none"==n?i.removeStyle("float"):i.setStyle("float",n),i.removeStyle("text-align"));var r=i.$.querySelector("img");r.removeAttribute("style")}}function i(e){var t=o(e),i=e.config.ae_dragresize_ie11_captionedClass;return function(e,n){var o,r={width:1,height:1},s=e.name;if(!e.attributes["data-cke-realelement"]){if(t(e)){if("div"==s){var l=e.getFirst("figure");l&&(e.replaceWith(l),e=l)}n.align="center",o=e.getFirst("img")||e.getFirst("a").getFirst("img")}else"figure"==s&&e.hasClass(i)?o=e.getFirst("img")||e.getFirst("a").getFirst("img"):a(e)&&(o="a"==e.name?e.children[0]:e);if(o){for(var d in r){var c=o.attributes[d];c&&c.match(f)&&delete o.attributes[d]}return e}}}}function n(e){var t=e.config.ae_dragresize_ie11_alignClasses;return function(e){var i="a"==e.name?e.getFirst():e,n=i.attributes,o=this.data.align;if(!this.inline){var a=e.getFirst("span");a&&a.replaceWith(a.getFirst({img:1,a:1}))}if(o&&"none"!=o){var r=CKEDITOR.tools.parseCssText(n.style||"");"center"==o&&"figure"==e.name?e=e.wrapWith(new CKEDITOR.htmlParser.element("div",t?{class:t[1]}:{style:"text-align:center"})):o in{left:1,right:1}&&(t?i.addClass(t[h[o]]):r.float=o),t||CKEDITOR.tools.isEmpty(r)||(n.style=CKEDITOR.tools.writeCssText(r)+";")}return e}}function o(e){var t=e.config.ae_dragresize_ie11_captionedClass,i=e.config.ae_dragresize_ie11_alignClasses,n={figure:1,a:1,img:1};return function(o){if(!(o.name in{div:1,p:1}))return!1;var r=o.children;if(1!==r.length)return!1;var s=r[0];if(!(s.name in n))return!1;if("p"==o.name){if(!a(s))return!1}else if("figure"==s.name){if(!s.hasClass(t))return!1}else{if(e.enterMode==CKEDITOR.ENTER_P)return!1;if(!a(s))return!1}return!(i?!o.hasClass(i[1]):"center"!=CKEDITOR.tools.parseCssText(o.attributes.style||"",!0)["text-align"])}}function a(e){return"img"==e.name||"a"==e.name&&(1==e.children.length&&e.getFirst("img"))}function r(e){var t=e.data,i={width:t.width,height:t.height},n=e.parts.image;for(var o in i)i[o]?n.setAttribute(o,i[o]):n.removeAttribute(o)}function s(e){var t=e.editor,i=t.editable(),n=t.document,o=e.resizer=n.createElement("span"),a=n.createElement("span"),r=n.createElement("span"),s=n.createElement("span"),l=n.createElement("span");if(a.addClass("cke_image_resizer"),a.addClass("cke_image_resizer_ne"),r.addClass("cke_image_resizer"),r.addClass("cke_image_resizer_nw"),s.addClass("cke_image_resizer"),s.addClass("cke_image_resizer_se"),l.addClass("cke_image_resizer"),l.addClass("cke_image_resizer_sw"),o.append(a),o.append(r),o.append(s),o.append(l),o.append(new CKEDITOR.dom.text("​",n)),e.inline)e.wrapper.append(o);else{var d=e.parts.link||e.parts.image,c=d.getParent(),u=n.createElement("span");u.addClass("cke_image_resizer_wrapper"),u.append(d),u.append(o),e.element.append(u,!0),c.is("span")&&c.remove()}o.on("mousedown",function(a){function r(e,t,i){var o=CKEDITOR.document,a=[];if(n.equals(o)||a.push(o.on(e,t)),a.push(n.on(e,t)),i)for(var r=a.length;r--;)i.push(a.pop())}function s(){E=_+u*p,f=Math.round(E/A)}function l(){f=T+m*g,E=Math.round(f*A)}function d(e){h=e.data.$,p=h.screenX-b,g=C-h.screenY,moveRatio=Math.abs(p/g),1==u?p<=0?l():s():p<=0?s():l(),E>=15&&f>=15?(v.$.style.width=E+"px",v.$.style.height=f+"px",y=!0):y=!1}function c(){for(var n;n=I.pop();)n.removeListener();i.removeClass(w),o.removeClass("cke_image_resizing"),y&&(e.setData({height:f,width:E}),t.fire("saveSnapshot")),y=!1}var u,m,p,g,h,f,E,y,v=e.parts.image,b=a.data.$.screenX,C=a.data.$.screenY,_=v.$.clientWidth,T=v.$.clientHeight,A=_/T,I=[],k=a.data.getTarget();k.hasClass("cke_image_resizer_ne")?(u=1,m=1):k.hasClass("cke_image_resizer_nw")?(u=-1,m=1):k.hasClass("cke_image_resizer_se")?(u=1,m=-1):k.hasClass("cke_image_resizer_sw")&&(u=-1,m=-1);var w="cke_image_"+(~m?"n":"s")+(~u?"e":"w");t.fire("saveSnapshot"),r("mousemove",d,I),r("mouseup",c,I),i.addClass(w),o.addClass("cke_image_resizing")})}function l(e){var t,i=[];return function(n){var o=e.getCommand("justify"+n);o&&(i.push(function(){o.refresh(e,e.elementPath())}),n in{right:1,left:1,center:1}&&o.on("exec",function(t){var o=d(e);if(o){o.data.align===n?(E(o,n),delete o.data.align):o.setData("align",n);for(var a=i.length;a--;)i[a]();t.cancel()}}),o.on("refresh",function(i){var o=d(e),a={right:1,left:1,center:1};o&&(void 0===t&&(t=e.filter.checkFeature(e.widgets.registered.image.features.align)),t?this.setState(o.data.align==n?CKEDITOR.TRISTATE_ON:n in a?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED):this.setState(CKEDITOR.TRISTATE_DISABLED),i.cancel())}))}}function d(e){var t=e.widgets.focused;return t&&"image"==t.name?t:null}function c(e){var t=e.config.ae_dragresize_ie11_alignClasses,i={div:{match:o(e)},p:{match:o(e)},img:{attributes:"!src,alt,width,height"},figure:{classes:"!"+e.config.ae_dragresize_ie11_captionedClass},figcaption:!0};return t?(i.div.classes=t[1],i.p.classes=i.div.classes,i.img.classes=t[0]+","+t[2],i.figure.classes+=","+i.img.classes):(i.div.styles="text-align",i.p.styles="text-align",i.img.styles="float",i.figure.styles="float,display"),i}function u(e){var t=e.config.ae_dragresize_ie11_alignClasses,i={dimension:{requiredContent:"img[width,height]"},align:{requiredContent:"img"+(t?"("+t[0]+")":"{float}")},caption:{requiredContent:"figcaption"}};return i}function m(e){return e.data.hasCaption?e.element:e.parts.image}if(!CKEDITOR.plugins.get("ae_dragresize_ie11")){var p='<img alt="" src="" />',g=new CKEDITOR.template('<figure class="{captionedClass}">'+p+"<figcaption>{captionPlaceholder}</figcaption></figure>"),h={left:0,center:1,right:2},f=/^\s*(\d+\%)\s*$/i;CKEDITOR.plugins.add("ae_dragresize_ie11",{requires:"widget",onLoad:function(){CKEDITOR.addCss(".cke_image_nocaption{line-height:0}.cke_editable.cke_image_ne, .cke_editable.cke_image_ne *{cursor:ne-resize !important}.cke_editable.cke_image_nw, .cke_editable.cke_image_nw *{cursor:nw-resize !important}.cke_editable.cke_image_sw, .cke_editable.cke_image_sw *{cursor:sw-resize !important}.cke_editable.cke_image_se, .cke_editable.cke_image_se *{cursor:se-resize !important}.cke_image_resizer{display:none;position:absolute;width:10px;height:10px;background:#000;outline:1px solid #fff;line-height:0;cursor:se-resize;}.cke_image_resizer_wrapper{position:relative;display:inline-block;line-height:0;}.cke_image_resizer.cke_image_resizer_ne{cursor:ne-resize;left:auto;right:-5px;top:-5px;}.cke_image_resizer.cke_image_resizer_nw{cursor:nw-resize;left:-5px;right:auto;top:-5px;}.cke_image_resizer.cke_image_resizer_se{bottom:-5px;cursor:se-resize;left:auto;right:-5px;}.cke_image_resizer.cke_image_resizer_sw{bottom:-5px;cursor:sw-resize;left:-5px;right:auto;}.cke_widget_wrapper:hover .cke_image_resizer,.cke_image_resizing>.cke_image_resizer{display:block}.cke_widget_wrapper>a{display:inline-block}")},init:function(t){var i=(t.config,e(t));t.widgets.add("image",i),t.on("selectionChange",function(e){var i=t.getSelection();if(i){var n=i.getSelectedElement();if(n){var o=n.findOne("img");if(o){var a=n.getClientRect(),r=new CKEDITOR.dom.window(window).getScrollPosition();a.left-=r.x,a.top+=r.y,a.direction=CKEDITOR.SELECTION_BOTTOM_TO_TOP,t.fire("editorInteraction",{nativeEvent:{},selectionData:{element:o,region:a}})}}}})},afterInit:function(e){var t={left:1,right:1,center:1,block:1},i=l(e);for(var n in t)i(n)}}),CKEDITOR.plugins.ae_dragresize_ie11={stateShifter:function(e){function t(e,t){var i={};s?i.attributes={class:s[1]}:i.styles={"text-align":"center"};var n=r.createElement(e.activeEnterMode==CKEDITOR.ENTER_P?"p":"div",i);return a(n,t),t.move(n),n}function i(e){var t=e.findOne("a,img");return t.replace(e),t}function n(e,t){var i=r.createElement("a",{attributes:{href:t.url}});return i.replace(e),e.move(i),i}function o(e){var t=e.findOne("img");return t.replace(e),t}function a(t,i){if(i.getParent()){var n=e.createRange();n.moveToPosition(i,CKEDITOR.POSITION_BEFORE_START),i.remove(),d.insertElementIntoRange(t,n)}else t.replace(i)}var r=e.document,s=e.config.ae_dragresize_ie11_alignClasses,l=e.config.ae_dragresize_ie11_captionedClass,d=e.editable(),c=["hasCaption","align","link"],u={align:function(n,o,a){var r=n.element;n.changed.align||"auto"===r.$.style.marginLeft&&"auto"===r.$.style.marginRight?n.newData.hasCaption||(("center"==a||"auto"===r.$.style.marginLeft&&"auto"===r.$.style.marginRight)&&(n.deflate(),n.element=t(e,r)),n.changed.hasCaption||"center"!=o||"center"==a||(n.deflate(),n.element=i(r))):"center"==a&&n.changed.hasCaption&&!n.newData.hasCaption&&(n.deflate(),n.element=t(e,r)),!s&&r.is("figure")&&("center"==a?r.setStyle("display","inline-block"):r.removeStyle("display"))},hasCaption:function(t,i,n){if(t.changed.hasCaption){var o;if(o=t.element.is({img:1,a:1})?t.element:t.element.findOne("a,img"),t.deflate(),n){var s=CKEDITOR.dom.element.createFromHtml(g.output({captionedClass:l,captionPlaceholder:e.lang.ae_dragresize_ie11.captionPlaceholder}),r);a(s,t.element),o.replace(s.findOne("img")),t.element=s}else o.replace(t.element),t.element=o}},link:function t(i,a,r){if(i.changed.link){var s,l=i.element.is("img")?i.element:i.element.findOne("img"),t=i.element.is("a")?i.element:i.element.findOne("a"),d=i.element.is("a")&&!r||i.element.is("img")&&r;if(d&&i.deflate(),r){a||(s=n(l,i.newData.link));var c=CKEDITOR.plugins.ae_dragresize_ie11.getLinkAttributesGetter()(e,r);CKEDITOR.tools.isEmpty(c.set)||(s||t).setAttributes(c.set),c.removed.length&&(s||t).removeAttributes(c.removed)}else s=o(t);d&&(i.element=s)}}};return function(e){var t,i;for(e.changed={},i=0;i<c.length;i++)t=c[i],e.changed[t]=!!e.oldData&&e.oldData[t]!==e.newData[t];for(i=0;i<c.length;i++)t=c[i],u[t](e,e.oldData?e.oldData[t]:null,e.newData[t]);e.inflate()}},checkHasNaturalRatio:function(e){var t=e.$,i=this.getNatural(e);return Math.round(t.clientWidth/i.width*i.height)==t.clientHeight||Math.round(t.clientHeight/i.height*i.width)==t.clientWidth},getNatural:function(e){var t;if(e.$.naturalWidth)t={width:e.$.naturalWidth,height:e.$.naturalHeight};else{var i=new Image;i.src=e.getAttribute("src"),t={width:i.width,height:i.height}}return t},getLinkAttributesGetter:function(){return CKEDITOR.plugins.link.getLinkAttributes},getLinkAttributesParser:function(){return CKEDITOR.plugins.link.parseLinkAttributes}};var E=function(e,t){"left"===t||"right"===t?e.wrapper.removeStyle("float"):"center"===t&&(e.editor.execCommand("justifyleft"),e.editor.execCommand("justifyleft"))}}}(),CKEDITOR.config.ae_dragresize_ie11_captionedClass="image",function(){if(!CKEDITOR.plugins.get("ae_embed")){var e=/^https?/,t=/<a href=/;CKEDITOR.DEFAULT_AE_EMBED_URL_TPL="http://alloy.iframe.ly/api/oembed?url={url}&callback={callback}",CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL='<div data-ae-embed-url="{url}"></div>',CKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL='<a href="{url}">{url}</a>',CKEDITOR.plugins.add("ae_embed",{requires:"widget",init:function(i){var n=new CKEDITOR.template(i.config.embedUrlTemplate||CKEDITOR.DEFAULT_AE_EMBED_URL_TPL),o=new CKEDITOR.template(i.config.embedWidgetTpl||CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL),a=new CKEDITOR.template(i.config.embedLinkDefaultTpl||CKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL),r=function(e,t){if("div"===e.name&&e.attributes["data-ae-embed-url"])return t.url=e.attributes["data-ae-embed-url"],!0};i.addCommand("embedUrl",{exec:function(e,t){e.insertHtml(o.output({url:t.url}))}}),i.widgets.add("ae_embed",{mask:!0,requiredContent:"div[data-ae-embed-url]",data:function(e){var i=this,o=e.data.url;o&&CKEDITOR.tools.jsonp(n,{url:encodeURIComponent(o)},function(e){e.html?t.test(e.html)?i.createATag(o):i.element.setHtml(e.html):i.createATag(o)},function(e){i.createATag(o)})},createATag:function(e){this.editor.execCommand("undo");var t=(this.editor.getSelection().getSelectedElement(),a.output({url:e}));this.editor.insertHtml(t),this.editor.fire("actionPerformed",this)},upcast:function(e,t){var n=i.config.embedWidgetUpcastFn||r;return n(e,t)}}),i.once("contentDom",function(){i.on("paste",function(t){var n=t.data.dataValue;e.test(n)&&(t.stop(),i.execCommand("embedUrl",{url:t.data.dataValue}))})}),i.on("selectionChange",function(e){var t=i.getSelection();if(t){var n=t.getSelectedElement();if(n){var o=n.findOne('[data-widget="ae_embed"]');if(o){var a=n.getClientRect(),r=new CKEDITOR.dom.window(window).getScrollPosition();a.left-=r.x,a.top+=r.y,a.direction=CKEDITOR.SELECTION_BOTTOM_TO_TOP,i.fire("editorInteraction",{nativeEvent:{},selectionData:{element:o,region:a}})}}}}),i.filter.addElementCallback(function(e){if("data-ae-embed-url"in e.attributes)return CKEDITOR.FILTER_SKIP_TREE})}})}}(),function(){if(!CKEDITOR.plugins.get("ae_imagealignment")){var e={CENTER:"center",LEFT:"left",RIGHT:"right"},t=[e.LEFT,e.RIGHT,e.CENTER],i=[{name:"display",value:"block"},{name:"margin-left",value:"auto"},{name:"margin-right",value:"auto"}],n=function(t){var n=t.getStyle("float");if(n&&"inherit"!==n&&"none"!==n||(n=t.getAttribute("align")),!n){var o=i.every(function(e){var i=t.getStyle(e.name)===e.value;return!i&&e.vendorPrefixes&&(i=e.vendorPrefixes.some(function(i){return t.getStyle(i+e.name)===e.value})),i});if(!n){var a=t.$.parentNode;a.style.textAlign==e.CENTER&&(i.forEach(function(e){t.setStyle(e.name,e.value),e.vendorPrefixes&&e.vendorPrefixes.forEach(function(i){t.setStyle(i+e.name,e.value)})}),o=!0,a.style.textAlign="")}n=o?e.CENTER:null}return n},o=function(t,o){if(o===e.LEFT||o===e.RIGHT)t.removeStyle("float"),o===n(t)&&t.removeAttribute("align");else if(o===e.CENTER){i.forEach(function(e){t.removeStyle(e.name),e.vendorPrefixes&&e.vendorPrefixes.forEach(function(i){t.removeStyle(i+e.name)})});var a=t.$.parentNode;a.style.textAlign==e.CENTER&&(a.style.textAlign="")}},a=function(t,a){o(t,n(t)),a===e.LEFT||a===e.RIGHT?t.setStyle("float",a):a===e.CENTER&&i.forEach(function(e){t.setStyle(e.name,e.value),e.vendorPrefixes&&e.vendorPrefixes.forEach(function(i){t.setStyle(i+e.name,e.value)})})};CKEDITOR.plugins.add("ae_imagealignment",{afterInit:function(e){var i=this;t.forEach(function(t){var r=e.getCommand("justify"+t);r&&(r.on("exec",function(r){var s=e.getSelectionData();if(s&&AlloyEditor.SelectionTest.image({data:{selectionData:s}})){var l=s.element,d=n(l);d===t?o(l,t):a(l,t),r.cancel(),i.refreshCommands(e,new CKEDITOR.dom.elementPath(l))}}),r.on("refresh",function(e){var i={element:e.data.path.lastElement};if(AlloyEditor.SelectionTest.image({data:{selectionData:i}})){var o=n(i.element);this.setState(o===t?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),e.cancel()}}))})},refreshCommands:function(e,i){t.forEach(function(t){var n=e.getCommand("justify"+t);n&&n.refresh(e,i)})}})}}(),function(){CKEDITOR.plugins.get("ae_pasteimages")||CKEDITOR.plugins.add("ae_pasteimages",{init:function(e){e.once("contentDom",function(){var t=e.editable();t.attachListener(t,"paste",this._onPaste,this,{editor:e})}.bind(this))},_onPaste:function(e){if(e.data.$.clipboardData){var t=e.data.$.clipboardData.items[0],i=e.listenerData.editor;if(0===t.type.indexOf("image")){var n=new FileReader,o=t.getAsFile();n.onload=function(e){var t=i.fire("beforeImageAdd",{imageFiles:o});if(t){var n=CKEDITOR.dom.element.createFromHtml('<img src="'+e.target.result+'">');i.insertElement(n);var a={el:n,file:o};i.fire("imageAdd",a)}}.bind(this),n.readAsDataURL(o)}}}})}(),function(){if(!CKEDITOR.plugins.get("ae_placeholder")){var e=CKEDITOR.env.needsBrFiller?"<br>":"",t={1:["<p>"+e+"</p>"],2:[""," ",e],3:["<div>"+e+"</div>"]};CKEDITOR.plugins.add("ae_placeholder",{init:function(e){e.on("blur",this._checkEmptyData,this),e.on("change",this._checkEmptyData,this),e.on("focus",this._removePlaceholderClass,this),e.once("contentDom",this._checkEmptyData,this)},_checkEmptyData:function(e){var i=e.editor,n=i.editable(),o=n.$.innerHTML.trim(),a=t[i.config.enterMode].some(function(e){return o===e});a?n.addClass(i.config.placeholderClass):n.removeClass(i.config.placeholderClass)},_removePlaceholderClass:function(e){var t=e.editor,i=new CKEDITOR.dom.element(t.element.$);i.removeClass(t.config.placeholderClass)}})}}(),function(){CKEDITOR.plugins.get("ae_selectionkeystrokes")||CKEDITOR.plugins.add("ae_selectionkeystrokes",{requires:"ae_selectionregion",init:function(e){e.config.selectionKeystrokes&&e.config.selectionKeystrokes.forEach(function(t){var i=new CKEDITOR.command(e,{exec:function(e){e.fire("editorInteraction",{manualSelection:t.selection,nativeEvent:{},selectionData:e.getSelectionData()})}}),n="selectionKeystroke"+t.selection;e.addCommand(n,i),e.setKeystroke(t.keys,n)})}})}(),function(){function e(e){return CKEDITOR.env.ie?e.$.clientWidth:parseInt(e.getComputedStyle("width"),10)}function t(e,t){var i=e.getComputedStyle("border-"+t+"-width"),n={thin:"0px",medium:"1px",thick:"2px"};return i.indexOf("px")<0&&(i=i in n&&"none"!=e.getComputedStyle("border-style")?n[i]:0),parseInt(i,10)}function i(e){for(var t,i,n,o=e.$.rows,a=0,r=0,s=o.length;r<s;r++)n=o[r],t=n.cells.length,t>a&&(a=t,i=n);return i}function n(e){for(var n=[],o=-1,a="rtl"===e.getComputedStyle("direction"),r=i(e),s=new CKEDITOR.dom.element(e.$.tBodies[0]),l=s.getDocumentPosition(),d=0,c=r.cells.length;d<c;d++){var u=new CKEDITOR.dom.element(r.cells[d]),m=r.cells[d+1]&&new CKEDITOR.dom.element(r.cells[d+1]);o+=u.$.colSpan||1;var p,g,h,f=u.getDocumentPosition().x;a?g=f+t(u,"left"):p=f+u.$.offsetWidth-t(u,"right"),m?(f=m.getDocumentPosition().x,a?p=f+m.$.offsetWidth-t(m,"right"):g=f+t(m,"left")):(f=e.getDocumentPosition().x,a?p=f:g=f+e.$.offsetWidth),h=Math.max(g-p,4),n.push({table:e,index:o,x:p,y:l.y,width:h,height:s.$.offsetHeight,rtl:a})}return n}function o(e,t){for(var i=0,n=e.length;i<n;i++){var o=e[i];if(t>=o.x&&t<=o.x+o.width)return o}return null}function a(e){(e.data||e).preventDefault()}function r(i,n){function o(){g.removeListener("mouseup",u),g.removeListener("mousedown",c),g.removeListener("mousemove",m)}function r(){for(var t=n.index,i=CKEDITOR.tools.buildTableMap(n.table),o=[],r=[],s=Number.MAX_VALUE,l=s,d=n.rtl,c=0,u=i.length;c<u;c++){var _=i[c],T=_[t+(d?1:0)],A=_[t+(d?0:1)];T=T&&new CKEDITOR.dom.element(T),A=A&&new CKEDITOR.dom.element(A),T&&A&&T.equals(A)||(T&&(s=Math.min(s,e(T))),A&&(l=Math.min(l,e(A))),o.push(T),r.push(A))}y=o,v=r,b=n.x-s,C=n.x+l,g.setOpacity(.5),f=parseInt(g.getStyle("left"),10),E=0,h=1,g.on("mousemove",m),p.on("dragstart",a)}function s(){h=0,g.setOpacity(0),E&&d();var e=n.table;setTimeout(function(){e.removeCustomData("_cke_table_pillars")},0),p.removeListener("dragstart",a)}function d(){for(var i=n.rtl,o=i?v.length:y.length,a=0;a<o;a++){var r=y[a],s=v[a],d=n.table;CKEDITOR.tools.setTimeout(function(e,t,n,o,a,r){e&&e.setStyle("width",l(Math.max(t+r,1))),n&&n.setStyle("width",l(Math.max(o-r,1))),a&&d.setStyle("width",l(a+r*(i?-1:1)))},0,this,[r,r&&e(r),s,s&&e(s),(!r||!s)&&e(d)+t(d,"left")+t(d,"right"),E])}}function c(e){a(e),r(),p.on("mouseup",u,this)}function u(e){e.removeListener(),s()}function m(e){_(e.data.getPageOffset().x)}var p,g,h,f,E,y,v,b,C;p=i.document,g=CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on style="position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10"></div>',p),i.on("destroy",function(){o(),g.remove()}),p.getDocumentElement().append(g),g.setStyles({width:l(n.width),height:l(n.height),left:l(n.x),top:l(n.y)}),g.on("mousedown",c,this),p.getBody().setStyle("cursor","col-resize"),g.show();var _=this.move=function(e){var t=e-Math.round(g.$.offsetWidth/2);if(T){if(t===b||t===C)return;t=Math.max(t,b),t=Math.min(t,C),E=t-f}g.setStyle("left",l(t))},T=(this.destroy=function(){o(),p.getBody().setStyle("cursor","auto"),g.remove()},this.isResizing=function(){return h})}function s(e){var t=e.data.getTarget();if("mouseout"===e.name){if(!t.is("table"))return;for(var i=new CKEDITOR.dom.element(e.data.$.relatedTarget||e.data.$.toElement);i&&i.$&&!i.equals(t)&&!i.is("body");)i=i.getParent();if(!i||i.equals(t))return}t.getAscendant("table",1).removeCustomData("_cke_table_pillars"),e.removeListener()}if(!CKEDITOR.plugins.get("ae_tableresize")){var l=CKEDITOR.tools.cssLength;CKEDITOR.plugins.add("ae_tableresize",{requires:"ae_tabletools",init:function(e){e.on("contentDom",function(){var t,i=e.editable();i.attachListener(i.isInline()?i:e.document,"mousemove",function(i){i=i.data;var l=i.getTarget();if(l.type===CKEDITOR.NODE_ELEMENT){var d=i.getPageOffset().x;if(t){if(t.isResizing())return t.move(d),void a(i);t.destroy(),t=null}var c,u;if((l.is("table")||l.getAscendant("tbody",1))&&(c=l.getAscendant("table",1),e.editable().contains(c))){(u=c.getCustomData("_cke_table_pillars"))||(c.setCustomData("_cke_table_pillars",u=n(c)),c.on("mouseout",s),c.on("mousedown",s));var m=o(u,d);m&&(t=new r(e,m))}}})})}})}}(),function(){function e(e){function t(e){n.length>0||e.type==CKEDITOR.NODE_ELEMENT&&E.test(e.getName())&&!e.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(o,e,"selected_cell",!0),n.push(e))}for(var i=e.getRanges(),n=[],o={},a=0;a<i.length;a++){var r=i[a];if(r.collapsed){var s=r.getCommonAncestor(),l=s.getAscendant("td",!0)||s.getAscendant("th",!0);l&&n.push(l)}else{var d,c=new CKEDITOR.dom.walker(r);for(c.guard=t;d=c.next();)if(d.type!=CKEDITOR.NODE_ELEMENT||!d.is(CKEDITOR.dtd.table)){var u=d.getAscendant("td",!0)||d.getAscendant("th",!0);u&&!u.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(o,u,"selected_cell",!0),n.push(u))}}}return CKEDITOR.dom.element.clearAllMarkers(o),n}function t(e){for(var t,i,n,o=0,a=e.length-1,r={};t=e[o++];)CKEDITOR.dom.element.setMarker(r,t,"delete_cell",!0);for(o=0;t=e[o++];)if((i=t.getPrevious())&&!i.getCustomData("delete_cell")||(i=t.getNext())&&!i.getCustomData("delete_cell"))return CKEDITOR.dom.element.clearAllMarkers(r),i;return CKEDITOR.dom.element.clearAllMarkers(r),n=e[0].getParent(),(n=n.getPrevious())?n.getLast():(n=e[a].getParent(),(n=n.getNext())?n.getChild(0):null)}function i(t,i){for(var n=e(t),o=n[0],a=o.getAscendant("table"),r=o.getDocument(),s=n[0].getParent(),l=s.$.rowIndex,d=n[n.length-1],c=d.getParent().$.rowIndex+d.$.rowSpan-1,u=new CKEDITOR.dom.element(a.$.rows[c]),m=i?l:c,p=i?s:u,g=CKEDITOR.tools.buildTableMap(a),h=g[m],f=i?g[m-1]:g[m+1],E=g[0].length,y=r.createElement("tr"),v=0;h[v]&&v<E;v++){var b;h[v].rowSpan>1&&f&&h[v]==f[v]?(b=h[v],
b.rowSpan+=1):(b=new CKEDITOR.dom.element(h[v]).clone(),b.removeAttribute("rowSpan"),b.appendBogus(),y.append(b),b=b.$),v+=b.colSpan-1}i?y.insertBefore(p):y.insertAfter(p)}function n(t){if(t instanceof CKEDITOR.dom.selection){for(var i=e(t),o=i[0],a=o.getAscendant("table"),r=CKEDITOR.tools.buildTableMap(a),s=i[0].getParent(),l=s.$.rowIndex,d=i[i.length-1],c=d.getParent().$.rowIndex+d.$.rowSpan-1,u=[],m=l;m<=c;m++){for(var p=r[m],g=new CKEDITOR.dom.element(a.$.rows[m]),h=0;h<p.length;h++){var f=new CKEDITOR.dom.element(p[h]),E=f.getParent().$.rowIndex;if(1==f.$.rowSpan)f.remove();else if(f.$.rowSpan-=1,E==m){var y=r[m+1];y[h-1]?f.insertAfter(new CKEDITOR.dom.element(y[h-1])):new CKEDITOR.dom.element(a.$.rows[m+1]).append(f,1)}h+=f.$.colSpan-1}u.push(g)}var v=a.$.rows,b=new CKEDITOR.dom.element(v[c+1]||(l>0?v[l-1]:null)||a.$.parentNode);for(m=u.length;m>=0;m--)n(u[m]);return b}return t instanceof CKEDITOR.dom.element&&(a=t.getAscendant("table"),1==a.$.rows.length?a.remove():t.remove()),null}function o(e,t){for(var i=e.getParent(),n=i.$.cells,o=0,a=0;a<n.length;a++){var r=n[a];if(o+=t?1:r.colSpan,r==e.$)break}return o-1}function a(e,t){for(var i=t?1/0:0,n=0;n<e.length;n++){var a=o(e[n],t);(t?a<i:a>i)&&(i=a)}return i}function r(t,i){for(var n=e(t),o=n[0],r=o.getAscendant("table"),s=a(n,1),l=a(n),d=i?s:l,c=CKEDITOR.tools.buildTableMap(r),u=[],m=[],p=c.length,g=0;g<p;g++){u.push(c[g][d]);var h=i?c[g][d-1]:c[g][d+1];m.push(h)}for(g=0;g<p;g++){var f;u[g]&&(u[g].colSpan>1&&m[g]==u[g]?(f=u[g],f.colSpan+=1):(f=new CKEDITOR.dom.element(u[g]).clone(),f.removeAttribute("colSpan"),f.appendBogus(),f[i?"insertBefore":"insertAfter"].call(f,new CKEDITOR.dom.element(u[g])),f=f.$),g+=f.rowSpan-1)}}function s(t){for(var i,n,o=e(t),a=o[0],r=o[o.length-1],s=a.getAscendant("table"),l=CKEDITOR.tools.buildTableMap(s),d=[],c=0,u=l.length;c<u;c++)for(var m=0,p=l[c].length;m<p;m++)l[c][m]==a.$&&(i=m),l[c][m]==r.$&&(n=m);for(c=i;c<=n;c++)for(m=0;m<l.length;m++){var g=l[m],h=new CKEDITOR.dom.element(s.$.rows[m]),f=new CKEDITOR.dom.element(g[c]);f.$&&(1==f.$.colSpan?f.remove():f.$.colSpan-=1,m+=f.$.rowSpan-1,h.$.cells.length||d.push(h))}var E=s.$.rows[0]&&s.$.rows[0].cells,y=new CKEDITOR.dom.element(E[i]||(i?E[i-1]:s.$.parentNode));return d.length==u&&s.remove(),y}function l(e,t){var i=e.getStartElement(),n=i.getAscendant("td",1)||i.getAscendant("th",1);if(n){var o=n.clone();o.appendBogus(),t?o.insertBefore(n):o.insertAfter(n)}}function d(i){if(i instanceof CKEDITOR.dom.selection){for(var n=e(i),o=n[0]&&n[0].getAscendant("table"),a=t(n),r=n.length-1;r>=0;r--)d(n[r]);a?u(a,!0):o&&o.remove()}else if(i instanceof CKEDITOR.dom.element){var s=i.getParent();1==s.getChildCount()?s.remove():i.remove()}}function c(e){var t=e.getBogus();t&&t.remove(),e.trim()}function u(e,t){var i=e.getDocument(),n=CKEDITOR.document;CKEDITOR.env.ie&&10==CKEDITOR.env.version&&(n.focus(),i.focus());var o=new CKEDITOR.dom.range(i);o["moveToElementEdit"+(t?"End":"Start")](e)||(o.selectNodeContents(e),o.collapse(!t)),o.select(!0)}function m(e,t,i){var n=e[t];if("undefined"==typeof i)return n;for(var o=0;n&&o<n.length;o++){if(i.is&&n[o]==i.$)return o;if(o==i)return new CKEDITOR.dom.element(n[o])}return i.is?-1:null}function p(e,t){for(var i=[],n=0;n<e.length;n++){var o=e[n];i.push(o[t]),o[t].rowSpan>1&&(n+=o[t].rowSpan-1)}return i}function g(t,i,n){var o,a=e(t);if((i?1!=a.length:a.length<2)||(o=t.getCommonAncestor())&&o.type==CKEDITOR.NODE_ELEMENT&&o.is("table"))return!1;var r,s=a[0],l=s.getAscendant("table"),d=CKEDITOR.tools.buildTableMap(l),u=d.length,p=d[0].length,g=s.getParent().$.rowIndex,h=m(d,g,s);if(i){var f;try{var E=parseInt(s.getAttribute("rowspan"),10)||1,y=parseInt(s.getAttribute("colspan"),10)||1;f=d["up"==i?g-E:"down"==i?g+E:g]["left"==i?h-y:"right"==i?h+y:h]}catch(e){return!1}if(!f||s.$==f)return!1;a["up"==i||"left"==i?"unshift":"push"](new CKEDITOR.dom.element(f))}for(var v=s.getDocument(),b=g,C=0,_=0,T=!n&&new CKEDITOR.dom.documentFragment(v),A=0,I=0;I<a.length;I++){r=a[I];var k=r.getParent(),w=r.getFirst(),D=r.$.colSpan,S=r.$.rowSpan,O=k.$.rowIndex,x=m(d,O,r);if(A+=D*S,_=Math.max(_,x-h+D),C=Math.max(C,O-g+S),!n){if(c(r),r.getChildren().count()){if(O!=b&&w&&(!w.isBlockBoundary||!w.isBlockBoundary({br:1}))){var R=T.getLast(CKEDITOR.dom.walker.whitespaces(!0));!R||R.is&&R.is("br")||T.append("br")}r.moveChildren(T)}I?r.remove():r.setHtml("")}b=O}if(n)return C*_==A;T.moveChildren(s),s.appendBogus(),_>=p?s.removeAttribute("rowSpan"):s.$.rowSpan=C,C>=u?s.removeAttribute("colSpan"):s.$.colSpan=_;var N=new CKEDITOR.dom.nodeList(l.$.rows),B=N.count();for(I=B-1;I>=0;I--){var K=N.getItem(I);K.$.cells.length||(K.remove(),B++)}return s}function h(t,i){var n=e(t);if(n.length>1)return!1;if(i)return!0;var o,a,r,s,l=n[0],d=l.getParent(),c=d.getAscendant("table"),u=CKEDITOR.tools.buildTableMap(c),p=d.$.rowIndex,g=m(u,p,l),h=l.$.rowSpan;if(h>1){a=Math.ceil(h/2),r=Math.floor(h/2),s=p+a;var f,E=new CKEDITOR.dom.element(c.$.rows[s]),y=m(u,s);o=l.clone();for(var v=0;v<y.length;v++){if(f=y[v],f.parentNode==E.$&&v>g){o.insertBefore(new CKEDITOR.dom.element(f));break}f=null}f||E.append(o)}else{r=a=1,E=d.clone(),E.insertAfter(d),E.append(o=l.clone());for(var b=m(u,p),C=0;C<b.length;C++)b[C].rowSpan++}return o.appendBogus(),l.$.rowSpan=a,o.$.rowSpan=r,1==a&&l.removeAttribute("rowSpan"),1==r&&o.removeAttribute("rowSpan"),o}function f(t,i){var n=e(t);if(n.length>1)return!1;if(i)return!0;var o,a,r,s=n[0],l=s.getParent(),d=l.getAscendant("table"),c=CKEDITOR.tools.buildTableMap(d),u=l.$.rowIndex,g=m(c,u,s),h=s.$.colSpan;if(h>1)a=Math.ceil(h/2),r=Math.floor(h/2);else{r=a=1;for(var f=p(c,g),E=0;E<f.length;E++)f[E].colSpan++}return o=s.clone(),o.insertAfter(s),o.appendBogus(),s.$.colSpan=a,o.$.colSpan=r,1==a&&s.removeAttribute("colSpan"),1==r&&o.removeAttribute("colSpan"),o}if(!CKEDITOR.plugins.get("ae_tabletools")){var E=/^(?:td|th)$/;CKEDITOR.plugins.add("ae_tabletools",{init:function(e){function t(e){return CKEDITOR.tools.extend(e||{},{contextSensitive:1,refresh:function(e,t){this.setState(t.contains({td:1,th:1},1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}function o(t,i){var n=e.getCommand(t);n||(n=e.addCommand(t,i),e.addFeature(n))}e.lang.table;o("rowDelete",t({requiredContent:"table",exec:function(e){var t=e.getSelection();u(n(t))}})),o("rowInsertBefore",t({requiredContent:"table",exec:function(e){var t=e.getSelection();i(t,!0)}})),o("rowInsertAfter",t({requiredContent:"table",exec:function(e){var t=e.getSelection();i(t)}})),o("columnDelete",t({requiredContent:"table",exec:function(e){var t=e.getSelection(),i=s(t);i&&u(i,!0)}})),o("columnInsertBefore",t({requiredContent:"table",exec:function(e){var t=e.getSelection();r(t,!0)}})),o("columnInsertAfter",t({requiredContent:"table",exec:function(e){var t=e.getSelection();r(t)}})),o("cellDelete",t({requiredContent:"table",exec:function(e){var t=e.getSelection();d(t)}})),o("cellMerge",t({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",exec:function(e){u(g(e.getSelection()),!0)}})),o("cellMergeRight",t({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e){u(g(e.getSelection(),"right"),!0)}})),o("cellMergeDown",t({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e){u(g(e.getSelection(),"down"),!0)}})),o("cellVerticalSplit",t({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e){u(h(e.getSelection()))}})),o("cellHorizontalSplit",t({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e){u(f(e.getSelection()))}})),o("cellInsertBefore",t({requiredContent:"table",exec:function(e){var t=e.getSelection();l(t,!0)}})),o("cellInsertAfter",t({requiredContent:"table",exec:function(e){var t=e.getSelection();l(t)}}))},getSelectedCells:e})}}(),CKEDITOR.tools.buildTableMap=function(e){for(var t=e.$.rows,i=-1,n=[],o=0;o<t.length;o++){i++,!n[i]&&(n[i]=[]);for(var a=-1,r=0;r<t[o].cells.length;r++){var s=t[o].cells[r];for(a++;n[i][a];)a++;for(var l=isNaN(s.colSpan)?1:s.colSpan,d=isNaN(s.rowSpan)?1:s.rowSpan,c=0;c<d;c++){n[i+c]||(n[i+c]=[]);for(var u=0;u<l;u++)n[i+c][a+u]=t[o].cells[r]}a+=l-1}}return n},function(){function e(){}function i(e,i,s){var l=AlloyEditor.Buttons[e];return r[s.name]=r[s.name]||{},r[s.name][e]=r[s.name][e]||i,l||(l=o(CKEDITOR.tools.merge(a,{displayName:e,propTypes:{editor:n.object.isRequired,tabIndex:n.number},statics:{key:e},render:function(){var i=this.props.editor.get("nativeEditor"),n="ae-button ae-button-bridge",o=r[i.name][e].name||r[i.name][e].command||e,a=r[i.name][e].label,s="button-"+o,l="ae-icon-"+o,d={},c=CKEDITOR.skin.getIconStyle(o);if(c){var u=c.split(";");d.backgroundImage=u[0].substring(u[0].indexOf(":")+1),d.backgroundPosition=u[1].substring(u[1].indexOf(":")+1),d.backgroundSize=u[2].substring(u[2].indexOf(":")+1)}return t.createElement("button",{"aria-label":a,className:n,"data-type":s,onClick:this._handleClick,tabIndex:this.props.tabIndex,title:a},t.createElement("span",{className:l,style:d}))},_handleClick:function(t){var i=this.props.editor.get("nativeEditor"),n=r[i.name][e].command,o=r[i.name][e].onClick;o?o.call(this):i.execCommand(n),i.fire("actionPerformed",this)}})),AlloyEditor.Buttons[e]=l),l}if(!CKEDITOR.plugins.get("ae_buttonbridge")){var a={toFeature:e},r={};CKEDITOR.plugins.get("button")||(CKEDITOR.UI_BUTTON="button",CKEDITOR.plugins.add("button",{})),CKEDITOR.plugins.add("ae_buttonbridge",{requires:["ae_uibridge"],beforeInit:function(e){e.ui.addButton=function(e,t){this.add(e,CKEDITOR.UI_BUTTON,t)},e.ui.addHandler(CKEDITOR.UI_BUTTON,{add:i,create:function(e){var t="buttonBridge"+(1e9*Math.random()>>>0),n=i(t,e);return new n}})}})}}(),function(){function e(){}function i(e,i,s){var l=AlloyEditor.Buttons[e];return r[s.name]=r[s.name]||{},r[s.name][e]=r[s.name][e]||i,l||(l=o(CKEDITOR.tools.merge(a,{displayName:e,propTypes:{editor:n.object.isRequired,tabIndex:n.number},statics:{key:e},render:function(){var i=this.props.editor.get("nativeEditor"),n=r[i.name][e].name||r[i.name][e].command||e,o="ae-button ae-button-bridge",a="ae-icon-"+n,s={},l=CKEDITOR.skin.getIconStyle(n);if(l){var d=l.split(";");s.backgroundImage=d[0].substring(d[0].indexOf(":")+1),s.backgroundPosition=d[1].substring(d[1].indexOf(":")+1),s.backgroundSize=d[2].substring(d[2].indexOf(":")+1)}var c;return this.props.expanded&&(c=this._getMenu()),t.createElement("div",{className:"ae-container ae-has-dropdown"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":r[i.name][e].label,className:o,onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:r[i.name][e].label},t.createElement("span",{className:a,style:s})),c)},_getMenu:function(){return t.createElement(AlloyEditor.ButtonDropdown,{onDismiss:this.props.toggleDropdown},this._getMenuItems())},_getMenuItems:function(){var e=this.props.editor.get("nativeEditor"),n=i.onMenu(),o=Object.keys(n).map(function(i){var o=e.getMenuItem(i);if(!o)return null;var a=o.definition||o,r=n[i],s="ae-toolbar-element "+(r===CKEDITOR.TRISTATE_ON?"active":""),l=r===CKEDITOR.TRISTATE_DISABLED,d=function(){a.command?e.execCommand(a.command):a.onClick&&a.onClick.apply(a)};return t.createElement("li",{key:o.name,role:"option"},t.createElement("button",{className:s,disabled:l,onClick:d},a.label))}.bind(this));return o}})),AlloyEditor.Buttons[e]=l),l}if(!CKEDITOR.plugins.get("ae_menubuttonbridge")){var a={toFeature:e},r={};CKEDITOR.plugins.get("menubutton")||(CKEDITOR.UI_MENU_BUTTON="menubutton",CKEDITOR.plugins.add("menubutton",{})),CKEDITOR.plugins.add("ae_menubuttonbridge",{requires:["ae_uibridge","ae_menubridge"],beforeInit:function(e){e.ui.addMenuButton=function(e,t){this.add(e,CKEDITOR.UI_MENUBUTTON,t)},e.ui.addHandler(CKEDITOR.UI_MENUBUTTON,{add:i,create:function(e){var t="buttonBridge"+(1e9*Math.random()>>>0),n=i(t,e);return new n}})}})}}(),function(){CKEDITOR.plugins.get("ae_menubridge")||CKEDITOR.plugins.add("ae_menubridge",{beforeInit:function(e){if(!CKEDITOR.plugins.get("menu")){for(var t=[],i=e._.menuGroups={},n=e._.menuItems={},o=0;o<t.length;o++)i[t[o]]=o+1;e.addMenuGroup=function(e,t){i[e]=t||100},e.addMenuItem=function(e,t){i[t.group]&&(n[e]={name:e,definition:t})},e.addMenuItems=function(e){for(var t in e)this.addMenuItem(t,e[t])},e.getMenuItem=function(e){return n[e]},e.removeMenuItem=function(e){delete n[e]}}}})}(),function(){function e(){}if(!CKEDITOR.plugins.get("ae_panelmenubuttonbridge")){var i={createPanel:e},a={},r=function(e,r,s){var l=AlloyEditor.Buttons[e];return a[s.name]=a[s.name]||{},a[s.name][e]=a[s.name][e]||r,l||(l=o(CKEDITOR.tools.merge(i,{displayName:e,propTypes:{editor:n.object.isRequired},statics:{key:e},render:function(){var i=this.props.editor.get("nativeEditor"),n=a[i.name][e].name||a[i.name][e].command||e,o="ae-button ae-button-bridge",r="ae-icon-"+n,s={},l=CKEDITOR.skin.getIconStyle(n);if(l){var d=l.split(";");s.backgroundImage=d[0].substring(d[0].indexOf(":")+1),s.backgroundPosition=d[1].substring(d[1].indexOf(":")+1),s.backgroundSize=d[2].substring(d[2].indexOf(":")+1)}var c;return this.props.expanded&&(c=this._getPanel()),t.createElement("div",{className:"ae-container ae-has-dropdown"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":a[i.name][e].label,className:o,onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:a[i.name][e].label},t.createElement("span",{className:r,style:s})),c)},_getPanel:function(){var i=this.props.editor.get("nativeEditor"),n=a[i.name][e].onBlock,o={hide:this.props.toggleDropdown,show:this.props.toggleDropdown},r=new CKEDITOR.dom.element("div"),s={element:r,keys:{}};return n&&n.call(this,o,s),t.createElement(AlloyEditor.ButtonDropdown,{onDismiss:this.props.toggleDropdown},t.createElement("div",{className:r.getAttribute("class"),dangerouslySetInnerHTML:{__html:r.getHtml()}}))}})),AlloyEditor.Buttons[e]=l),l};CKEDITOR.plugins.get("panelmenubutton")||(CKEDITOR.UI_PANELBUTTON="panelmenubutton",CKEDITOR.plugins.add("panelmenubutton",{})),CKEDITOR.plugins.get("panelbutton")||(CKEDITOR.UI_PANELBUTTON="panelbutton",CKEDITOR.plugins.add("panelbutton",{})),CKEDITOR.plugins.add("ae_panelmenubuttonbridge",{requires:["ae_uibridge"],beforeInit:function(e){e.ui.addPanelMenuButton=function(e,t){this.add(e,CKEDITOR.UI_PANELBUTTON,t)},e.ui.addHandler(CKEDITOR.UI_PANELBUTTON,{add:r,create:function(e){var t="panelMenuButtonBridge"+(1e9*Math.random()>>>0),i=r(t,e);return new i}})}})}}(),function(){function e(){}if(!CKEDITOR.plugins.get("ae_richcombobridge")){var i={commit:e,createPanel:e,disable:e,enable:e,getState:e,hideGroup:e,hideItem:e,mark:e,showAll:e,startGroup:e,unmarkAll:e},a={},r=function(e,r,s){var l=AlloyEditor.Buttons[e];return a[s.name]=a[s.name]||{},a[s.name][e]=a[s.name][e]||r,a[s.name][e].currentValue=void 0,l||(l=o(CKEDITOR.tools.merge(i,{displayName:e,propTypes:{editor:n.object.isRequired},statics:{key:e},add:function(e,t,i){this._items.push({preview:t,title:i,value:e})},componentWillMount:function(){var t=this.props.editor.get("nativeEditor"),i=a[t.name][e];this._items=[],this.setValue=this._setValue,i.init&&i.init.call(this),i.onRender&&i.onRender.call(this)},componentWillUnmount:function(){this._cacheValue(this.state.value),this.setValue=this._cacheValue},getInitialState:function(){return{value:a[s.name][e].currentValue}},getValue:function(){return this.state.value},render:function(){var i,n=this.props.editor.get("nativeEditor"),o=a[n.name][e].currentValue||r.label;return this.props.expanded&&(i=this._getItemsList()),t.createElement("div",{className:"ae-container-dropdown ae-has-dropdown"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":o,className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:o},t.createElement("div",{className:"ae-container"},t.createElement("span",{className:"ae-container-dropdown-selected-item"},o),t.createElement("span",{className:"ae-icon-arrow"}))),i)},_cacheValue:function(t){var i=this.props.editor.get("nativeEditor");a[i.name][e].currentValue=t},_getItems:function(){var e=this,i=this._items.map(function(i){var n="ae-toolbar-element "+(i.value===this.state.value?"active":"");return t.createElement("li",{key:i.title,role:"option"},t.createElement("button",{className:n,dangerouslySetInnerHTML:{__html:i.preview},"data-value":i.value,onClick:e._onClick}))}.bind(this));return i},_getItemsList:function(){return t.createElement(AlloyEditor.ButtonDropdown,{onDismiss:this.props.toggleDropdown},this._getItems())},_onClick:function(t){var i=this.props.editor.get("nativeEditor"),n=a[i.name][e];if(n.onClick){var o=t.currentTarget.getAttribute("data-value");n.onClick.call(this,o),a[i.name][e].currentValue=o,i.fire("actionPerformed",this)}},_setValue:function(e){this._cacheValue(e),this.setState({value:e})}})),AlloyEditor.Buttons[e]=l),l};CKEDITOR.plugins.get("richcombo")||(CKEDITOR.UI_RICHCOMBO="richcombo",CKEDITOR.plugins.add("richcombo",{})),CKEDITOR.plugins.add("ae_richcombobridge",{requires:["ae_uibridge"],beforeInit:function(e){e.ui.addRichCombo=function(e,t){this.add(e,CKEDITOR.UI_RICHCOMBO,t)},e.ui.addHandler(CKEDITOR.UI_RICHCOMBO,{add:r,create:function(e){var t="richComboBridge"+(1e9*Math.random()>>>0),i=r(t,e);return new i}})}})}}(),function(){CKEDITOR.plugins.get("ae_uibridge")||CKEDITOR.plugins.add("ae_uibridge",{beforeInit:function(e){var t=e.ui.add;e.ui.add=function(i,n,o){t.apply(this,arguments);var a=this._.handlers[n];a&&a.add&&(a.add(i,o,e),AlloyEditor.registerBridgeButton(i,e.__processingPlugin__.plugin.name))}}})}();var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var t={isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isBoolean:function(e){return"boolean"==typeof e},isFunction:function(e){return"function"==typeof e},isNull:function(e){return null===e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isObject:function(i){var n="undefined"==typeof i?"undefined":e(i);return i&&("object"===n||t.isFunction(i))},isString:function(e){return"string"==typeof e},mix:function(e,t){var i=Object.prototype.hasOwnProperty;for(var n in t)i.call(t,n)&&(e[n]=t[n])},toInt:function(e){return parseInt(e,10)}};AlloyEditor.Lang=t}(),function(){var e={extend:function(e,t,i,n){if(!t||!e)throw"extend failed, verify dependencies";var o=t.prototype,a=Object.create(o);return e.prototype=a,a.constructor=e,e.superclass=o,t!==Object&&o.constructor===Object.prototype.constructor&&(o.constructor=t),i&&AlloyEditor.Lang.mix(a,i),n&&AlloyEditor.Lang.mix(e,n),e}};AlloyEditor.OOP=e}(),function(){function e(e){this.__config__=e||{},this.__ATTRS__={}}e.prototype={constructor:e,get:function(e){var t=this.constructor.ATTRS[e];if(t){this._isInitialized(e)||this._init(e);var i=this.__ATTRS__[e];return t.getter&&(i=this._callStringOrFunction(t.getter,i)),i}},set:function(e,t){var i=this.constructor.ATTRS[e];i&&(this._isInitialized(e)||this._init(e),i.readOnly||i.writeOnce&&this._isInitialized(e)||i.validator&&!this._callStringOrFunction(i.validator,t)||(i.setter&&(t=this._callStringOrFunction(i.setter,t)),this.__ATTRS__[e]=t))},_callStringOrFunction:function(e,t){var i=null;return AlloyEditor.Lang.isArray(t)||(t=[t]),AlloyEditor.Lang.isString(e)&&AlloyEditor.Lang.isFunction(this[e])?i=this[e].apply(this,t):AlloyEditor.Lang.isFunction(e)&&(i=e.apply(this,t)),i},_init:function(e){var t,i=this.constructor.ATTRS[e],n=Object.prototype.hasOwnProperty.call(i,"value"),o=Object.prototype.hasOwnProperty.call(this.__config__,e);if(i.valueFn)t=this._callStringOrFunction(i.valueFn,t),this.__ATTRS__[e]=t;else if(i.readOnly)t=i.value;else if(i.writeOnce)if(o)t=this.__config__[e];else{if(!n)return;t=i.value}else o?t=this.__config__[e]:n&&(t=i.value);if(i.validator&&o&&!this._callStringOrFunction(i.validator,t)){if(!n)return;t=i.value}i.setter&&o&&(t=this._callStringOrFunction(i.setter,t)),this.__ATTRS__[e]=t},_isInitialized:function(e){return Object.prototype.hasOwnProperty.call(this.__ATTRS__,e)}},AlloyEditor.Attribute=e}(),function(){function e(t){e.superclass.constructor.call(this,t),this.init(t)}AlloyEditor.OOP.extend(e,AlloyEditor.Attribute,{init:function(e){this._callChain("initializer",e)},destroy:function(){this._callChain("destructor")},_callChain:function(e,t){for(var i=[],n=this.constructor;n;)AlloyEditor.Lang.isFunction(n.prototype[e])&&i.push(n.prototype[e]),n=n.superclass?n.superclass.constructor:null;i=i.reverse(),t=AlloyEditor.Lang.isArray(t)?t:[t];for(var o=0;o<i.length;o++){var a=i[o];a.apply(this,t)}}}),AlloyEditor.Base=e}(),function(){var e=function(){return"ae-arrow-box ae-arrow-box-bottom"};AlloyEditor.SelectionGetArrowBoxClasses={table:e}}(),function(){var e={left:0,top:0},t=function(t,n){var o=i.findDOMNode(t),a=t.props.editor.get("nativeEditor"),r=a.config.uiNode||document.body,s=getComputedStyle(r),l=parseInt(s.getPropertyValue("margin-left"),10),d=parseInt(s.getPropertyValue("margin-right"),10),c=l+r.clientWidth+d,u=o.offsetWidth/2,m=new CKEDITOR.dom.window(window).getScrollPosition(),p=t.props.gutter||e,g=t.getWidgetXYPoint(n.left+n.width/2-m.x,n.top+m.y,CKEDITOR.SELECTION_BOTTOM_TO_TOP),h=[n.left+n.width/2-u-m.x,n.top-o.offsetHeight+m.y-p.top];h[0]<0?h[0]=0:h[0]>c-o.offsetWidth&&(h[0]=c-o.offsetWidth),t.moveToPoint(g,h)},n=function(e){var i=e.selectionData?e.selectionData:e.editorEvent?e.editorEvent.data.selectionData:null;if(i&&i.element){var n=e.editor.get("nativeEditor"),o=n.config.uiNode,a=o?o.scrollTop:0,r=i.element.getClientRect();return r.top+=a,t(this,r),!0}},o=function(e){var i=e.editor.get("nativeEditor"),n=i.config.uiNode,o=n?n.scrollTop:0,a=new CKEDITOR.Table(i).getFromSelection(),r=a.getClientRect();return r.top+=o,t(this,r),!0};AlloyEditor.SelectionSetPosition={image:n,table:o}}(),function(){var e=function(e,t){return t.getText().length===e.endOffset||t.equals(e.startContainer)&&t.equals(e.endContainer)&&e.startOffset===e.endOffset&&1===e.endOffset},t=function(e){var t=e.data.selectionData;return!(!t.element||"ae_embed"!==t.element.getAttribute("data-widget"))},i=function(t){var i=t.editor.get("nativeEditor"),n=i.getSelection().getRanges()[0],o=t.data.selectionData,a=new CKEDITOR.Link(i).getFromSelection(),r=i.isSelectionEmpty(),s=!o.element||"img"!==o.element.getName();return!(!(r&&s&&a&&a.getText().length!==n.endOffset&&a)||a.isReadOnly()||e(n,a))},n=function(e){var t=e.data.selectionData,i=!1;if(e.editor){var n=e.editor._getNativeEditor();i=n.isSelectionEmpty()}var o=function(e){return"image"===e.getAttribute("data-widget")||e.getAscendant(function(e){return"image"===e.getAttribute("data-widget")})};return!(!t.element||"img"!==t.element.getName()||i||t.element.isReadOnly()&&!o(t.element))},o=function(e){var t=e.editor.get("nativeEditor"),i=t.isSelectionEmpty(),n=e.data.selectionData;return!(n.element||!n.region||i||t.getSelection().getCommonAncestor().isReadOnly())},a=function(e){var t=e.editor.get("nativeEditor"),i=new CKEDITOR.Table(t),n=i.getFromSelection();return!(!n||!i.isEditable(n))};AlloyEditor.SelectionTest={embed:t,image:n,link:i,table:a,text:o}}(),function(){var e=[{name:"embed",buttons:["embedRemove","embedEdit"],test:AlloyEditor.SelectionTest.embed},{name:"link",buttons:["linkEdit"],test:AlloyEditor.SelectionTest.link},{name:"image",buttons:["imageLeft","imageCenter","imageRight"],setPosition:AlloyEditor.SelectionSetPosition.image,test:AlloyEditor.SelectionTest.image},{name:"text",buttons:{full:[["Font","FontSize","separator","bold","italic","underline","strike","separator","link"],["paragraphAlign","separator","ul","ol","separator","h1","h2","separator","indentBlock","outdentBlock","separator","TextColor","BGColor","separator","code","quote","separator","removeFormat"]],simple:["styles","bold","italic","underline","link"]},test:AlloyEditor.SelectionTest.text},{name:"table",buttons:["tableHeading","tableRow","tableColumn","tableCell","tableRemove"],getArrowBoxClasses:AlloyEditor.SelectionGetArrowBoxClasses.table,setPosition:AlloyEditor.SelectionSetPosition.table,test:AlloyEditor.SelectionTest.table}];AlloyEditor.Selections=e}(),function(){function e(t){e.superclass.constructor.call(this,t)}AlloyEditor.OOP.extend(e,AlloyEditor.Base,{initializer:function(e){var t=this.get("srcNode");this.get("enableContentEditable")&&t.setAttribute("contenteditable","true");var i=CKEDITOR.inline(t);if(i.config.allowedContent=this.get("allowedContent"),i.config.toolbars=this.get("toolbars"),i.config.removePlugins=this.get("removePlugins"),i.config.extraPlugins=this.get("extraPlugins"),i.config.placeholderClass=this.get("placeholderClass"),i.config.pasteFromWordRemoveStyles=!1,i.config.pasteFromWordRemoveFontStyles=!1,i.config.selectionKeystrokes=this.get("selectionKeystrokes"),AlloyEditor.Lang.mix(i.config,e),CKEDITOR.env.ie&&!CKEDITOR.env.edge){var n=11===CKEDITOR.env.version?"ae_dragresize_ie11":"ae_dragresize_ie";i.config.extraPlugins=i.config.extraPlugins.replace("ae_dragresize",n),i.config.removePlugins=i.config.removePlugins.replace("ae_dragresize",n)}i.once("contentDom",function(){this._addReadOnlyLinkClickListener(i);var e=i.editable();e.addClass("ae-editable")}.bind(this)),this._editor=i,AlloyEditor.loadLanguageResources(this._renderUI.bind(this))},destructor:function(){this._destroyed=!0,this._editorUIElement&&(i.unmountComponentAtNode(this._editorUIElement),this._editorUIElement.parentNode.removeChild(this._editorUIElement));var e=this.get("nativeEditor");if(e){var t=e.editable();t&&(t.removeClass("ae-editable"),this.get("enableContentEditable")&&this.get("srcNode").setAttribute("contenteditable","false")),this._clearSelections(),e.destroy()}},_clearSelections:function(){var e=this.get("nativeEditor"),t="function"!=typeof window.getSelection;t?e.document.$.selection.empty():e.document.getWindow().$.getSelection().removeAllRanges()},_addReadOnlyLinkClickListener:function(e){e.editable().on("click",this._defaultReadOnlyClickFn,this,{editor:e})},_defaultReadOnlyClickFn:function(e){var t=e.data.$,i=t.ctrlKey||t.metaKey,n=this._editor.config.readOnly||i;if(t.preventDefault(),n&&e.listenerData.editor.editable().editor.fire("readOnlyClick",e.data)!==!1){var o=new CKEDITOR.dom.elementPath(e.data.getTarget(),this),a=o.lastElement;if(a){var r=a.$.attributes.href?a.$.attributes.href.value:null,s=i?"_blank":a.$.attributes.target?a.$.attributes.target.value:null;this._redirectLink(r,s)}}},_getNativeEditor:function(){return this._editor},_redirectLink:function(e,t){t&&e?window.open(e,t):e&&(window.location.href=e)},_renderUI:function(){if(!this._destroyed){var e=document.createElement("div");e.className="ae-ui";var n=this.get("uiNode")||document.body;n.appendChild(e),this._mainUI=i.render(t.createElement(AlloyEditor.UI,{editor:this,eventsDelay:this.get("eventsDelay"),toolbars:this.get("toolbars")}),e),this._editorUIElement=e,this.get("nativeEditor").fire("uiReady")}},_toElement:function(e){return AlloyEditor.Lang.isString(e)&&(e=document.getElementById(e)),e},_validateAllowedContent:function(e){return AlloyEditor.Lang.isString(e)||AlloyEditor.Lang.isObject(e)||AlloyEditor.Lang.isBoolean(e)},_validateToolbars:function(e){return AlloyEditor.Lang.isObject(e)||AlloyEditor.Lang.isNull(e)}},{ATTRS:{allowedContent:{validator:"_validateAllowedContent",value:!0,writeOnce:!0},enableContentEditable:{validator:AlloyEditor.Lang.isBoolean,value:!0,writeOnce:!0},eventsDelay:{validator:AlloyEditor.Lang.isNumber,value:100},extraPlugins:{validator:AlloyEditor.Lang.isString,value:"ae_uicore,ae_selectionregion,ae_selectionkeystrokes,ae_imagealignment,ae_addimages,ae_placeholder,ae_tabletools,ae_tableresize,ae_autolink,ae_embed,ae_autolist,ae_dragresize,ae_uibridge,ae_richcombobridge,ae_panelmenubuttonbridge,ae_menubridge,ae_menubuttonbridge,ae_buttonbridge,font,colorbutton",writeOnce:!0},mode:{validator:AlloyEditor.Lang.isString,value:"simple"},nativeEditor:{getter:"_getNativeEditor",readOnly:!0},placeholderClass:{validator:AlloyEditor.Lang.isString,value:"ae-placeholder",writeOnce:!0},removePlugins:{validator:AlloyEditor.Lang.isString,value:"contextmenu,toolbar,elementspath,resize,liststyle,link",writeOnce:!0},selectionKeystrokes:{validator:AlloyEditor.Lang.isArray,value:[{keys:CKEDITOR.CTRL+76,selection:"link"},{keys:CKEDITOR.CTRL+CKEDITOR.SHIFT+76,selection:"embed"}]},srcNode:{setter:"_toElement",writeOnce:!0},toolbars:{validator:"_validateToolbars",value:{add:{buttons:["image","embed","camera","hline","table"],tabIndex:2},styles:{selections:AlloyEditor.Selections,tabIndex:1}}},uiNode:{setter:"_toElement",writeOnce:!0}}}),CKEDITOR.event.implementOn(e),AlloyEditor.Core=e}(),function(){var e={applyStyle:function(){if(AlloyEditor.Lang.isFunction(this.isActive)&&AlloyEditor.Lang.isFunction(this.getStyle)){var e=this.props.editor.get("nativeEditor");e.getSelection().lock(),this.isActive()?e.removeStyle(this.getStyle()):e.applyStyle(this.getStyle()),e.getSelection().unlock(),e.fire("actionPerformed",this)}}};AlloyEditor.ButtonActionStyle=e}(),function(){var e={isActive:function(){var e=this.props.editor.get("nativeEditor"),t=e.getCommand(this.props.command);return!!t&&t.state===CKEDITOR.TRISTATE_ON}};AlloyEditor.ButtonCommandActive=e}(),function(){var e={propTypes:{command:n.string.isRequired,modifiesSelection:n.bool},execCommand:function(e){var t=this.props.editor.get("nativeEditor");t.execCommand(this.props.command,e),this.props.modifiesSelection&&t.selectionChange(!0),t.fire("actionPerformed",this)}};AlloyEditor.ButtonCommand=e}(),function(){var e={propTypes:{keystroke:n.object.isRequired},componentWillMount:function(){var e=this.props.editor.get("nativeEditor"),t=this.props.keystroke,i=t.name||(1e9*Math.random()>>>0).toString(),n=e.getCommand(i);n||(n=new CKEDITOR.command(e,{exec:function(e){var i=t.fn;AlloyEditor.Lang.isString(i)?this[i].call(this,e):AlloyEditor.Lang.isFunction(i)&&i.call(this,e)}.bind(this)}),e.addCommand(i,n)),this._defaultKeystrokeCommand=e.keystrokeHandler.keystrokes[t.keys],e.setKeystroke(t.keys,i)},componentWillUnmount:function(){this.props.editor.get("nativeEditor").setKeystroke(this.props.keystroke.keys,this._defaultKeystrokeCommand)}};AlloyEditor.ButtonKeystroke=e}(),function(){var e={propTypes:{editor:n.object.isRequired},mergeButtonCfgProps:function(e){e=e||this.props;var t=this.props.editor.get("nativeEditor"),i=t.config.buttonCfg||{},n=CKEDITOR.tools.merge(e,i[AlloyEditor.ButtonLinkEdit.key]);return n}};AlloyEditor.ButtonCfgProps=e}(),function(){var e={getStateClasses:function(){var e="";return AlloyEditor.Lang.isFunction(this.isActive)&&this.isActive()&&(e+="ae-button-pressed"),AlloyEditor.Lang.isFunction(this.isDisabled)&&this.isDisabled()&&(e+=" ae-button-disabled"),e}};AlloyEditor.ButtonStateClasses=e}(),function(){var e={propTypes:{style:n.oneOfType([n.object,n.string]),styleFn:n.func},componentWillMount:function(){var e=AlloyEditor.Lang,t=this.props.style;if(e.isString(t)){for(var i=t.split("."),n=this.props.editor.get("nativeEditor").config,o=i.shift();o&&e.isObject(n)&&e.isObject(n[o]);)n=n[o],o=i.shift();e.isObject(n)&&(t=n)}this._style=new CKEDITOR.style(t)},componentWillUnmount:function(){this._style=null},getStyle:function(){return this._style},isActive:function(){var e,t=this.props.editor.get("nativeEditor"),i=t.elementPath();return e=this.getStyle().checkActive(i,t)}};AlloyEditor.ButtonStyle=e}(),function(){var e={getToolbarButtonGroups:function(e,t){var i=this;return AlloyEditor.Lang.isFunction(e)&&(e=e.call(this)||[]),e.reduce(function(n,o){return Array.isArray(o)?(n.push(i.getToolbarButtons(o,t)),n):i.getToolbarButtons(e,t)},[])},getToolbarButtons:function(e,i){var n={},o=this.props.editor.get("nativeEditor"),a=o.config.buttonCfg||{};AlloyEditor.Lang.isFunction(e)&&(e=e.call(this)||[]);var r=this.filterExclusive(e.filter(function(e){return e&&(AlloyEditor.Buttons[e]||AlloyEditor.Buttons[e.name])}).map(function(e){return AlloyEditor.Lang.isString(e)?(n[e]=a[e],e=AlloyEditor.Buttons[e]):AlloyEditor.Lang.isString(e.name)&&(n[AlloyEditor.Buttons[e.name].key]=CKEDITOR.tools.merge(a[e],e.cfg),
e=AlloyEditor.Buttons[e.name]),e})).map(function(e,o){var a=this.mergeExclusiveProps({editor:this.props.editor,key:"separator"!==e.key?e.key:e.key+"-"+o,tabKey:e.key,tabIndex:this.props.trigger&&this.props.trigger.props.tabKey===e.key?0:-1,trigger:this.props.trigger},e.key);return a=this.mergeDropdownProps(a,e.key),i&&(a=CKEDITOR.tools.merge(a,i)),a=CKEDITOR.tools.merge(a,n[e.key]),t.createElement(e,a)},this);return r}};AlloyEditor.ToolbarButtons=e}(),function(){var e={getArrowBoxClasses:function(){var e="ae-arrow-box";return AlloyEditor.Lang.isFunction(this.getInteractionPoint)&&this.getInteractionPoint()&&(e+=this.getInteractionPoint().direction===CKEDITOR.SELECTION_TOP_TO_BOTTOM?" ae-arrow-box-top":" ae-arrow-box-bottom"),e}};AlloyEditor.WidgetArrowBox=e}(),function(){var e={componentWillReceiveProps:function(e){this.setState({dropdownTrigger:null,itemDropdown:null})},getInitialState:function(){return{dropdownTrigger:null,itemDropdown:null}},mergeDropdownProps:function(e,t){return CKEDITOR.tools.merge(e,{expanded:this.state.itemDropdown===t,tabIndex:this.state.dropdownTrigger===t?0:-1,toggleDropdown:this.toggleDropdown.bind(this,t)})},toggleDropdown:function(e,t){this.setState({dropdownTrigger:e,itemDropdown:e!==this.state.itemDropdown?e:null},function(){this.state.itemDropdown||(this.moveFocus?this.moveFocus(t):i.findDOMNode(this).focus())})}};AlloyEditor.WidgetDropdown=e}(),function(){var e={cancelExclusive:function(e){this.state.itemExclusive===e&&this.setState({itemExclusive:null})},componentWillReceiveProps:function(e){this.setState({itemExclusive:null})},filterExclusive:function(e){return e.filter(function(e){return this.state.itemExclusive?this.state.itemExclusive===e.key?e:void 0:e}.bind(this))},mergeExclusiveProps:function(e,t){return CKEDITOR.tools.merge(e,{cancelExclusive:this.cancelExclusive.bind(this,t),renderExclusive:this.state.itemExclusive===t,requestExclusive:this.requestExclusive.bind(this,t)})},requestExclusive:function(e){this.setState({itemExclusive:e})}};AlloyEditor.WidgetExclusive=e}(),function(){var e=0,t=1,o=-1,a=0,r=1,s=2,l={propTypes:{onDismiss:n.func,circular:n.bool.isRequired,focusFirstChild:n.bool,descendants:n.string.isRequired,keys:n.object.isRequired},componentDidMount:function(){this._refresh()},componentDidUpdate:function(){this._refresh()},focus:function(e){if((!e||this._isValidTarget(e.target))&&this._descendants&&this._descendants.length){var t=this._descendants[this._activeDescendant];document.activeElement===t||this.props.focusFirstChild||this._descendants.indexOf(document.activeElement)===-1&&t.focus(),e&&(e.stopPropagation(),e.preventDefault())}},handleKey:function(e){if(this._isValidTarget(e.target)&&this._descendants){var t=this._getFocusAction(e);t.type&&(e.stopPropagation(),e.preventDefault(),t.type===r&&this._moveFocus(t.direction),t.type===s&&this.props.onDismiss(t.direction))}},moveFocus:function(e){e=AlloyEditor.Lang.isNumber(e)?e:0,this._moveFocus(e)},_getFocusAction:function(e){var t={type:a};if(this.props.keys){var i=this._getFocusMoveDirection(e);i&&(t.direction=i,t.type=r);var n=this._getFocusDismissAction(e,i);n.dismiss&&(t.direction=n.direction,t.type=s)}return t},_getFocusDismissAction:function(e,i){var n={direction:i,dismiss:!1};return this.props.onDismiss&&(this._isValidKey(e.keyCode,this.props.keys.dismiss)&&(n.dismiss=!0),this._isValidKey(e.keyCode,this.props.keys.dismissNext)&&(n.dismiss=!0,n.direction=t),this._isValidKey(e.keyCode,this.props.keys.dismissPrev)&&(n.dismiss=!0,n.direction=o),n.dismiss||this.props.circular||!i||(n.dismiss=i===o&&0===this._activeDescendant||i===t&&this._activeDescendant===this._descendants.length-1)),n},_getFocusMoveDirection:function(i){var n=e;return this._isValidKey(i.keyCode,this.props.keys.next)&&(n=t),this._isValidKey(i.keyCode,this.props.keys.prev)&&(n=o),i.shifKey&&(n*=-1),n},_isValidKey:function(e,t){return AlloyEditor.Lang.isArray(t)?t.indexOf(e)!==-1:e===t},_isValidTarget:function(e){var t=e.tagName.toLowerCase();return"input"!==t&&"select"!==t&&"textarea"!==t},_moveFocus:function(e){var t=this._descendants.length,i=this._descendants[this._activeDescendant];i.setAttribute("tabIndex",-1),this._activeDescendant+=e,this.props.circular?this._activeDescendant=(this._activeDescendant%t+t)%t:this._activeDescendant=Math.max(Math.min(this._activeDescendant,t-1),0),i=this._descendants[this._activeDescendant],i.setAttribute("tabIndex",0),i.focus()},_refresh:function(){var e=i.findDOMNode(this);if(e){var t=e.querySelectorAll(this.props.descendants),n=[];this._descendants=[],Array.prototype.slice.call(t).forEach(function(e){var t=e.getAttribute("data-tabindex");t?n.push(e):this._descendants.push(e)}.bind(this)),n=n.sort(function(e,t){return AlloyEditor.Lang.toInt(e.getAttribute("data-tabindex"))>AlloyEditor.Lang.toInt(t.getAttribute("data-tabindex"))}),this._descendants=n.concat(this._descendants),this._activeDescendant=0,this._descendants.some(function(e,t){if("0"===e.getAttribute("tabindex"))return this._activeDescendant=t,this.focus(),!0}.bind(this))}}};AlloyEditor.WidgetFocusManager=l}(),function(){var e={propTypes:{editorEvent:n.object},getInteractionPoint:function(){var e=this.props.editorEvent?this.props.editorEvent.data:null;if(e){var t=e.selectionData,i=e.nativeEvent,n={x:e.nativeEvent.pageX,y:t.region.top},o=t.region.direction,a=t.region.endRect,r=t.region.startRect;a&&r&&r.top===a.top&&(o=CKEDITOR.SELECTION_BOTTOM_TO_TOP);var s,l;return n.x&&n.y?(s=this._getXPoint(t,n.x),l=o===CKEDITOR.SELECTION_BOTTOM_TO_TOP?Math.min(n.y,t.region.top):Math.max(n.y,this._getYPoint(t,i))):(s=t.region.left+t.region.width/2,l=o===CKEDITOR.SELECTION_TOP_TO_BOTTOM?this._getYPoint(t,i):t.region.top),{direction:o,x:s,y:l}}},_getXPoint:function(e,t){var i,n=e.region,o=n.startRect?n.startRect.left:n.left,a=n.endRect?n.endRect.right:n.right;if(o<t&&a>t)i=t;else{var r=Math.abs(o-t),s=Math.abs(a-t);i=r<s?o:a}return i},_getYPoint:function(e,t){var i=0;if(e&&t){var n=new CKEDITOR.dom.element(t.target);i=n.$&&"auto"===n.getStyle("overflow")?t.target.offsetTop+t.target.offsetHeight:e.region.bottom}return i}};AlloyEditor.WidgetInteractionPoint=e}(),function(){var e={mixins:[AlloyEditor.WidgetInteractionPoint],propTypes:{constrainToViewport:n.bool,gutter:n.object},getDefaultProps:function(){return{gutter:{left:0,top:10},constrainToViewport:!0}},cancelAnimation:function(){window.cancelAnimationFrame&&window.cancelAnimationFrame(this._animationFrameId)},getConstrainedPosition:function(e,t){t=t||new CKEDITOR.dom.window(window).getViewPaneSize();var i=e.left,n=e.top;return e.left+e.width>t.width&&(i-=e.left+e.width-t.width),n<0&&(n=0),{x:i,y:n}},getWidgetXYPoint:function(e,t,n){var o=i.findDOMNode(this),a=this.props.gutter,r=o.offsetWidth,s=r/2;return n===CKEDITOR.SELECTION_TOP_TO_BOTTOM||n===CKEDITOR.SELECTION_BOTTOM_TO_TOP?(e=e-a.left-s,t=n===CKEDITOR.SELECTION_TOP_TO_BOTTOM?t+a.top:t-o.offsetHeight-a.top):n!==CKEDITOR.SELECTION_LEFT_TO_RIGHT&&n!==CKEDITOR.SELECTION_RIGHT_TO_LEFT||(e=n===CKEDITOR.SELECTION_LEFT_TO_RIGHT?e+a.left+o.offsetHeight/2:e-3*o.offsetHeight/2-a.left,t=t-a.top-o.offsetHeight/2),e<0&&(e=0),e>document.body.offsetWidth-s&&(e=document.body.offsetWidth-s),t<0&&(t=0),[e,t]},isVisible:function(){var e=i.findDOMNode(this);if(e){var t=new CKEDITOR.dom.element(e);return t.hasClass("alloy-editor-visible")}return!1},moveToPoint:function(e,t){var n=new CKEDITOR.dom.element(i.findDOMNode(this));n.setStyles({left:e[0]+"px",top:e[1]+"px",opacity:0,pointerEvents:"none"}),n.removeClass("alloy-editor-invisible"),this._animate(function(){n.addClass("ae-toolbar-transition"),n.addClass("alloy-editor-visible"),n.setStyles({left:t[0]+"px",top:t[1]+"px",opacity:1})}),n.$&&n.$.addEventListener("transitionend",function(){n.setStyles({pointerEvents:""})})},show:function(){var e=i.findDOMNode(this),t=this.props.editor.get("uiNode"),n=t?t.scrollTop:0;if(!this.isVisible()&&e){var o=this.getInteractionPoint();if(o){var a,r,s,l,d=new CKEDITOR.dom.element(e);if(a=s=parseFloat(d.getStyle("left")),r=l=parseFloat(d.getStyle("top")),this.props.constrainToViewport){var c=this.getConstrainedPosition({height:parseFloat(e.offsetHeight),left:a,top:r,width:parseFloat(e.offsetWidth)});a=c.x,r=c.y}l=o.direction===CKEDITOR.SELECTION_TOP_TO_BOTTOM?this.props.selectionData.region.bottom+n:this.props.selectionData.region.top+n,this.moveToPoint([s,l],[a,r])}}},updatePosition:function(){var e=this.getInteractionPoint(),t=i.findDOMNode(this);if(e&&t){var n=this.props.editor.get("uiNode")||document.body,o=getComputedStyle(n),a=parseInt(o.getPropertyValue("margin-left"),10),r=parseInt(o.getPropertyValue("margin-right"),10),s=a+n.clientWidth+r,l="BODY"!==n.tagName?n.scrollTop:0,d=this.getWidgetXYPoint(e.x,e.y,e.direction);d[1]+=l,d[0]<0&&(d[0]=0),d[0]>s-t.offsetWidth&&(d[0]=s-t.offsetWidth),new CKEDITOR.dom.element(t).setStyles({left:d[0]+"px",top:d[1]+"px"})}},_animate:function(e){window.requestAnimationFrame?this._animationFrameId=window.requestAnimationFrame(e):e()}};AlloyEditor.WidgetPosition=e}(),function(){var e=o({displayName:"ButtonBold",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonKeystroke],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"bold"},getDefaultProps:function(){return{command:"bold",keystroke:{fn:"execCommand",keys:CKEDITOR.CTRL+66},style:"coreStyles_bold"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.bold,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-bold",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.bold},t.createElement("span",{className:"ae-icon-bold"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonBold=e}(),function(){var e=o({displayName:"ButtonCameraImage",statics:{key:"cameraImage"},getDefaultProps:function(){return{videoWidth:320}},componentDidMount:function(){i.findDOMNode(this.refs.buttonTakePhoto).focus()},componentWillUnmount:function(){this._stream&&(this._stream.stop?this._stream.stop():this._stream.getVideoTracks&&this._stream.getVideoTracks().forEach(function(e){e.stop()}),this._stream=null)},render:function(){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return e.call(navigator,{video:!0,audio:!1},this._handleStreamSuccess,this._handleStreamError),t.createElement("div",{className:"ae-camera"},t.createElement("video",{ref:"videoContainer"},"Video stream not available."),t.createElement("button",{className:"ae-camera-shoot",onClick:this.takePhoto,ref:"buttonTakePhoto"},"Take photo"),t.createElement("canvas",{className:"ae-camera-canvas",ref:"canvasContainer"}))},takePhoto:function(){var e=i.findDOMNode(this.refs.videoContainer),t=i.findDOMNode(this.refs.canvasContainer),n=t.getContext("2d"),o=this._videoHeight,a=this.props.videoWidth;if(a&&o){t.width=a,t.height=o,n.drawImage(e,0,0,a,o);var r=t.toDataURL("image/png"),s=CKEDITOR.dom.element.createFromHtml('<img src="'+r+'">'),l=this.props.editor.get("nativeEditor");l.insertElement(s),this.props.cancelExclusive(),l.fire("actionPerformed",this),l.fire("imageCameraAdd",s)}},_handleStreamError:function(e){window.alert("An error occurred! "+e)},_handleStreamSuccess:function(e){var t=i.findDOMNode(this.refs.videoContainer),n=i.findDOMNode(this.refs.canvasContainer);t.addEventListener("canplay",function(e){var i=t.videoHeight/(t.videoWidth/this.props.videoWidth);isNaN(i)&&(i=this.props.videoWidth/(4/3)),t.setAttribute("width",this.props.videoWidth),t.setAttribute("height",i),n.setAttribute("width",this.props.videoWidth),n.setAttribute("height",i),this._videoHeight=i}.bind(this),!1),this._stream=e,navigator.mozGetUserMedia?t.mozSrcObject=e:t.src=(window.URL||window.webkitURL).createObjectURL(e),t.play(),i.findDOMNode(this.refs.buttonTakePhoto).disabled=!1}});AlloyEditor.ButtonCameraImage=e}(),function(){var e=o({displayName:"ButtonCamera",propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"camera"},render:function(){if(this.props.renderExclusive)return t.createElement(AlloyEditor.ButtonCameraImage,this.props);var i=!(navigator.getUserMedia||navigator.webkitGetUserMedia&&"https"===location.protocol||navigator.mozGetUserMedia||navigator.msGetUserMedia),n=i?AlloyEditor.Strings.cameraDisabled:AlloyEditor.Strings.camera;return t.createElement("button",{"aria-label":n,className:"ae-button","data-type":"button-image-camera",disabled:i,onClick:this.props.requestExclusive.bind(e.key),tabIndex:this.props.tabIndex,title:n},t.createElement("span",{className:"ae-icon-camera"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonCamera=e}(),function(){var e=o({displayName:"ButtonCode",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"code"},getDefaultProps:function(){return{style:{element:"pre"}}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.code,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-code",onClick:this.applyStyle,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.code},t.createElement("span",{className:"ae-icon-code"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonCode=e}(),function(){var e=o({displayName:"ButtonCommandListItem",mixins:[AlloyEditor.ButtonCommand],propTypes:{description:n.string.isRequired,icon:n.string},statics:{key:"buttonCommandListItem"},render:function(){var e="ae-icon-"+this.props.icon;return t.createElement("button",{"aria-label":this.props.description,className:this._getClassName(),onClick:this.execCommand,tabIndex:this.props.tabIndex},this.props.icon&&t.createElement("span",{className:e}),this.props.description)},_getClassName:function(){var e="ae-container ae-toolbar-element";return e}});AlloyEditor.ButtonCommandListItem=e}(),function(){var e=o({displayName:"ButtonCommandsList",mixins:[AlloyEditor.WidgetFocusManager],propTypes:{commands:n.arrayOf(n.object),editor:n.object.isRequired,listId:n.string},statics:{key:"buttonCommandsList"},componentDidMount:function(){i.findDOMNode(this).focus()},getDefaultProps:function(){return{circular:!1,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]}}},render:function(){return t.createElement("div",{className:"ae-dropdown ae-arrow-box ae-arrow-box-top-left",onFocus:this.focus,onKeyDown:this.handleKey,tabIndex:"0"},t.createElement("ul",{className:"ae-listbox",id:this.props.listId,role:"listbox"},this._renderActions(this.props.commands)))},_renderActions:function(e){var i,n=this.props.editor;return e&&e.length&&(i=e.map(function(e){return t.createElement("li",{key:e.command,role:"option"},t.createElement(AlloyEditor.ButtonCommandListItem,{command:e.command,description:"string"==typeof e.label?e.label:e.label(),icon:e.icon,editor:n}))})),i}});AlloyEditor.ButtonCommandsList=e}(),function(){var e=o({displayName:"ButtonDropdown",mixins:[AlloyEditor.WidgetFocusManager],getDefaultProps:function(){return{circular:!1,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]}}},statics:{key:"dropdown"},render:function(){return t.createElement("div",{className:"ae-dropdown ae-arrow-box ae-arrow-box-top-left",onFocus:this.focus,onKeyDown:this.handleKey,tabIndex:"0"},t.createElement("ul",{className:"ae-listbox",role:"listbox"},this.props.children))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonDropdown=e}(),function(){var e=13,a=27,r=o({displayName:"ButtonEmbedEdit",propTypes:{editor:n.object.isRequired},statics:{key:"embedEdit"},componentDidMount:function(){(this.props.renderExclusive||this.props.manualSelection)&&(window.requestAnimationFrame?window.requestAnimationFrame(this._focusLinkInput):setTimeout(this._focusLinkInput,0))},componentWillReceiveProps:function(e){this.replaceState(this.getInitialState())},getInitialState:function(){var e,t=this.props.editor.get("nativeEditor"),i=t.getSelection();if(i){var n=i.getSelectedElement();n&&(e=n.findOne('[data-widget="ae_embed"]'))}var o=e?e.getAttribute("data-ae-embed-url"):"";return{element:e,initialLink:{href:o},linkHref:o}},render:function(){var e={opacity:this.state.linkHref?1:0};return t.createElement("div",{className:"ae-container-edit-link"},t.createElement("button",{"aria-label":AlloyEditor.Strings.deleteEmbed,className:"ae-button","data-type":"button-embed-remove",disabled:!this.state.element,onClick:this._removeEmbed,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.deleteEmbed},t.createElement("span",{className:"ae-icon-bin"})),t.createElement("div",{className:"ae-container-input xxl"},t.createElement("input",{className:"ae-input",onChange:this._handleLinkHrefChange,onKeyDown:this._handleKeyDown,placeholder:AlloyEditor.Strings.editLink,ref:"linkInput",type:"text",value:this.state.linkHref}),t.createElement("button",{"aria-label":AlloyEditor.Strings.clearInput,className:"ae-button ae-icon-remove",onClick:this._clearLink,style:e,title:AlloyEditor.Strings.clear})),t.createElement("button",{"aria-label":AlloyEditor.Strings.confirm,className:"ae-button",disabled:!this._isValidState(),onClick:this._embedLink,title:AlloyEditor.Strings.confirm},t.createElement("span",{className:"ae-icon-ok"})))},_clearLink:function(){this.setState({linkHref:""})},_embedLink:function(){var e=this.props.editor.get("nativeEditor");e.execCommand("embedUrl",{url:this.state.linkHref}),this.props.cancelExclusive()},_focusLinkInput:function(){i.findDOMNode(this.refs.linkInput).focus()},_handleKeyDown:function(t){if(t.keyCode!==e&&t.keyCode!==a||t.preventDefault(),t.keyCode===e)this._embedLink();else if(t.keyCode===a){var i=this.props.editor.get("nativeEditor");this.props.cancelExclusive(),i.fire("actionPerformed",this)}},_handleLinkHrefChange:function(e){this.setState({linkHref:e.target.value})},_isValidState:function(){var e=this.state.linkHref&&this.state.linkHref!==this.state.initialLink.href;return e},_removeEmbed:function(){var e=this.props.editor.get("nativeEditor"),t=this.state.element.getAscendant(function(e){return e.hasClass("cke_widget_wrapper")});t.remove(),e.fire("actionPerformed",this)}});AlloyEditor.Buttons[r.key]=AlloyEditor.ButtonEmbedEdit=r}(),function(){var e=o({displayName:"ButtonEmbed",mixins:[AlloyEditor.ButtonKeystroke],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"embed"},getDefaultProps:function(){return{keystroke:{fn:"_requestExclusive",keys:CKEDITOR.CTRL+CKEDITOR.SHIFT+76}}},render:function(){return this.props.renderExclusive?t.createElement(AlloyEditor.ButtonEmbedEdit,this.props):t.createElement("button",{"aria-label":AlloyEditor.Strings.link,className:"ae-button","data-type":"button-embed",onClick:this._requestExclusive,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.link},t.createElement("span",{className:"ae-icon-add"}))},_requestExclusive:function(){this.props.requestExclusive(e.key)}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonEmbed=e}(),function(){var e=o({displayName:"ButtonH1",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"h1"},getDefaultProps:function(){return{style:{element:"h1"}}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.h1,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-h1",onClick:this.applyStyle,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.h1},t.createElement("span",{className:"ae-icon-h1"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonH1=e}(),function(){var e=o({displayName:"ButtonH2",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"h2"},getDefaultProps:function(){return{style:{element:"h2"}}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.h2,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-h2",onClick:this.applyStyle,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.h2},t.createElement("span",{className:"ae-icon-h2"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonH2=e}(),function(){var e=o({displayName:"ButtonHline",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonCommand],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"hline"},getDefaultProps:function(){return{command:"horizontalrule",style:{element:"hr"}}},render:function(){return t.createElement("button",{"aria-label":AlloyEditor.Strings.horizontalrule,className:"ae-button","data-type":"button-hline",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.horizontalrule},t.createElement("span",{className:"ae-icon-separator"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonHline=e}(),function(){var e=o({displayName:"ButtonImageAlignCenter",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"imageCenter"},getDefaultProps:function(){return{command:"justifycenter"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.alignCenter,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-image-align-center",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignCenter},t.createElement("span",{className:"ae-icon-align-center"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonImageAlignCenter=e}(),function(){var e=o({displayName:"ButtonImageAlignLeft",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"imageLeft"},getDefaultProps:function(){return{command:"justifyleft"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.alignLeft,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-image-align-left",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignLeft},t.createElement("span",{className:"ae-icon-align-left"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonImageAlignLeft=e}(),function(){var e=o({displayName:"ButtonImageAlignRight",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"imageRight"},getDefaultProps:function(){return{command:"justifyright"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.alignRight,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-image-align-right",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignRight},t.createElement("span",{className:"ae-icon-align-right"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonImageAlignRight=e}(),function(){var e=o({displayName:"ButtonImage",propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"image"},render:function(){var e={display:"none"};return t.createElement("div",null,t.createElement("button",{"aria-label":AlloyEditor.Strings.image,className:"ae-button","data-type":"button-image",onClick:this.handleClick,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.image},t.createElement("span",{className:"ae-icon-image"})),t.createElement("input",{accept:"image/*",onChange:this._onInputChange,ref:"fileInput",style:e,type:"file"}))},handleClick:function(e){i.findDOMNode(this.refs.fileInput).click()},_onInputChange:function(){var e=i.findDOMNode(this.refs.fileInput);if(e.files.length){var t=new FileReader,n=e.files[0];t.onload=function(e){var t=this.props.editor.get("nativeEditor"),i=t.fire("beforeImageAdd",{imageFiles:n});if(i){var o=CKEDITOR.dom.element.createFromHtml('<img src="'+e.target.result+'">');t.insertElement(o),t.fire("actionPerformed",this);var a={el:o,file:n};t.fire("imageAdd",a)}}.bind(this),t.readAsDataURL(n),e.value=""}}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonImage=e}(),function(){var e=o({displayName:"ButtonIndentBlock",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"indentBlock"},getDefaultProps:function(){return{command:"indent"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.indent,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-indent-block",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.indent},t.createElement("span",{className:"ae-icon-indent-block"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonIndentBlock=e}(),function(){var e=o({displayName:"ButtonItalic",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonKeystroke],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"italic"},getDefaultProps:function(){return{command:"italic",keystroke:{fn:"execCommand",keys:CKEDITOR.CTRL+73},style:"coreStyles_italic"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.italic,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-italic",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.italic},t.createElement("span",{className:"ae-icon-italic"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonItalic=e}(),function(){var e=o({displayName:"ButtonLinkAutocompleteList",mixins:[AlloyEditor.WidgetFocusManager],propTypes:{data:n.func,autocompleteSelected:n.bool,term:n.string,setAutocompleteState:n.func},statics:{key:"buttonLinkAutocompleteList"},componentWillReceiveProps:function(e){e.term&&e.term===this.props.term||(clearTimeout(this._timeout),e.term?this._timeout=setTimeout(this._updateItems,this.props.delay):this.setState({items:[]})),e.autocompleteSelected&&(setTimeout(this.focus,0),this.props.setAutocompleteState({selected:!1}))},componentWillUnmount:function(){clearTimeout(this._timeout)},getDefaultProps:function(){return{circular:!1,data:[],delay:100,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]}}},getInitialState:function(){return{items:[]}},render:function(){return this.props.expanded&&this.state.items.length?t.createElement(AlloyEditor.ButtonDropdown,null,this._renderAutocompleteItems(this.state.items)):null},shouldComponentUpdate:function(e,t){return e.expanded!==this.props.expanded||e.term!==this.props.term||t.items!==this.state.items},_renderAutocompleteItems:function(e){e=e||[];var i=this.props.handleLinkAutocompleteClick;return e.map(function(e){var n=this.props.term===e.url?"ae-toolbar-element active":"ae-toolbar-element";return t.createElement("li",{key:e.url,role:"option"},t.createElement("button",{className:n,onClick:i,"data-value":e.url},e.title))}.bind(this))},_updateItems:function(){var e=this;if(this.props.term){var t=Promise.resolve(this.props.data(this.props.term));t.then(function(t){t.length&&!e.props.expanded&&e.props.toggleDropdown(),e.setState({items:t})})}}});AlloyEditor.ButtonLinkAutocompleteList=e}();var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e};!function(){var e=o({displayName:"ButtonLinkEdit",mixins:[AlloyEditor.WidgetDropdown,AlloyEditor.WidgetFocusManager,AlloyEditor.ButtonCfgProps],propTypes:{allowedTargets:n.arrayOf(n.object),appendProtocol:n.bool,editor:n.object.isRequired,defaultLinkTarget:n.string,showTargetSelector:n.bool,data:n.oneOfType([n.func,n.arrayOf(n.object)])},statics:{key:"linkEdit"},componentDidMount:function(){(this.props.renderExclusive||this.props.manualSelection)&&this._focusLinkInput()},componentWillReceiveProps:function(e){this.replaceState(this.getInitialState())},getDefaultProps:function(){return{appendProtocol:!0,autocompleteUrl:"",circular:!0,customIndexStart:!0,defaultLinkTarget:"",descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]},showTargetSelector:!0}},getInitialState:function(){var e=new CKEDITOR.Link(this.props.editor.get("nativeEditor")).getFromSelection(),t=e?e.getAttribute("href"):"",i=e?e.getAttribute("target"):this.props.defaultLinkTarget;return{autocompleteSelected:!1,element:e,initialLink:{href:t,target:i},linkHref:t,linkTarget:i}},render:function(){var e={allowedTargets:this.props.allowedTargets,editor:this.props.editor,handleLinkTargetChange:this._handleLinkTargetChange,selectedTarget:this.state.linkTarget||AlloyEditor.Strings.linkTargetDefault};e=this.mergeDropdownProps(e,AlloyEditor.ButtonLinkTargetEdit.key);var i;if(this.props.data){var n=this.props.data;if(!AlloyEditor.Lang.isFunction(n)){var o=this.props.data;n=function(e){return o}}var r={autocompleteSelected:this.state.autocompleteSelected,data:n,editor:this.props.editor,handleLinkAutocompleteClick:this._handleLinkAutocompleteClick,onDismiss:this.props.toggleDropdown,setAutocompleteState:this._setAutocompleteState,term:this.state.linkHref};r=this.mergeDropdownProps(r,AlloyEditor.ButtonLinkAutocompleteList.key),i=t.createElement(AlloyEditor.ButtonLinkAutocompleteList,r)}var s;this.props.showTargetSelector&&(s=t.createElement(AlloyEditor.ButtonLinkTargetEdit,e));var l;this.state.linkHref&&(l=t.createElement("button",{"aria-label":AlloyEditor.Strings.clearInput,className:"ae-button ae-icon-remove",onClick:this._clearLink,title:AlloyEditor.Strings.clear}));var d={};return!CKEDITOR.env.ie&&AlloyEditor.Strings&&(d.placeholder=AlloyEditor.Strings.editLink),t.createElement("div",{className:"ae-container-edit-link"},t.createElement("button",{"aria-label":AlloyEditor.Strings.removeLink,className:"ae-button",disabled:!this.state.element,onClick:this._removeLink,title:AlloyEditor.Strings.remove},t.createElement("span",{className:"ae-icon-unlink"})),t.createElement("div",{className:"ae-container-input xxl"},s,t.createElement("div",{className:"ae-container-input"},t.createElement("input",a({className:"ae-input",onChange:this._handleLinkHrefChange,onKeyDown:this._handleKeyDown},d,{ref:"linkInput",type:"text",value:this.state.linkHref})),i),l),t.createElement("button",{"aria-label":AlloyEditor.Strings.confirm,className:"ae-button",disabled:!this._isValidState(),onClick:this._updateLink,title:AlloyEditor.Strings.confirm},t.createElement("span",{className:"ae-icon-ok"})))},_clearLink:function(){this.setState({linkHref:""}),this._focusLinkInput()},_focusLinkInput:function(){var e=this,t=function(){i.findDOMNode(e.refs.linkInput).focus()};window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,0)},_handleKeyDown:function(e){if(13!==e.keyCode&&27!==e.keyCode||e.preventDefault(),13===e.keyCode)this._updateLink();else if(40===e.keyCode)this.setState({autocompleteSelected:!0});else if(27===e.keyCode){var t=this.props.editor.get("nativeEditor");new CKEDITOR.Link(t).advanceSelection(),this.props.editor.get("nativeEditor").fire("actionPerformed",this)}},_handleLinkHrefChange:function(e){this.setState({linkHref:e.target.value}),this._focusLinkInput()},_handleLinkTargetChange:function(e){this.setState({itemDropdown:null,linkTarget:e.target.getAttribute("data-value")}),this._focusLinkInput()},_handleLinkAutocompleteClick:function(e){
this.setState({itemDropdown:null,linkHref:e.target.getAttribute("data-value")}),this._focusLinkInput()},_isValidState:function(){var e=this.state.linkHref&&(this.state.linkHref!==this.state.initialLink.href||this.state.linkTarget!==this.state.initialLink.target);return e},_removeLink:function(){var e=this.props.editor.get("nativeEditor"),t=new CKEDITOR.Link(e),i=e.getSelection(),n=i.createBookmarks();t.remove(this.state.element,{advance:!0}),i.selectBookmarks(n),this.props.cancelExclusive(),e.fire("actionPerformed",this)},_setAutocompleteState:function(e){this.setState({autocompleteSelected:e.selected})},_updateLink:function(){var e=this.props.editor.get("nativeEditor"),t=new CKEDITOR.Link(e,{appendProtocol:this.props.appendProtocol}),i={target:this.state.linkTarget},n={advance:!0};this.state.linkHref&&(this.state.element?(i.href=this.state.linkHref,t.update(i,this.state.element,n)):t.create(this.state.linkHref,i,n),e.fire("actionPerformed",this)),this.props.cancelExclusive()}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonLinkEdit=e}(),function(){var e=o({displayName:"ButtonLinkTargetEdit",propTypes:{allowedTargets:n.arrayOf(n.object),editor:n.object.isRequired,selectedTarget:n.string},statics:{key:"linkTargetEdit"},render:function(){var e,i=this.props.handleLinkTargetChange,n=this.props.allowedTargets;return this.props.expanded&&(e=t.createElement(AlloyEditor.ButtonTargetList,{editor:this.props.editor,onDismiss:this.props.toggleDropdown,allowedLinkTargets:n,handleLinkTargetChange:i,selectedTarget:this.props.selectedTarget})),t.createElement("div",{className:"ae-container-edit-link-target ae-container-dropdown ae-container-dropdown-medium ae-has-dropdown",tabIndex:"0"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":this.props.selectedTarget,className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:this.props.selectedTarget},t.createElement("div",{className:"ae-container"},t.createElement("span",{className:"ae-container-dropdown-selected-item"},this.props.selectedTarget),t.createElement("span",{className:"ae-icon-arrow"}))),e)},shouldComponentUpdate:function(e,t){return e.expanded!==this.props.expanded||e.selectedTarget!==this.props.selectedTarget}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonLinkTargetEdit=e}(),function(){var e=o({displayName:"ButtonLink",mixins:[AlloyEditor.ButtonKeystroke,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCfgProps],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"link"},getDefaultProps:function(){return{keystroke:{fn:"_requestExclusive",keys:CKEDITOR.CTRL+76}}},isActive:function(){return null!==new CKEDITOR.Link(this.props.editor.get("nativeEditor")).getFromSelection()},render:function(){var e="ae-button "+this.getStateClasses();if(this.props.renderExclusive){var i=this.mergeButtonCfgProps();return t.createElement(AlloyEditor.ButtonLinkEdit,i)}return t.createElement("button",{"aria-label":AlloyEditor.Strings.link,className:e,"data-type":"button-link",onClick:this._requestExclusive,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.link},t.createElement("span",{className:"ae-icon-link"}))},_requestExclusive:function(){this.props.requestExclusive(e.key)}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonLink=e}(),function(){var e=o({displayName:"ButtonOrderedList",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"ol"},getDefaultProps:function(){return{command:"numberedlist",style:{element:"ol"}}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.numberedlist,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-ol",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.numberedlist},t.createElement("span",{className:"ae-icon-numbered-list"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonOrderedList=e}(),function(){var e=o({displayName:"ButtonOutdentBlock",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"outdentBlock"},getDefaultProps:function(){return{command:"outdent"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.outdent,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-outdent-block",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.outdent},t.createElement("span",{className:"ae-icon-outdent-block"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonOutdentBlock=e}(),function(){var e=o({displayName:"ButtonParagraphAlignLeft",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"paragraphLeft"},getDefaultProps:function(){return{command:"justifyleft"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.alignLeft,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-paragraph-align-left",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignLeft},t.createElement("span",{className:"ae-icon-align-left"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonParagraphAlignLeft=e}(),function(){var e=o({displayName:"ButtonParagraphAlignRight",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"paragraphRight"},getDefaultProps:function(){return{command:"justifyright"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.alignRight,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-paragraph-align-right",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignRight},t.createElement("span",{className:"ae-icon-align-right"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonParagraphAlignRight=e}(),function(){var e=o({displayName:"ButtonParagraphAlign",propTypes:{commands:n.arrayOf(n.object),editor:n.object.isRequired,expanded:n.bool,label:n.string,tabIndex:n.number,toggleDropdown:n.func},statics:{key:"paragraphAlign"},render:function(){var i,n;AlloyEditor.Strings.alignLeft;this.props.expanded&&(n=e.key+"List",i=t.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:n,inlineIcons:!1,onDismiss:this.props.toggleDropdown}));var o=this.props.editor.get("nativeEditor"),a=this._getCommands().filter(function(e){var t=o.getCommand(e.command);return!!t&&t.state===CKEDITOR.TRISTATE_ON}).pop(),r="ae-icon-"+a.icon;return t.createElement("div",{className:"ae-container-dropdown ae-container-dropdown-xsmall ae-has-dropdown"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":a.label,"aria-owns":n,className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.row},t.createElement("div",{className:"ae-container"},t.createElement("span",{className:r}),t.createElement("span",{className:"ae-icon-arrow"}))),i)},_getCommands:function(){return this.props.commands||[{command:"justifyleft",icon:"align-left",label:AlloyEditor.Strings.alignLeft},{command:"justifycenter",icon:"align-center",label:AlloyEditor.Strings.alignCenter},{command:"justifyright",icon:"align-right",label:AlloyEditor.Strings.alignRight},{command:"justifyblock",icon:"align-justified",label:AlloyEditor.Strings.alignJustify}]}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonParagraphAlign=e}(),function(){var e=o({displayName:"ButtonParagraphCenter",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"paragraphCenter"},getDefaultProps:function(){return{command:"justifycenter"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.alignCenter,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-paragraph-center",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignCenter},t.createElement("span",{className:"ae-icon-align-center"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonParagraphCenter=e}(),function(){var e=o({displayName:"ButtonParagraphJustify",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"paragraphJustify"},getDefaultProps:function(){return{command:"justifyblock"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.alignJustify,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-paragraph-justify",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignJustify},t.createElement("span",{className:"ae-icon-align-justified"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonParagraphJustify=e}(),function(){var e=o({displayName:"ButtonQuote",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"quote"},getDefaultProps:function(){return{command:"blockquote",style:{element:"blockquote"}}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.quote,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-quote",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.quote},t.createElement("span",{className:"ae-icon-quote"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonQuote=e}(),function(){var e=o({displayName:"ButtonRemoveFormat",mixins:[AlloyEditor.ButtonCommand],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"removeFormat"},getDefaultProps:function(){return{command:"removeFormat"}},render:function(){return t.createElement("button",{"aria-label":AlloyEditor.Strings.removeformat,className:"ae-button","data-type":"button-removeformat",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.removeformat},t.createElement("span",{className:"ae-icon-removeformat"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonRemoveFormat=e}(),function(){var e=o({displayName:"Separator",statics:{key:"separator"},render:function(){return t.createElement("span",{className:"ae-separator"})}});AlloyEditor.Buttons[e.key]=AlloyEditor.Separator=e}(),function(){var e=o({displayName:"ButtonStrike",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"strike"},getDefaultProps:function(){return{command:"strike",style:"coreStyles_strike"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.strike,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-strike",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.strike},t.createElement("span",{className:"ae-icon-strike"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonStrike=e}(),function(){var e=o({displayName:"ButtonsStylesListHeader",render:function(){return this.props.styles&&this.props.styles.length?t.createElement("span",{className:"ae-list-header"},this.props.name):null}});AlloyEditor.ButtonsStylesListHeader=e}(),function(){var e=o({displayName:"ButtonStylesListItemRemove",propTypes:{editor:n.object.isRequired,label:n.string,removeBlocks:n.array,tabIndex:n.number},statics:{key:"buttonStylesListItemRemove"},getDefaultProps:function(){return{removeBlocks:["h1","h2","h3","h4","h5","h6","pre"]}},render:function(){return t.createElement("li",{role:"option"},t.createElement("button",{className:"ae-toolbar-element",onClick:this._removeStyles,tabIndex:this.props.tabIndex},AlloyEditor.Strings.normal))},_removeStyles:function(){var e=this.props.editor.get("nativeEditor");e.execCommand("removeFormat"),this.props.removeBlocks.forEach(function(t){var i=new CKEDITOR.style({element:t});e.removeStyle(i)}),e.fire("actionPerformed",this)}});AlloyEditor.ButtonStylesListItemRemove=e}(),function(){var e=o({displayName:"ButtonStylesListItem",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonActionStyle],statics:{key:"buttonStylesListItem"},componentWillMount:function(){var e={element:"span",styles:{margin:0}};e=CKEDITOR.tools.merge(e,this.props.style),this._preview=new CKEDITOR.style(e).buildPreview(this.props.name)},render:function(){var e=this.props.name===this.props.activeStyle?"ae-toolbar-element active":"ae-toolbar-element";return t.createElement("button",{className:e,dangerouslySetInnerHTML:{__html:this._preview},onClick:this._onClick,tabIndex:this.props.tabIndex})},_onClick:function(){this.props.styleFn?this.props.styleFn():(this.props.editor.get("nativeEditor").execCommand("removeFormat"),this.applyStyle())}});AlloyEditor.ButtonStylesListItem=e}(),function(){var e=o({displayName:"ButtonStylesList",mixins:[AlloyEditor.WidgetFocusManager],statics:{key:"buttonStylesList"},componentDidMount:function(){i.findDOMNode(this).focus()},componentWillMount:function(){var e=[],t=[],i=[];this.props.styles.forEach(function(n){var o=new CKEDITOR.style(n.style);o.type===CKEDITOR.STYLE_BLOCK?e.push(n):o.type===CKEDITOR.STYLE_INLINE?t.push(n):o.type===CKEDITOR.STYLE_OBJECT&&i.push(n)}),this._blockStyles=e,this._inlineStyles=t,this._objectStyles=i},getDefaultProps:function(){return{circular:!1,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]},showRemoveStylesItem:!0}},render:function(){var e;return this.props.showRemoveStylesItem&&(e=t.createElement(AlloyEditor.ButtonStylesListItemRemove,{editor:this.props.editor,onDismiss:this.props.toggleDropdown})),t.createElement(AlloyEditor.ButtonDropdown,this.props,e,t.createElement(AlloyEditor.ButtonsStylesListHeader,{name:AlloyEditor.Strings.blockStyles,styles:this._blockStyles}),this._renderStylesItems(this._blockStyles),t.createElement(AlloyEditor.ButtonsStylesListHeader,{name:AlloyEditor.Strings.inlineStyles,styles:this._inlineStyles}),this._renderStylesItems(this._inlineStyles),t.createElement(AlloyEditor.ButtonsStylesListHeader,{name:AlloyEditor.Strings.objectStyles,styles:this._objectStyles}),this._renderStylesItems(this._objectStyles))},_renderStylesItems:function(e){var i,n=this.props.editor;return e&&e.length&&(i=e.map(function(e){return t.createElement("li",{key:e.name,role:"option"},t.createElement(AlloyEditor.ButtonStylesListItem,{activeStyle:this.props.activeStyle,editor:n,name:e.name,style:e.style,styleFn:e.styleFn}))}.bind(this))),i}});AlloyEditor.ButtonStylesList=e}(),function(){var e=o({displayName:"ButtonStyles",propTypes:{editor:n.object.isRequired,expanded:n.bool,label:n.string,showRemoveStylesItem:n.bool,styles:n.arrayOf(n.object),tabIndex:n.number,toggleDropdown:n.func},statics:{key:"styles"},render:function(){var e=AlloyEditor.Strings.normal,i=this._getStyles();i.forEach(function(t){this._checkActive(t.style)&&(e=t.name)}.bind(this));var n;return this.props.expanded&&(n=t.createElement(AlloyEditor.ButtonStylesList,{activeStyle:e,editor:this.props.editor,onDismiss:this.props.toggleDropdown,showRemoveStylesItem:this.props.showRemoveStylesItem,styles:i})),t.createElement("div",{className:"ae-container-dropdown ae-has-dropdown"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":AlloyEditor.Strings.styles+" "+e,className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.styles+" "+e},t.createElement("div",{className:"ae-container"},t.createElement("span",{className:"ae-container-dropdown-selected-item"},e),t.createElement("span",{className:"ae-icon-arrow"}))),n)},_checkActive:function(e){var t=this.props.editor.get("nativeEditor");e=CKEDITOR.tools.merge({element:"span"},e);var i=new CKEDITOR.style(e);return i.checkActive(t.elementPath(),t)},_getStyles:function(){return this.props.styles||[{name:AlloyEditor.Strings.h1,style:{element:"h1"}},{name:AlloyEditor.Strings.h2,style:{element:"h2"}},{name:AlloyEditor.Strings.formatted,style:{element:"pre"}},{name:AlloyEditor.Strings.cite,style:{element:"cite"}},{name:AlloyEditor.Strings.code,style:{element:"code"}}]}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonStyles=e}(),function(){var e=o({displayName:"ButtonSubscript",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"subscript"},getDefaultProps:function(){return{command:"subscript",style:"coreStyles_subscript"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.subscript,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-subscript",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.subscript},t.createElement("span",{className:"ae-icon-subscript"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonSubscript=e}(),function(){var e=o({displayName:"ButtonSuperscript",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"superscript"},getDefaultProps:function(){return{command:"superscript",style:"coreStyles_superscript"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.superscript,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-superscript",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.superscript},t.createElement("span",{className:"ae-icon-superscript"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonSuperscript=e}(),function(){var e=o({displayName:"ButtonTableCell",propTypes:{commands:n.arrayOf(n.object),editor:n.object.isRequired,expanded:n.bool,label:n.string,tabIndex:n.number,toggleDropdown:n.func},statics:{key:"tableCell"},render:function(){var i,n;return this.props.expanded&&(n=e.key+"List",i=t.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:n,onDismiss:this.props.toggleDropdown})),t.createElement("div",{className:"ae-container ae-has-dropdown"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":AlloyEditor.Strings.cell,"aria-owns":n,className:"ae-button",onClick:this.props.toggleDropdown,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.cell},t.createElement("span",{className:"ae-icon-cell"})),i)},_getCommands:function(){return this.props.commands||[{command:"cellInsertBefore",label:AlloyEditor.Strings.cellInsertBefore},{command:"cellInsertAfter",label:AlloyEditor.Strings.cellInsertAfter},{command:"cellDelete",label:AlloyEditor.Strings.cellDelete},{command:"cellMerge",label:AlloyEditor.Strings.cellMerge},{command:"cellMergeDown",label:AlloyEditor.Strings.cellMergeDown},{command:"cellMergeRight",label:AlloyEditor.Strings.cellMergeRight},{command:"cellHorizontalSplit",label:AlloyEditor.Strings.cellSplitHorizontal},{command:"cellVerticalSplit",label:AlloyEditor.Strings.cellSplitVertical}]}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonTableCell=e}(),function(){var e=o({displayName:"ButtonTableColumn",propTypes:{commands:n.arrayOf(n.object),editor:n.object.isRequired,expanded:n.bool,label:n.string,tabIndex:n.number,toggleDropdown:n.func},statics:{key:"tableColumn"},render:function(){var i,n;return this.props.expanded&&(n=e.key+"List",i=t.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:n,onDismiss:this.props.toggleDropdown})),t.createElement("div",{className:"ae-container ae-has-dropdown"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":AlloyEditor.Strings.column,"aria-owns":n,className:"ae-button",onClick:this.props.toggleDropdown,role:"listbox",tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.column},t.createElement("span",{className:"ae-icon-column"})),i)},_getCommands:function(){return this.props.commands||[{command:"columnInsertBefore",label:AlloyEditor.Strings.columnInsertBefore},{command:"columnInsertAfter",label:AlloyEditor.Strings.columnInsertAfter},{command:"columnDelete",label:AlloyEditor.Strings.columnDelete}]}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonTableColumn=e}(),function(){var e=13,a=27,r=o({displayName:"ButtonTableEdit",propTypes:{cancelExclusive:n.func.isRequired,editor:n.object.isRequired},statics:{key:"tableEdit"},getDefaultProps:function(){return{tableAttributes:{border:1,cellPadding:0,cellSpacing:0,style:"width: 100%"}}},componentDidMount:function(){i.findDOMNode(this.refs.rows).focus()},getInitialState:function(){return{cols:3,rows:3}},_createTable:function(){var e=this.props.editor.get("nativeEditor"),t=new CKEDITOR.Table(e);t.create({attrs:this.props.tableAttributes,cols:this.state.cols,rows:this.state.rows}),this.props.cancelExclusive(),e.fire("actionPerformed",this)},_handleChange:function(e,t){var i={};i[e]=t.target.value,this.setState(i)},_handleKeyDown:function(t){t.keyCode!==e&&t.keyCode!==a||t.preventDefault(),t.keyCode===e?this._createTable():t.keyCode===a&&this.props.cancelExclusive()},render:function(){var e=Date.now(),i=e+"rows",n=e+"cols";return t.createElement("div",{className:"ae-container-edit-table"},t.createElement("label",{htmlFor:i},AlloyEditor.Strings.rows),t.createElement("div",{className:"ae-container-input small"},t.createElement("input",{className:"ae-input",id:i,onChange:this._handleChange.bind(this,"rows"),min:"1",onKeyDown:this._handleKeyDown,placeholder:"Rows",ref:"rows",type:"number",value:this.state.rows})),t.createElement("label",{htmlFor:n},AlloyEditor.Strings.columns),t.createElement("div",{className:"ae-container-input small"},t.createElement("input",{className:"ae-input",id:n,onChange:this._handleChange.bind(this,"cols"),min:"1",onKeyDown:this._handleKeyDown,placeholder:"Colums",ref:"cols",type:"number",value:this.state.cols})),t.createElement("button",{"aria-label":"Confirm",className:"ae-button",onClick:this._createTable},t.createElement("span",{className:"ae-icon-ok"})))}});AlloyEditor.Buttons[r.key]=AlloyEditor.ButtonTableEdit=r}(),function(){var e=o({displayName:"ButtonTableHeading",propTypes:{commands:n.arrayOf(n.object),editor:n.object.isRequired,expanded:n.bool,label:n.string,tabIndex:n.number,toggleDropdown:n.func},statics:{key:"tableHeading"},render:function(){var i,n;this.props.expanded&&(n=e.key+"List",i=t.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:n,onDismiss:this.props.toggleDropdown}));var o=new CKEDITOR.Table(this.props.editor.get("nativeEditor")).getHeading(),a=AlloyEditor.Strings.headers+":",r=AlloyEditor.Strings["headers"+o];return t.createElement("div",{className:"ae-container-dropdown-xl ae-has-dropdown"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":"",className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:""},t.createElement("div",{className:"ae-container"},t.createElement("span",{className:"ae-container-dropdown-selected-item"},a," ",t.createElement("strong",null,r)),t.createElement("span",{className:"ae-icon-arrow"}))),i)},_getCommands:function(){return this.props.commands||[{command:"tableHeadingNone",label:AlloyEditor.Strings.headersNone},{command:"tableHeadingRow",label:AlloyEditor.Strings.headersRow},{command:"tableHeadingColumn",label:AlloyEditor.Strings.headersColumn},{command:"tableHeadingBoth",label:AlloyEditor.Strings.headersBoth}]}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonTableHeading=e}(),function(){var e=o({displayName:"ButtonTableRemove",propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"tableRemove"},render:function(){return t.createElement("button",{"aria-label":AlloyEditor.Strings.deleteTable,className:"ae-button","data-type":"button-table-remove",onClick:this._removeTable,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.deleteTable},t.createElement("span",{className:"ae-icon-bin"}))},_removeTable:function(){var e=this.props.editor.get("nativeEditor"),t=new CKEDITOR.Table(e);t.remove(),e.fire("actionPerformed",this)}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonTableRemove=e}(),function(){var e=o({displayName:"ButtonTableRow",propTypes:{commands:n.arrayOf(n.object),editor:n.object.isRequired,expanded:n.bool,label:n.string,tabIndex:n.number,toggleDropdown:n.func},statics:{key:"tableRow"},render:function(){var i,n;return this.props.expanded&&(n=e.key+"List",i=t.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:n,onDismiss:this.props.toggleDropdown})),t.createElement("div",{className:"ae-container ae-has-dropdown"},t.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":AlloyEditor.Strings.row,"aria-owns":n,className:"ae-button",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.row},t.createElement("span",{className:"ae-icon-row"})),i)},_getCommands:function(){return this.props.commands||[{command:"rowInsertBefore",label:AlloyEditor.Strings.rowInsertBefore},{command:"rowInsertAfter",label:AlloyEditor.Strings.rowInsertAfter},{command:"rowDelete",label:AlloyEditor.Strings.rowDelete}]}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonTableRow=e}(),function(){var e=o({displayName:"ButtonTable",propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"table"},render:function(){return this.props.renderExclusive?t.createElement(AlloyEditor.ButtonTableEdit,this.props):t.createElement("button",{"aria-label":AlloyEditor.Strings.table,className:"ae-button","data-type":"button-table",onClick:this.props.requestExclusive,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.table},t.createElement("span",{className:"ae-icon-table"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonTable=e}(),function(){var e=o({displayName:"ButtonTargetList",mixins:[AlloyEditor.WidgetFocusManager],propTypes:{editor:n.object.isRequired},statics:{key:"targetList"},componentDidMount:function(){i.findDOMNode(this).focus()},getDefaultProps:function(){return{circular:!0,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]}}},render:function(){var e=this._renderListTargets();return t.createElement(AlloyEditor.ButtonDropdown,this.props,e)},_getAllowedTargetItems:function(){return this.props.allowedLinkTargets||[{label:AlloyEditor.Strings.linkTargetDefault,value:""},{label:AlloyEditor.Strings.linkTargetSelf,value:"_self"},{label:AlloyEditor.Strings.linkTargetBlank,value:"_blank"},{label:AlloyEditor.Strings.linkTargetParent,value:"_parent"},{label:AlloyEditor.Strings.linkTargetTop,value:"_top"}]},_renderListTargets:function(){var e=this._getAllowedTargetItems(),i=this.props.handleLinkTargetChange;return e=e.map(function(e){var n=this.props.selectedTarget===e.value?"ae-toolbar-element active":"ae-toolbar-element";return t.createElement("li",{key:e.value,role:"option"},t.createElement("button",{className:n,"data-value":e.value,onClick:i},e.label))}.bind(this))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonTargetList=e}(),function(){var e=280,i=o({displayName:"ButtonTwitter",mixins:[AlloyEditor.ButtonStateClasses],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"twitter"},handleClick:function(){var e=this.props.editor.get("nativeEditor"),t=new CKEDITOR.Link(e);this.isActive()?t.remove(t.getFromSelection()):t.create(this._getHref(),{class:"ae-twitter-link",target:"_blank"}),e.fire("actionPerformed",this)},isActive:function(){var e=new CKEDITOR.Link(this.props.editor.get("nativeEditor")).getFromSelection();return e&&e.getAttribute("href").indexOf("twitter.com/intent/tweet")!==-1},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.twitter,className:e,"data-type":"button-twitter",onClick:this.handleClick,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.twitter},t.createElement("span",{className:"ae-icon-twitter"}))},_getHref:function(){var t=this.props.editor.get("nativeEditor"),i=t.getSelection().getSelectedText().substring(0,e),n=this.props.url,o=this.props.via,a="https://twitter.com/intent/tweet?text="+i;return n&&(a+="&url="+n),o&&(a+="&via="+o),a}});AlloyEditor.Buttons[i.key]=AlloyEditor.ButtonTwitter=i}(),function(){var e=o({displayName:"ButtonUnorderedlist",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"ul"},getDefaultProps:function(){return{command:"bulletedlist",style:{element:"ul"}}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.bulletedlist,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-ul",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.bulletedlist},t.createElement("span",{className:"ae-icon-bulleted-list"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonUnorderedlist=e}(),function(){var e=o({displayName:"ButtonUnderline",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonKeystroke],propTypes:{editor:n.object.isRequired,label:n.string,tabIndex:n.number},statics:{key:"underline"},getDefaultProps:function(){return{command:"underline",keystroke:{fn:"execCommand",keys:CKEDITOR.CTRL+85},style:"coreStyles_underline"}},render:function(){var e="ae-button "+this.getStateClasses();return t.createElement("button",{"aria-label":AlloyEditor.Strings.underline,"aria-pressed":e.indexOf("pressed")!==-1,className:e,"data-type":"button-underline",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.underline},t.createElement("span",{className:"ae-icon-underline"}))}});AlloyEditor.Buttons[e.key]=AlloyEditor.ButtonUnderline=e}(),function(){var e=1,a=2,r=o({displayName:"ToolbarAdd",mixins:[AlloyEditor.WidgetDropdown,AlloyEditor.WidgetExclusive,AlloyEditor.WidgetFocusManager,AlloyEditor.ToolbarButtons,AlloyEditor.WidgetPosition,AlloyEditor.WidgetArrowBox],propTypes:{config:n.object,editor:n.object.isRequired,editorEvent:n.object,gutterExclusive:n.object,label:n.string,onDismiss:n.func,position:n.oneOf([e,a]),selectionData:n.object},statics:{key:"add",left:e,right:a},getDefaultProps:function(){return{circular:!0,descendants:".ae-button",gutterExclusive:{left:10,top:0},keys:{dismiss:[27],next:[39,40],prev:[37,38]},position:e}},componentDidMount:function(){this._updatePosition()},componentDidUpdate:function(e,t){this._updatePosition(),this.props.renderExclusive&&this.focus()},render:function(){if(!this.state.itemExclusive&&this.props.editorEvent&&this.props.editorEvent.data.nativeEvent.target&&!this.props.editorEvent.data.nativeEvent.target.isContentEditable)return null;var e=this._getButtons(),i=this._getToolbarClassName();return t.createElement("div",{"aria-label":AlloyEditor.Strings.add,className:i,"data-tabindex":this.props.config.tabIndex||0,
onFocus:this.focus,onKeyDown:this.handleKey,role:"toolbar",tabIndex:"-1"},t.createElement("div",{className:"ae-container"},e))},_getButtons:function(){var e;return this.props.renderExclusive?e=this.getToolbarButtons(this.props.config.buttons):this.props.selectionData&&this.props.selectionData.region&&(e=t.createElement("button",{"aria-label":AlloyEditor.Strings.add,className:"ae-button ae-button-add",onClick:this.props.requestExclusive.bind(this,r.key),title:AlloyEditor.Strings.add},t.createElement("span",{className:"ae-icon-add"}))),e},_getToolbarClassName:function(){var e="ae-toolbar-add";return this.props.renderExclusive&&(e="ae-toolbar "+this.getArrowBoxClasses()),e},_updatePosition:function(){var t;if(i.findDOMNode(this))if(this.props.renderExclusive)this.updatePosition(),this.show();else if(this.props.selectionData&&(t=this.props.selectionData.region),t){var n,o=i.findDOMNode(this),a=new CKEDITOR.dom.element(o),r=t.startRect||t,s=this.props.editor.get("nativeEditor"),l=s.editable().getClientRect(),d=this.props.config.position||this.props.position;n=d===e?l.left-o.offsetWidth-this.props.gutterExclusive.left+"px":l.right+this.props.gutterExclusive.left+"px",o.style.left=n,o.style.top=Math.floor((t.bottom+t.top)/2)+"px";var c=this.props.editor.get("uiNode"),u=c?c.scrollTop:0;"auto"!==s.element.getStyle("overflow")?o.style.top=Math.floor(t.top-o.offsetHeight/2+r.height/2+u)+"px":o.style.top=Math.floor(s.element.$.offsetTop+r.height/2-o.offsetHeight/2)+"px",o.style.opacity=1,a.removeClass("ae-arrow-box"),this.cancelAnimation()}}});AlloyEditor.Toolbars[r.key]=AlloyEditor.ToolbarAdd=r}();var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var a=o({displayName:"ToolbarStyles",mixins:[AlloyEditor.WidgetDropdown,AlloyEditor.WidgetExclusive,AlloyEditor.WidgetFocusManager,AlloyEditor.ToolbarButtons,AlloyEditor.WidgetPosition,AlloyEditor.WidgetArrowBox],propTypes:{config:n.object,editor:n.object.isRequired,editorEvent:n.object,label:n.string,onDismiss:n.func,selectionData:n.object},statics:{key:"styles"},componentDidMount:function(){this._updatePosition()},componentDidUpdate:function(e,t){this._updatePosition()},getDefaultProps:function(){return{circular:!0,descendants:".ae-input, .ae-button:not([disabled]), .ae-toolbar-element",keys:{dismiss:[27],next:[39,40],prev:[37,38]}}},render:function(){var i=this._getCurrentSelection();if(i){var n,o=this._getSelectionFunction(i.getArrowBoxClasses);n=o?o():this.getArrowBoxClasses();var a="ae-toolbar-styles "+n,r=i.buttons;"object"!==("undefined"==typeof r?"undefined":e(r))||Array.isArray(r)||(r=r[this.props.editor.get("mode")]||r.simple);var s=this.getToolbarButtonGroups(r,{manualSelection:this.props.editorEvent?this.props.editorEvent.data.manualSelection:null,selectionType:i.name}),l=s.filter(function(e){return Array.isArray(e)}).length>0,d="ae-container";return l&&(d+=" ae-container-column"),t.createElement("div",{"aria-label":AlloyEditor.Strings.styles,className:a,"data-tabindex":this.props.config.tabIndex||0,onFocus:this.focus,onKeyDown:this.handleKey,role:"toolbar",tabIndex:"-1"},t.createElement("div",{className:d},s.map(function(e,i){return Array.isArray(e)?t.createElement("div",{className:"ae-row",key:i.toString()},e.map(function(e){return e})):e})))}return null},_getSelectionFunction:function(e){var t,i=AlloyEditor.Lang;if(i.isFunction(e))t=e;else if(i.isString(e)){for(var n=e.split("."),o=window,a=n.shift();a&&i.isObject(o)&&i.isObject(o[a]);)o=o[a],a=n.shift();i.isFunction(o)&&(t=o)}return t},_getCurrentSelection:function(){var e,t=this.props.editorEvent?this.props.editorEvent.data:null;return t&&this.props.config.selections.some(function(i){var n,o=this._getSelectionFunction(i.test);return o&&(n=t.manualSelection===i.name||o({data:t,editor:this.props.editor})),n&&(e=i),n},this),e},_updatePosition:function(){if(i.findDOMNode(this)){var e,t=this._getCurrentSelection();if(t){var n=this._getSelectionFunction(t.setPosition);n&&(e=n.call(this,{editor:this.props.editor,editorEvent:this.props.editorEvent,selectionData:this.props.selectionData}))}e||(this.updatePosition(),this.show())}}});AlloyEditor.Toolbars[a.key]=AlloyEditor.ToolbarStyles=a}(),function(){var e=o({displayName:"UI",mixins:[AlloyEditor.WidgetExclusive,AlloyEditor.WidgetFocusManager],propTypes:{ariaUpdates:n.object,editor:n.object.isRequired,eventsDelay:n.number,toolbars:n.object.isRequired},getInitialState:function(){return{hidden:!1}},getDefaultProps:function(){return{circular:!0,descendants:"[class^=ae-toolbar-]",eventsDelay:0,keys:{next:9}}},componentDidMount:function(){var e=this.props.editor.get("nativeEditor");e.on("editorInteraction",this._onEditorInteraction,this),e.on("actionPerformed",this._onActionPerformed,this),e.on("key",this._onEditorKey,this),this._mousedownListener=function(e){this._setUIHidden(e.target)}.bind(this),this._keyDownListener=CKEDITOR.tools.debounce(function(e){this._setUIHidden(document.activeElement)},this.props.eventsDelay,this),document.addEventListener("mousedown",this._mousedownListener),document.addEventListener("keydown",this._keyDownListener)},componentDidUpdate:function(e,t){var n=i.findDOMNode(this),o=this.props.editor.get("nativeEditor");n&&o.fire("ariaUpdate",{message:this._getAvailableToolbarsMessage(n)}),o.fire("editorUpdate",{prevProps:e,prevState:t,props:this.props,state:this.state})},_getAriaUpdateTemplate:function(e){return this._ariaUpdateTemplates||(this._ariaUpdateTemplates={}),this._ariaUpdateTemplates[e]||(this._ariaUpdateTemplates[e]=new CKEDITOR.template(this._getAriaUpdates()[e])),this._ariaUpdateTemplates[e]},_getAriaUpdates:function(){return this.props.ariaUpdates||{noToolbar:AlloyEditor.Strings.ariaUpdateNoToolbar,oneToolbar:AlloyEditor.Strings.ariaUpdateOneToolbar,manyToolbars:AlloyEditor.Strings.ariaUpdateManyToolbars}},_getAvailableToolbarsMessage:function(e){var t=e.querySelectorAll('[role="toolbar"]');if(t.length){var i=Array.prototype.slice.call(t).map(function(e){return e.getAttribute("aria-label")}),n=1===i.length?"oneToolbar":"manyToolbars";return this._getAriaUpdateTemplate(n).output({toolbars:i.join(",").replace(/,([^,]*)$/," and $1")})}return this._getAriaUpdates().noToolbar},componentWillUnmount:function(){this._mousedownListener&&document.removeEventListener("mousedown",this._mousedownListener),this._keyDownListener&&(this._keyDownListener.detach(),document.removeEventListener("keydown",this._keyDownListener))},render:function(){if(this.state.hidden)return null;var e=Object.keys(this.props.toolbars).map(function(e){return AlloyEditor.Toolbars[e]||window[e]});return e=this.filterExclusive(e).map(function(e){var i=this.mergeExclusiveProps({config:this.props.toolbars[e.key],editor:this.props.editor,editorEvent:this.state.editorEvent,key:e.key,onDismiss:this._onDismissToolbarFocus,selectionData:this.state.selectionData},e.key);return t.createElement(e,i)}.bind(this)),t.createElement("div",{className:"ae-toolbars",onKeyDown:this.handleKey},e)},_onActionPerformed:function(e){var t=this.props.editor.get("nativeEditor");t.focus(),this.setState({itemExclusive:null,selectionData:t.getSelectionData()})},_onDismissToolbarFocus:function(){var e=this.props.editor.get("nativeEditor");e.focus()},_onEditorInteraction:function(e){this.setState({editorEvent:e,hidden:!1,itemExclusive:null,selectionData:e.data.selectionData})},_onEditorKey:function(e){var t=e.data.domEvent.$;t.altKey&&121===t.keyCode&&this.focus()},_setUIHidden:function(e){var t=i.findDOMNode(this);if(t){var n=this.props.editor.get("nativeEditor").editable(),o=e.parentNode,a=new CKEDITOR.dom.node(e);if(n){var r=n.$===e||n.contains(a)||new CKEDITOR.dom.element(t).contains(a);o&&(r=r||"ckimgrsz"===o.id),r||this.setState({hidden:!0})}else this.setState({hidden:!0})}}});AlloyEditor.UI=e}()}}();