CKEDITOR.disableAutoInline=!0,YUI.add("alloy-editor",function(o){"use strict";var t,e=o.Lang,i=27,a=121,n=9;t=o.Base.create("alloyEditor",o.Base,[],{initializer:function(t){var e,i,a,n,r,s,l;r=this.get("srcNode"),i=CKEDITOR.inline(r.getDOMNode()),i.config.allowedContent=this.get("allowedContent"),i.config.toolbars=this.get("toolbars"),i.config.removePlugins=this.get("removePlugins"),i.config.extraPlugins=this.get("extraPlugins"),i.config.placeholderClass=this.get("placeholderClass"),i.config.pasteFromWordRemoveStyles=!1,i.config.pasteFromWordRemoveFontStyles=!1,o.mix(i.config,t),this._editor=i,n=this.get("eventsDelay"),s=CKEDITOR.tools.debounce(this._onDocInteract,n,this),l=CKEDITOR.tools.debounce(this._onEditorKey,n,this),a=o.one(o.config.doc).on(["click","keydown"],s),e=r.on("keydown",l),this._eventHandles=[s,l,a,e],i.on("toolbarKey",this._onToolbarKey,this),i.on("toolbarActive",this._onToolbarActive,this),i.on("afterCommandExec",this._returnFocusToToolbar,this)},destructor:function(){var t;t=CKEDITOR.instances[this.get("srcNode").get("id")],t&&(o.Object.each(t.config.toolbars,function(o){o.destroy()}),t.destroy()),new o.EventHandle(this._eventHandles).detach()},_focusNextToolbar:function(){var t,e,i,a;t=this._activeToolbar,a=this._editor.config.toolbars,a=o.Object.keys(a).map(function(o){return a[o]}),e=o.Array.indexOf(a,t),i=a.splice(e),a=i.concat(a),o.Array.some(a,function(o){return o!==t&&o.focus()?(this._activeToolbar=o,this._focusedToolbar=o,!0):void 0},this)},_focusVisibleToolbar:function(t){o.Object.some(this._editor.config.toolbars,function(o){return o!=this._activeToolbar&&o.focus(t)?(this._activeToolbar=o,this._focusedToolbar=o,o.get("visible")):void 0},this)},_getNativeEditor:function(){return this._editor},_hideToolbars:function(){o.Object.each(this._editor.config.toolbars,function(o){o.hide()})},_onDocInteract:function(t){var e,i,a;a=this.get("srcNode"),i=a===t.target||a.contains(t.target),e=CKEDITOR.instances[a.get("id")],i=i||o.some(e.config.toolbars,function(o){return o.ownsNode(t.target)}),i||this._editor.fire("toolbarsHide")},_onEditorKey:function(o){o.altKey&&o.keyCode===a?this._focusVisibleToolbar():o.keyCode===i&&this._hideToolbars()},_onToolbarActive:function(o){this._activeToolbar=o.data},_onToolbarKey:function(o){o.data.keyCode===n?(o.data.preventDefault(),this._focusNextToolbar()):o.data.keyCode===i&&(this._activeToolbar.blur(),this._activeToolbar=null,this._focusedToolbar=null,this._hideToolbars())},_returnFocusToToolbar:function(){var o=this._focusedToolbar;if(o){var t=o.getActiveButton();this._focusVisibleToolbar(t)}},_validateAllowedContent:function(o){return e.isString(o)||e.isObject(o)||e.isBoolean(o)},_validateToolbars:function(o){return""===o||e.isObject(o)||e.isNull(o)}},{ATTRS:{allowedContent:{validator:"_validateAllowedContent",value:!0,writeOnce:!0},eventsDelay:{validator:e.isNumber,value:100},extraPlugins:{validator:e.isString,value:"uicore,selectionregion,dropimages,placeholder,linktooltip,uiloader",writeOnce:!0},nativeEditor:{getter:"_getNativeEditor",readOnly:!0},placeholderClass:{validator:e.isString,value:"alloy-editor-placeholder",writeOnce:!0},removePlugins:{validator:e.isString,value:"contextmenu,toolbar,elementspath,resize,liststyle,tabletools,link",writeOnce:!0},srcNode:{setter:o.one,writeOnce:!0},toolbars:{validator:"_validateToolbars",value:{add:["image"],image:["left","right"],styles:["strong","em","u","h1","h2","a","twitter"]}}}}),o.AlloyEditor=t},"",{requires:["base-build","node-base"]});